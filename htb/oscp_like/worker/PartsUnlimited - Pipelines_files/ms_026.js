"use strict";define("VSSUI",["require","exports","react","VSS/Core/Observable","VSS/Core/Util/Accessibility","VSS/Core/Util/String"],function(e,t,s,i,n,o){var l,r,a,d,c,p,h,u,m,b,x,f,I,g,v,w;l=t.ResourcesDropdown={},Object.defineProperty(t,"__esModule",{value:!0}),t.ResourcesDropdown.AnnounceFilterCleared="Filter selection cleared",t.ResourcesDropdown.AnnounceFilterResultCount="Showing {0} filtered items.",t.ResourcesDropdown.AnnounceFinishedLoadingItems="Finished loading items",t.ResourcesDropdown.AnnounceLoadingItems="Loading items",t.ResourcesDropdown.DropdownClearActionText="Clear",t.ResourcesDropdown.Loading="Loading...",t.ResourcesDropdown.NoFilterResults="No items matched the supplied filter",t.ResourcesDropdown.NoItemsFound="No items found",t.ResourcesDropdown.Searching="Searching...",t.ResourcesDropdown.UseItem='Use "{0}"',function(e){r=t.ComponentsExpandableTextFieldExpandableTextField={},Object.defineProperty(t,"__esModule",{value:!0});let i=1;class n extends s.Component{constructor(e){super(e),this.textFieldElement=s.createRef(),this.expandable=s.createRef(),this.collapse=(()=>{this.expandable.current&&this.expandable.current.collapse()}),this.expand=(()=>{this.expandable.current&&this.expandable.current.expand()}),this.onBlur=(()=>{this.props.blurDismiss&&this.collapse(),this.props.onBlur&&this.props.onBlur()}),this.renderCallout=(()=>this.props.renderCallout(this,this.dropdownId,this.props.anchorElement?this.props.anchorElement:this.props.anchorPoint?void 0:this.containerElement.current?this.containerElement.current:void 0,this.props.anchorOffset||{horizontal:0,vertical:0},this.props.anchorOrigin||{horizontal:"end",vertical:"end"},this.props.anchorPoint,this.props.dropdownOrigin||{horizontal:"end",vertical:"start"})),this.dropdownId=e.dropdownId||"dropdown-"+i++,this.containerElement=e.containerRef||s.createRef()}render(){return s.createElement(t.Expandable.Expandable,{disabled:this.props.disabled,expandKey:this.props.expandKey,onCollapse:this.props.onCollapse,onExpand:this.props.onExpand,renderCallout:this.renderCallout,ref:this.expandable},e=>s.createElement("div",{className:t.Util.css(this.props.expandableContainerClassName,"bolt-expandable-textfield"),onMouseDown:e.onMouseDown,onKeyDown:e.onKeyDown,ref:this.containerElement},s.createElement(t.TextField.TextField,Object.assign({},this.props,{ariaControls:e.expanded?this.dropdownId:void 0,ariaExpanded:e.expanded,ariaHasPopup:!0,onBlur:this.onBlur,onClick:e.onClick,ref:this.textFieldElement,suffixIconProps:this.props.hideDropdownIcon?void 0:{key:"dropdown-icon",className:t.Util.css("bolt-expandable-textfield-icon icon-right",this.props.disabled&&"disabled"),iconName:"ChevronDown",onClick:e.onClick}}))))}focus(){this.textFieldElement.current&&this.textFieldElement.current.focus()}}n.defaultProps={expandKey:[40,13]},t.ComponentsExpandableTextFieldExpandableTextField.ExpandableTextField=n}(),a=t.ExpandableTextField={},Object.defineProperty(t,"__esModule",{value:!0}),t.ExpandableTextField.ExpandableTextField=r.ExpandableTextField,function(e){d=t.UtilitiesDropdownSelection={},Object.defineProperty(t,"__esModule",{value:!0});t.UtilitiesDropdownSelection.DropdownSelection=class extends t.List.ListSelection{constructor(){super({selectOnFocus:!1})}};t.UtilitiesDropdownSelection.DropdownMultiSelection=class extends t.List.ListSelection{constructor(){super({alwaysMerge:!0,multiSelect:!0,selectOnFocus:!1})}}}(),function(e){c=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),t[e].DefaultListBoxWidth=-100;class r extends s.Component{constructor(e){super(e),this.tabbableIndex=-1,this.positions=[],this.count=0,this.table=s.createRef(),this.getItemWidth=(()=>{const{width:e}=this.props;return this.selection.multiSelect&&e&&e>0?e-t.Table.ColumnSelectWidth:e}),this.loadingChanged=(()=>(i.ObservableLike.getValue(this.props.loading)?n.announce(l.AnnounceLoadingItems):n.announce(l.AnnounceFinishedLoadingItems),!0)),this.searchingChanged=(()=>{if(i.ObservableLike.getValue(this.props.loading))n.announce(l.Searching);else{const e=this.props.items.length;n.announce(e>0?o.format(l.AnnounceFilterResultCount,e):l.NoFilterResults,!0)}return!0}),this.onItemsChanged=(()=>{const e=u(this.wrappedItems||this.props.items);this.tabbableIndex=-1,this.positions=[],this.count=0;for(const t of e){const e=i.ObservableLike.getValue(t);e&&!p(e)?this.positions.push(-1):(-1===this.tabbableIndex&&this.selection.selectable(this.positions.length)&&(this.tabbableIndex=this.positions.length),this.positions.push(++this.count))}return!0}),this.onActivate=((e,t)=>{this.props.onActivate&&this.props.onActivate(e,t.data)}),this.onSelect=((e,t)=>{this.props.onSelect&&this.props.onSelect(e,t.data)}),this.renderListBoxRow=((e,i,n)=>{const{excludeFocusZone:o,excludeTabStop:l}=this.props,r=!o&&this.selection.selectable(e),a=Object.assign({},n,{ariaPosInSet:this.positions[e]>=0?this.positions[e]:null,ariaSetSize:this.positions[e]>=0?this.count:null,excludeTabStop:l||this.tabbableIndex!==e,excludeFocusZone:!r,singleClickActivation:!1,role:this.selection.multiSelect?"menuitemcheckbox":"menuitemradio"});return s.createElement(t.Observer.Observer,{key:e,item:i},()=>s.createElement(t.Table.TableRow,{key:e,index:e,details:a,className:t.Util.css(2===i.type&&"bolt-list-box-header-row",3===i.type&&"bolt-list-box-divider-row",4===i.type&&"bolt-list-box-loading-row",this.selection.multiSelect&&"bolt-list-box-multi-select-row",2!==i.type&&3!==i.type&&"cursor-pointer")},this.columns.map((s,n)=>this.selection.multiSelect&&0===n&&!r?3===i.type||4===i.type?null:t.Table.renderEmptyCell(e,n):s.renderCell(e,n,s,i))))}),this.renderListBoxCell=((e,i,n,o)=>o.render?o.render(e,i,n,o):3===o.type?s.createElement(t.Table.SimpleTableCell,{className:t.Util.css(n.className,o.className,this.selection.multiSelect&&"bolt-list-box-divider-multi-select"),columnIndex:i,colspan:this.selection.multiSelect?2:1,key:i,tableColumn:n},s.createElement("div",{className:"bolt-list-box-divider flex-grow"})):4===o.type?s.createElement(m,{columnIndex:i,tableColumn:n,tableItem:o}):s.createElement(t.Table.SimpleTableCell,{className:t.Util.css(n.className,o.className,2===o.type&&"bolt-list-box-header"),columnIndex:i,key:i,tableColumn:n},o&&t.List.renderListCell(o)));const{selection:r,width:a,renderItem:c,items:b}=this.props;this.selection=r||new d.DropdownSelection,this.columns=this.selection.multiSelect?[new t.Table.ColumnSelect]:[],this.columns.push({id:"text",width:this.getItemWidth(),renderCell:c||this.renderListBoxCell,className:t.Util.css("bolt-list-box-text",this.selection.multiSelect?"bolt-list-box-text-multi-select":"bolt-list-box-text-single-select")}),this.wrappedItems=h(b),this.onItemsChanged()}render(){const{className:e,containerClassName:i,focuszoneProps:n,getUnselectableRanges:o,items:r,loading:a,searching:d}=this.props,c={observableValue:r,filter:this.onItemsChanged},p=this.wrappedItems?new t.UtilitiesProvider.ArrayItemProvider(this.wrappedItems):Array.isArray(r)?new t.UtilitiesProvider.ArrayItemProvider(r):r;return this.columns[this.columns.length-1].width=this.getItemWidth(),s.createElement(t.Observer.ItemsObserver,{getUnselectableRanges:o,items:r,selection:this.selection},s.createElement(t.Observer.Observer,{items:c,loading:{observableValue:a||!1,filter:this.loadingChanged},searching:{observableValue:d||!1,filter:this.searchingChanged}},o=>o.searching?s.createElement("div",{className:"bolt-list-box-loading"},s.createElement(t.Spinner.Spinner,{size:"medium",label:l.Searching})):s.createElement(t.Table.Table,{className:t.Util.css(e,"bolt-list-box"),columns:this.columns,containerClassName:i,focuszoneProps:n,itemProvider:p,onActivate:this.onActivate,onSelect:this.onSelect,renderRow:this.renderListBoxRow,ref:this.table,role:"menu",scrollable:!0,singleClickActivation:!1,selection:this.selection,showHeader:!1,showLines:!1,spacerWidth:0})))}scrollIntoView(e,t){if(this.table.current)return this.table.current.scrollIntoView(e,t)}}function a(e,t=p){const s=[];let i=-1;for(let n=0;n<e.length;n++)!t(e[n])&&i<0?i=n:t(e[n])&&i>=0&&(s.push({beginIndex:i,endIndex:n-1}),i=-1);return i>=0&&s.push({beginIndex:i,endIndex:e.length-1}),s}function p(e){return 2!==e.type&&3!==e.type&&4!==e.type}function h(e){if(Array.isArray(e)&&e.length&&"string"==typeof e[0])return e.map(e=>({id:e,text:e}))}function u(e){return t.UtilitiesProvider.getItemsValue(e)}r.defaultProps={getUnselectableRanges:a,width:t[e].DefaultListBoxWidth},t[e].ListBox=r,t[e].getUnselectableRanges=a,t[e].listBoxItemSelectable=p,t[e].wrapListBoxItems=h,t[e].getListBoxItemsValue=u;class m extends s.Component{componentDidMount(){this.props.onMount&&this.props.onMount()}render(){const{columnIndex:e,tableColumn:i,tableItem:n}=this.props;return s.createElement(t.Table.SimpleTableCell,{className:t.Util.css(i.className,n.className),columnIndex:e,colspan:2,contentClassName:"justify-center",key:e,tableColumn:i},s.createElement("div",{className:"bolt-list-box-loading"},s.createElement(t.Spinner.Spinner,{size:"medium",label:l.Loading})))}}t[e].LoadingCell=m}("ComponentsListBoxListBox"),p=t.ListBox={},Object.defineProperty(t,"__esModule",{value:!0}),t.ListBox.DefaultListBoxWidth=c.DefaultListBoxWidth,t.ListBox.getListBoxItemsValue=c.getListBoxItemsValue,t.ListBox.getUnselectableRanges=c.getUnselectableRanges,t.ListBox.ListBox=c.ListBox,t.ListBox.listBoxItemSelectable=c.listBoxItemSelectable,t.ListBox.LoadingCell=c.LoadingCell,t.ListBox.wrapListBoxItems=c.wrapListBoxItems,function(e){h=t.ComponentsDropdownDropdownCallout={},Object.defineProperty(t,"__esModule",{value:!0});const n=10,r=256;t.ComponentsDropdownDropdownCallout.DropdownCallout=function(e){return s.createElement(a,Object.assign({},e))};class a extends s.Component{constructor(e){super(e),this.calloutContent=s.createRef(),this.state={scrollBarWidth:0}}componentDidMount(){window.requestAnimationFrame(()=>{if(this.calloutContent.current){const e=this.calloutContent.current.offsetWidth-this.props.width;this.state.scrollBarWidth!==e&&this.setState({scrollBarWidth:e})}})}render(){const{actions:e,anchorElement:a,anchorOffset:d,anchorOrigin:c,anchorPoint:h,calloutContentClassName:u,containerClassName:m,dropdownOrigin:b,excludeFocusZone:x,excludeTabStop:f,filteredItems:I,filteredNoResultsText:g,filterPlaceholderText:v,filterText:w,focusOnMount:C,getUnselectableRanges:E,id:D,items:F,lightDismiss:S,listBoxClassName:P,listBoxRef:O,loading:T,onActivate:y,onFilterTextChanged:B,onSelect:L,renderBeforeContent:N,renderItem:R,searching:U,selection:V,showFilterBox:k,updateFilteredItems:M,userFilteredItems:A}=this.props;let{width:_=r}=this.props;_>0&&(_-=this.state.scrollBarWidth);const j=`bolt-dropdown-textfield-${D}`,W=()=>{this.props.onDismiss&&this.props.onDismiss(),w.value="",B&&B(null,""),M()};return s.createElement(t.Callout.Callout,{anchorElement:a,anchorOffset:d,anchorOrigin:c,anchorPoint:h,blurDismiss:!0,calloutOrigin:b,contentClassName:t.Util.css(u,"bolt-dropdown flex-column custom-scrollbar v-scroll-auto h-scroll-hidden"),contentRef:this.calloutContent,contentShadow:!0,contentSize:3,escDismiss:!0,id:D,lightDismiss:S,focuszoneProps:{postprocessKeyStroke:e=>9!==e.which||e.defaultPrevented?1:(e.preventDefault(),W(),3)},onDismiss:W},s.createElement(t.FocusZone.FocusZone,{circularNavigation:!0,defaultActiveElement:k?`#${t.Util.getSafeId(j)}`:".bolt-dropdown-container",direction:2,focusOnMount:void 0===C||C},s.createElement("div",{className:"bolt-dropdown-container",tabIndex:f?void 0:-1},s.createElement(t.Observer.Observer,{items:F},()=>{return(void 0===k?F.length>n:k)?s.createElement("div",{className:"bolt-dropdown-filter-container",style:{width:_}},s.createElement(t.TextField.TextField,{className:"bolt-dropdown-filter",excludeTabStop:!0,inputId:j,onChange:B,placeholder:v,prefixIconProps:{iconName:"Search"},value:w})):null}),N&&N(),s.createElement(t.Observer.Observer,{filteredItems:I,listBoxItems:{observableValue:F,filter:M},userFilteredItems:{observableValue:A,filter:M}},()=>{let e=null,i="";return 0!==I.length||U||(i=""===w.value?this.props.noItemsText:o.format(g||l.NoFilterResults,w.value),e=s.createElement("div",{className:"bolt-dropdown-no-items"},i)),s.createElement(s.Fragment,null,e,s.createElement(p.ListBox,{className:P,containerClassName:t.Util.css("bolt-dropdown-list-box-container",m),excludeFocusZone:x,excludeTabStop:!0,focuszoneProps:null,getUnselectableRanges:E,items:I.value,loading:T,onActivate:y,onSelect:L,renderItem:R,ref:O,searching:U,selection:V,width:_}))}),s.createElement(t.Observer.Observer,{actions:e},e=>{const n=this.props.actions;return n&&n.length?s.createElement("div",{className:"bolt-actions-container flex-column"},i.ObservableLike.getValue(n).map((e,i)=>s.createElement(t.Button.Button,Object.assign({key:e.id||i,subtle:!0,excludeTabStop:!0},e)))):null}))))}}a.defaultProps={width:r}}(),function(e){u=t.ComponentsDropdownDropdownExpandableTextField={},Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentsDropdownDropdownExpandableTextField.DropdownExpandableTextField=function(e){const{editable:i,expandableRef:n,items:o,inputClassName:l,onFocus:r,renderSelectedItems:d,selection:c}=e,p=__rest(e,["editable","expandableRef","items","inputClassName","onFocus","renderSelectedItems","selection"]);let h;return i||(h=e.placeholder,c.selectedCount>0&&(h=d(c,o))),s.createElement(a.ExpandableTextField,Object.assign({inputType:i?void 0:"button",ref:n,value:h,focusTreatment:i?0:1},p,{className:t.Util.css(e.className,"bolt-dropdown-expandable-text-field"),onFocus:i?e=>{n.current&&n.current.expand(),r&&r(e)}:r,inputClassName:t.Util.css(l,"bolt-dropdown-expandable-textfield-input flex-row")}))}}(),function(e){m=t[e]={},Object.defineProperty(t,"__esModule",{value:!0});class r extends s.Component{constructor(e){super(e),this.expandable=s.createRef(),this.expandableContainer=s.createRef(),this.filterText=new i.ObservableValue(""),this.collapse=(()=>{this.expandable.current&&this.expandable.current.collapse()}),this.expand=(()=>{this.expandable.current&&this.expandable.current.expand()}),this.onDismiss=(()=>{this.expandable.current&&this.expandable.current.collapse()}),this.onExpand=(()=>{this.props.onExpand&&this.props.onExpand(),this.updateFilteredItems()}),this.onActivate=((e,t)=>{e.defaultPrevented||"keydown"!==e.type||(this.state.filteredSelection.toggle(this.state.filteredItems.value.indexOf(t),this.state.filteredSelection.alwaysMerge),this.onSelect(e,t))}),this.onFilterTextChanged=((e,t)=>{this.filterText.value=t,this.updateFilteredItems()}),this.onSelect=((e,t)=>{const s=this.parentSelection;this.props.onSelect&&this.props.onSelect(e,t),s.value.length>0&&!s.multiSelect&&!s.selectOnFocus&&this.onDismiss()}),this.selectionChanged=((e,t)=>(this.state.filteredSelection.selectionChanged(e,t),!0)),this.renderCallout=((e,t,s,i,n,o,l)=>{const{actions:r,calloutContentClassName:a,containerClassName:d,filterPlaceholderText:c,filteredNoResultsText:p,getUnselectableRanges:h,items:u,loading:m,noItemsText:b,renderItem:x,searching:f,showFilterBox:I,userFilteredItems:g}=this.props,{setCalloutWidthToExpandableWidth:v}=this.props;let w=this.props.width;v&&void 0===w&&this.expandableContainer.current&&(w=this.expandableContainer.current.clientWidth);const{filteredItems:C,filterText:E,filteredSelection:D}=this.state,F={actions:r,anchorElement:s,anchorOffset:i,anchorOrigin:n,anchorPoint:o,calloutContentClassName:a,containerClassName:d,dropdownOrigin:l,filteredItems:C,filteredNoResultsText:p,selection:D,filterPlaceholderText:c,filterText:E,getUnselectableRanges:h,id:t,items:u,loading:m,noItemsText:b,onActivate:this.onActivate,onFilterTextChanged:this.onFilterTextChanged,onDismiss:this.onDismiss,onSelect:this.onSelect,renderItem:x,searching:f,showFilterBox:I,updateFilteredItems:this.updateFilteredItems,userFilteredItems:g,width:w};return this.props.renderCallout(F)}),this.updateFilteredItems=(()=>(b(this.props,this.state),!0)),this.parentSelection=e.selection||new d.DropdownSelection;const n=p.wrapListBoxItems(e.items),o=p.getListBoxItemsValue(n||e.items);this.state={filteredItems:new i.ObservableArray([...o]),filteredSelection:new t.List.FilteredListSelection(this.parentSelection),filterText:this.filterText,props:e,wrappedItems:n}}static getDerivedStateFromProps(e,t){return e.userFilteredItems===t.props.userFilteredItems&&e.items===t.props.items||b(e,t),Object.assign({},t,{props:e,wrappedItems:p.wrapListBoxItems(e.items)})}render(){const{ariaLabel:e,className:i,items:n,placeholder:o,onCollapse:l,renderExpandable:r}=this.props,a={observableValue:this.parentSelection,filter:this.selectionChanged};return s.createElement(t.Observer.ItemsObserver,{getUnselectableRanges:this.props.getUnselectableRanges,items:n,selection:this.parentSelection},s.createElement(t.Observer.Observer,{selection:a},()=>r({ariaLabel:e,className:t.Util.css(i,"bolt-dropdown-expandable"),containerRef:this.expandableContainer,placeholder:o,onCollapse:l,onExpand:this.onExpand,expandableRef:this.expandable,renderCallout:this.renderCallout,items:p.getListBoxItemsValue(this.state.wrappedItems||n),renderSelectedItems:c,selection:this.parentSelection})))}focus(){this.expandable.current&&this.expandable.current.focus()}}function a(e,t){return!(!t.text||2===t.type||3===t.type)&&-1!==t.text.toLowerCase().indexOf(e.toLowerCase())}function c(e,t){let s=t[e.value[0].beginIndex].text||"";return e.selectedCount>1&&(s=`${s} (+${e.selectedCount-1})`),s}function b(e,s){const{filteredSelection:i,filterText:r}=s;let a=[];const d=p.getListBoxItemsValue(s.wrappedItems||e.items);let c=d;if(e.userFilteredItems){c=t.UtilitiesProvider.getItemsValue(e.userFilteredItems);for(let t=0;t<e.userFilteredItems.length;t++){const e=d.indexOf(c[t]);0,a.push(e)}}if(e.filterByText&&r.value){const t=x(c,r.value,a,e.filterItem);c=t.filteredItems,a=t.filteredIndexMap}for(;c.length&&3===c[0].type;)c.shift(),a.shift();return r.value&&n.announce(c.length>0?o.format(l.AnnounceFilterResultCount,c.length):l.NoFilterResults,!0),s.filteredItems.value=c,i.updateFilteredSelection(a),!0}function x(e,t,s=[],i=a){const n=[],o=[];if(t){let l="";for(let r=e.length-1;r>=0;r--){if((2===e[r].type||3===e[r].type)&&e[r].groupId&&e[r].groupId===l){const t=s.length?s[r]:r;o.unshift(t),n.unshift(e[r])}if(i(t,e[r],e)){const t=s.length?s[r]:r;o.unshift(t),n.unshift(e[r]),l=e[r].groupId}}}return{filteredItems:n,filteredIndexMap:o}}r.defaultProps={filterByText:!0,filterItem:a,getUnselectableRanges:p.getUnselectableRanges,renderCallout:h.DropdownCallout,renderExpandable:u.DropdownExpandableTextField,renderSelectedItems:c},t[e].Dropdown=r,t[e].filterItemByText=a,t[e].renderDropdownSelectedItemText=c,t[e].filterItems=x}("ComponentsDropdownDropdown"),function(e){b=t.ComponentsDropdownDropdownExpandableButton={},Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentsDropdownDropdownExpandableButton.DropdownExpandableButton=function(e){const{expandableRef:i,items:n,placeholder:o,renderSelectedItems:l,selection:r}=e,a=__rest(e,["expandableRef","items","placeholder","renderSelectedItems","selection"]);let d=o;return r.selectedCount>0&&(d=l(r,n)),s.createElement(t.Button.ExpandableButton,Object.assign({ref:i},a),s.createElement("div",{className:"bolt-dropdown-expandable-button-label justify-start flex-grow text-ellipsis"},d))}}(),function(e){x=t.ComponentsDropdownDropdownFilterBarItem={},Object.defineProperty(t,"__esModule",{value:!0});const o=256;t.ComponentsDropdownDropdownFilterBarItem.DropdownFilterBarItem=class extends t.FilterBarItem.FilterBarItem{constructor(e){super(e),this.dropdown=s.createRef(),this.renderExpandableButton=(e=>{const{className:i,renderExpandable:n}=this.props,o=Object.assign({},e,{className:t.Util.css(i,"bolt-dropdown-filter-bar-item"),subtle:!0,renderSelectedItems:this.renderSelectedItems});return n?n(o):s.createElement(b.DropdownExpandableButton,Object.assign({},o))}),this.onClearClick=(()=>{this.selection.clear(),n.announce(l.AnnounceFilterCleared)}),this.onSelectionChanged=(e=>{const s=p.getListBoxItemsValue(this.wrappedItems||this.props.items),i=[];for(let t=0;t<e.length;t++)for(let n=e[t].beginIndex;n<=e[t].endIndex;n++)i.push(void 0!==s[n].data?s[n].data:s[n].id);if(this.props.filter){const e=this.props.filter.getFilterItemState(this.props.filterItemKey);let s=!1;(s=e?!t.Util.arrayEquals(e.value,i):!!i.length)&&this.setFilterValue({value:i})}return!0}),this.renderSelectedItems=((e,t)=>{let i=t[e.value[0].beginIndex].text||"";e.selectedCount>1&&(i=`${i} (+${e.selectedCount-1})`);const n=s.createElement("span",{className:"bolt-dropdown-filter-bar-item-selected-text"},i);return this.props.showPlaceholderAsLabel?s.createElement(s.Fragment,null,s.createElement("span",{className:"bolt-dropdown-filter-bar-item-placeholder"},`${this.props.placeholder}: `),n):n}),this.selection=e.selection||new d.DropdownSelection,this.wrappedItems=p.wrapListBoxItems(e.items)}focus(){this.dropdown.current&&this.dropdown.current.focus()}componentDidMount(){if(super.componentDidMount(),this.props.filter){const e=this.props.filter.getFilterItemState(this.props.filterItemKey);if(e&&e.value){const s=p.getListBoxItemsValue(this.wrappedItems||this.props.items),i=new t.List.ListSelection(this.selection.multiSelect);for(let t=0;t<e.value.length;t++){const n=s.findIndex(s=>s.id===e.value[t]||s.data===e.value[t]);i.select(n,1,!0)}this.selection.value=i.value}}}render(){return s.createElement(t.Observer.SelectionObserver,{selection:this.selection,onSelectionChanged:this.onSelectionChanged},()=>{const e=[...i.ObservableLike.getValue(this.props.actions||[])];return this.props.hideClearAction||e.push({className:"bolt-dropdown-action-right-button",disabled:0===this.selection.selectedCount,iconProps:{iconName:"Clear"},text:l.DropdownClearActionText,onClick:this.onClearClick}),s.createElement(m.Dropdown,Object.assign({renderExpandable:this.renderExpandableButton,width:o},this.props,{actions:e,selection:this.selection,ref:this.dropdown}))})}onFilterChanged(e){if(super.onFilterChanged(e),e&&e.value){const s=new t.List.ListSelection(this.selection.multiSelect),i=p.getListBoxItemsValue(this.wrappedItems||this.props.items);for(let t=0;t<e.value.length;t++){const n=i.findIndex(s=>s.id===e.value[t]||s.data===e.value[t]);s.select(n,1,!0)}t.UtilitiesSelection.compareSelectionRanges(this.selection.value,s.value).length&&(this.selection.value=s.value)}else this.selection.clear()}}}(),function(e){f=t.ComponentsDropdownWithPivots={},Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentsDropdownWithPivots.WithPivots=function(e){const n=n=>s.createElement(h.DropdownCallout,Object.assign({},n,{renderBeforeContent:()=>(function(e){return s.createElement(t.FocusZone.FocusZoneContext.Consumer,null,n=>s.createElement(t.FocusZone.FocusZone,{direction:1},s.createElement("div",null,s.createElement(t.FocusWithin.FocusWithin,null,o=>e.pivots.map((l,r)=>s.createElement(t.Button.Button,{className:"bolt-dropdown-pivot",key:l.id,subtle:!0,onBlur:o.onBlur,onClick:()=>(function(e,t){t.onPivotClicked&&t.onPivotClicked(e)})(l,e),onFocus:o.onFocus,focusZoneId:0!==r||o.hasFocus?void 0:n.focuszoneId},s.createElement("span",{className:t.Util.css(e.selectedPivot&&l.id===i.ObservableLike.getValue(e.selectedPivot)&&"bolt-dropdown-pivot-selected")},l.name||l.id)))))))})(e)}));return s.createElement(t.Observer.Observer,{selectedPivot:e.selectedPivot},()=>{const t=function(e){let t;if(e.selectedPivot){const s=i.ObservableLike.getValue(e.selectedPivot);t=e.pivots.find(e=>e.id===s)}return t||e.pivots[0]}(e),s={actions:t.actions,filterByText:t.filterByText,userFilteredItems:t.items,filteredNoResultsText:t.filteredNoResultsText,filterPlaceholderText:t.filterPlaceholderText,noItemsText:t.noItemsText,renderCallout:n,showFilterBox:t.showFilterBox};return e.children(s)})}}(),I=t.Dropdown={},Object.defineProperty(t,"__esModule",{value:!0}),t.Dropdown.Dropdown=m.Dropdown,t.Dropdown.filterItems=m.filterItems,t.Dropdown.DropdownCallout=h.DropdownCallout,t.Dropdown.DropdownExpandableButton=b.DropdownExpandableButton,t.Dropdown.DropdownExpandableTextField=u.DropdownExpandableTextField,t.Dropdown.DropdownFilterBarItem=x.DropdownFilterBarItem,t.Dropdown.WithPivots=f.WithPivots,function(e){g=t.UtilitiesEditableDropdownItemProvider={},Object.defineProperty(t,"__esModule",{value:!0});t.UtilitiesEditableDropdownItemProvider.EditableDropdownItemProvider=class{constructor(e,t){this.itemCollection=new i.ObservableCollection,i.ObservableLike.isObservable(e)?this.listItems=e:this.listItems=new i.ObservableArray(p.wrapListBoxItems(e)||e),this.itemCollection.push(this.listItems),this.extraItem=new i.ObservableArray,this.itemCollection.push(this.extraItem),this.selection=t,this.internalFilteredIndexMap=this.listItems.value.map((e,t)=>t),this.internalFocusedIndex=-1}updateFilteredItems(e){const t=this.filteredIndexMap.indexOf(this.focusedIndex);this.internalFilteredIndexMap=e;let s=e[t];(!s||s<0||!this.selection.selectable(s)||-1===this.filteredIndexMap.indexOf(s))&&(s=this.internalFilteredIndexMap.find(e=>this.selection.selectable(e))),this.focusItem(s)}get length(){return this.itemCollection.length}get value(){return this.itemCollection.value}get focusedIndex(){return this.internalFocusedIndex}get filteredIndexMap(){return this.internalFilteredIndexMap}get hasExtraItem(){return this.extraItem.length>0}subscribe(e,t){this.itemCollection.subscribe(e,t)}unsubscribe(e,t){return this.itemCollection.unsubscribe(e,t)}focusNextItem(){const e=this.internalFilteredIndexMap.find(e=>e>this.focusedIndex&&this.selection.selectable(e));this.focusItem(e)}focusPreviousItem(){let e;for(let t=this.filteredIndexMap.indexOf(this.focusedIndex)-1;t>=0;t--)if(this.selection.selectable(this.filteredIndexMap[t])){e=this.filteredIndexMap[t];break}this.focusItem(e)}setTextValue(e){if(this.hasExtraItem&&this.extraItem.splice(0,1),e){const t=this.listItems.value.findIndex(t=>t.text===e);-1!==t&&this.selection.selectable(t)||this.extraItem.push({id:e,text:o.format(l.UseItem,e)})}}focusItem(e){if(void 0!==e&&e>-1){if(this.focusedIndex>-1){const e=this.value[this.focusedIndex];e&&e.className&&(e.className=e.className.replace("bolt-editable-dropdown-focused-item",""),this.notifyChange(this.focusedIndex))}this.internalFocusedIndex=e;const s=this.value[this.focusedIndex];s.className=t.Util.css("bolt-editable-dropdown-focused-item",s.className),this.notifyChange(this.focusedIndex)}}notifyChange(e){e===this.value.length-1&&this.hasExtraItem?this.extraItem.change(0):this.listItems.change(e)}}}(),function(e){v=t.ComponentsEditableDropdownCustomEditableDropdown={},Object.defineProperty(t,"__esModule",{value:!0});class n extends s.Component{constructor(e){super(e),this.dropdown=s.createRef(),this.listBox=s.createRef(),this.collapse=(()=>{this.dropdown.current&&this.dropdown.current.collapse()}),this.expand=(()=>{this.dropdown.current&&this.dropdown.current.expand()}),this.onCollapse=(()=>{const{allowFreeform:e,onCollapse:t,onTextChange:s,onValueChange:n,text:o}=this.props;t&&t();const l=this.itemProvider.value.findIndex((e,t)=>this.selection.selectable(t)&&e.text===i.ObservableLike.getValue(o||""));l>-1&&this.selectIndex(l);const r=this.itemProvider.length-1;if(!e||this.selection.value.length&&this.selection.value[0].beginIndex!==r&&this.selectedItemInList||!this.itemProvider.hasExtraItem){if(this.selection.value.length){const e=this.itemProvider.value[this.selection.value[0].beginIndex];n&&n(e)}}else{const e=this.itemProvider.value[r].id;n&&n({id:e,text:e}),this.selection.clear()}s&&s(null,""),this.isExpanded=!1,this.selectedItemInList=!1}),this.onItemsChange=((e,t)=>{"change"!==t&&this.updateFilteredItems()}),this.onSelect=((e,t)=>{this.selectedItemInList=!0}),this.renderExpandable=(e=>{const{onTextChange:t,text:s}=this.props,i=Object.assign({},e,{editable:!0,onChange:t,onKeyDown:this.onKeyDown,value:s});return this.props.renderExpandable(i)}),this.renderCallout=(e=>{const t=Object.assign({},e,{focusOnMount:!1,lightDismiss:!0,excludeTabStop:!0,excludeFocusZone:!0,listBoxRef:this.listBox});return this.props.renderCallout(t)}),this.onExpand=(()=>{this.props.onExpand&&this.props.onExpand(),this.filteredItems.splice(0,this.filteredItems.length,...this.itemProvider.value),this.itemProvider.updateFilteredItems(this.filteredItems.value.map((e,t)=>t)),this.isExpanded=!0}),this.onValueChange=(()=>{const{allowFreeform:e}=this.props,t=i.ObservableLike.getValue(this.props.text||"");return e&&(this.itemProvider.hasExtraItem&&this.filteredItems.pop(),this.itemProvider.setTextValue(t)),this.updateFilteredItems(),!1}),this.updateFilteredItems=(()=>{const e=this.itemProvider.value,t=i.ObservableLike.getValue(this.props.text||"");if(t){const{filteredItems:e,filteredIndexMap:s}=I.filterItems(this.itemProvider.value,i.ObservableLike.getValue(t||""),[],this.props.filterItem);this.filteredItems.splice(0,this.filteredItems.length,...e),this.itemProvider.updateFilteredItems(s)}else this.filteredItems.splice(0,this.filteredItems.length,...e),this.itemProvider.updateFilteredItems(this.filteredItems.value.map((e,t)=>t));return!1}),this.onKeyDown=(e=>{switch(e.which){case 27:this.collapse(),e.preventDefault();break;case 9:case 13:this.isExpanded?!e.shiftKey&&this.filteredItems.length&&(this.selectIndex(this.itemProvider.focusedIndex),this.collapse(),e.preventDefault()):(this.expand(),e.preventDefault());break;case 38:this.isExpanded&&(this.itemProvider.focusPreviousItem(),this.listBox.current&&this.listBox.current.scrollIntoView(this.itemProvider.filteredIndexMap.indexOf(this.itemProvider.focusedIndex),{block:"nearest"})),e.preventDefault();break;case 40:this.isExpanded?(this.itemProvider.focusNextItem(),this.listBox.current&&this.listBox.current.scrollIntoView(this.itemProvider.filteredIndexMap.indexOf(this.itemProvider.focusedIndex),{block:"nearest"})):this.isExpanded||this.expand(),e.preventDefault();break;case 46:case 8:i.ObservableLike.getValue(this.props.text||"")||(this.selection.clear(),this.props.onValueChange&&this.props.onValueChange());break;default:this.expand()}}),this.selection=e.selection||new d.DropdownSelection,this.itemProvider=new g.EditableDropdownItemProvider(e.items,this.selection),this.filteredItems=new i.ObservableArray([...this.itemProvider.value])}render(){const{ariaLabel:e,calloutContentClassName:i,className:n,getUnselectableRanges:o,noItemsText:r,selectedText:a,text:d}=this.props;return s.createElement(t.Observer.Observer,{text:{observableValue:d,filter:this.onValueChange},items:{observableValue:this.props.items,filter:this.onItemsChange},selection:this.selection,selectedText:a},a=>{let d=this.props.placeholder;if(a.selectedText)d=a.selectedText;else if(a.selection.length){const e=a.selection[0].beginIndex;d=this.itemProvider.value[e].text}return s.createElement(I.Dropdown,{ariaLabel:e,calloutContentClassName:i,className:t.Util.css("bolt-editable-dropdown",(a.selection.length>0||!!a.selectedText)&&"bolt-editable-dropdown-with-selection",n),getUnselectableRanges:o,items:this.itemProvider,noItemsText:r||l.NoItemsFound,onCollapse:this.onCollapse,onExpand:this.onExpand,onSelect:this.onSelect,placeholder:d,ref:this.dropdown,renderExpandable:this.renderExpandable,renderCallout:this.renderCallout,selection:this.selection,showFilterBox:!1,userFilteredItems:this.filteredItems})})}focus(){this.dropdown.current&&this.dropdown.current.focus()}selectIndex(e){const{allowFreeform:t,onValueChange:s}=this.props;this.selection.select(e),!t&&s&&s(this.itemProvider.value[e]),this.selectedItemInList=!0}}n.defaultProps={renderExpandable:I.DropdownExpandableTextField,renderCallout:I.DropdownCallout},t.ComponentsEditableDropdownCustomEditableDropdown.CustomEditableDropdown=n}(),function(e){w=t.ComponentsEditableDropdownEditableDropdown={},Object.defineProperty(t,"__esModule",{value:!0});t.ComponentsEditableDropdownEditableDropdown.EditableDropdown=class extends s.Component{constructor(e){super(e),this.dropdown=s.createRef(),this.collapse=(()=>{this.dropdown.current&&this.dropdown.current.collapse()}),this.expand=(()=>{this.dropdown.current&&this.dropdown.current.expand()}),this.onTextChange=((e,t)=>{this.props.onTextChange&&this.props.onTextChange(e,t),this.text.value=t}),this.onValueChange=(e=>{this.props.onValueChange&&this.props.onValueChange(e),this.selectedText.value=e&&e.text||""}),this.text=i.ObservableLike.isObservable(e.text)?e.text:new i.ObservableValue(e.text),this.selectedText=i.ObservableLike.isObservable(e.selectedText)?e.selectedText:new i.ObservableValue(e.selectedText)}focus(){this.dropdown.current&&this.dropdown.current.focus()}render(){return s.createElement(v.CustomEditableDropdown,Object.assign({},this.props,{onTextChange:this.onTextChange,onValueChange:this.onValueChange,ref:this.dropdown,selectedText:this.selectedText,text:this.text}))}}}(),t.EditableDropdown={},Object.defineProperty(t,"__esModule",{value:!0}),t.EditableDropdown.EditableDropdown=w.EditableDropdown,t.EditableDropdown.CustomEditableDropdown=v.CustomEditableDropdown,function(e){t.UtilitiesGroupedItemProvider={},Object.defineProperty(t,"__esModule",{value:!0});t.UtilitiesGroupedItemProvider.GroupedItemProvider=class{constructor(e,t,s){this.listItems=new i.ObservableArray,this.internalGroups=[...t],this.groupedItems=[[]];for(let e=0;e<this.internalGroups.length;e++)this.groupedItems.push([]);this.addItems(e);for(let e=0;e<this.internalGroups.length;e++)this.internalGroups[e].loading&&this.setGroupLoading(this.internalGroups[e].id,!0);s&&this.addHeaders(1,this.groups.length),this.manageHeaders=!!s}get groups(){return this.internalGroups}get length(){return this.listItems.length}get value(){return this.listItems.value}subscribe(e,t){this.listItems.subscribe(e,t)}unsubscribe(e,t){return this.listItems.unsubscribe(e,t)}push(...e){return this.addItems(e),e.length}pushGroups(...e){return this.addGroups(this.internalGroups.length,...e),this.internalGroups.length}pop(){const e=this.listItems.pop();return e&&this.removeItems([e]),e}removeAll(e){const t=this.listItems.removeAll(e);return this.removeItems(t,!1),t}splice(e,t,...s){const i=this.listItems.splice(e,t);return this.removeItems(i,!1),this.addItems(s),i}change(e,...t){const s=this.listItems.value.slice(e,t.length);return this.removeItems(s,!1),this.addItems(t,!1),this.listItems.change(e,...t),t.length}spliceGroups(e,t,...s){for(let s=0;s<t;s++){const t=e+s+1;if(this.groupedItems.length>t){if(this.removeItems([...this.groupedItems[t]]),this.manageHeaders){const e=this.groupedItems.findIndex(e=>e.length>0);e>0&&3===this.groupedItems[e][0].type&&this.removeItems([this.groupedItems[e][0]])}this.groupedItems.splice(t,1)}}const i=this.internalGroups.splice(e,t);return this.addGroups(e,...s),i}setGroupLoading(e,t,s){let i=this.groups.findIndex(t=>t.id===e);if(i<0)return;i++;const n=this.groupedItems[i];if(!t&&n.length&&4===n[n.length-1].type)this.removeItems([n[n.length-1]]);else if(t&&0===n.length||4!==n[n.length-1].type){const t=s||{id:e+"-loading",type:4,groupId:e};this.addItems([t])}this.groups[i-1].loading=t}addHeaders(e,t=1){for(let s=e;s<e+t;s++){let e=this.groups[s-1];if(this.groupedItems[s].length>0){this.groupedItems[s].find(e=>2===e.type)||this.addItems([{id:e.id+"-header",text:e.name||e.id,type:2,groupId:e.id}]),this.groupedItems.some((e,t)=>t<s&&e.length>0)&&!this.groupedItems[s].find(e=>3===e.type)&&this.addItems([{id:e.id+"-divider",type:3,groupId:e.id}]);const t=this.groupedItems.findIndex((e,t)=>t>s&&e.length>0);t>0&&!this.groupedItems[t].find(e=>3===e.type)&&(e=this.groups[t-1],this.addItems([{id:e.id+"-divider",type:3,groupId:e.id}]))}}}addGroups(e,...t){this.internalGroups.splice(e,0,...t);const s=[];for(let i=0;i<t.length;i++){this.groupedItems.splice(e+i+1,0,[]);for(let e=this.groupedItems[0].length-1;e>=0;e--)if(this.groupedItems[0][e].groupId===t[i].id){const t=this.groupedItems[0].splice(e,1)[0];this.listItems.splice(e,1),s.unshift(t)}}this.addItems(s),this.manageHeaders&&this.addHeaders(e+1,t.length);for(let e=0;e<t.length;e++)t[e].loading&&this.setGroupLoading(t[e].id,!0)}addItems(e,t=!0){for(let s=0;s<e.length;s++){let i=!1,n=0,o=0;const l=e[s].groupId;void 0!==l&&(n=this.internalGroups.findIndex(e=>e.id===l)+1);for(let e=0;e<n;e++)o+=this.groupedItems[e].length;3===e[s].type?this.groupedItems[n].unshift(e[s]):2===e[s].type?this.groupedItems[n].length&&3===this.groupedItems[n][0].type?(this.groupedItems[n].splice(1,0,e[s]),o++):this.groupedItems[n].unshift(e[s]):(o+=this.groupedItems[n].length,this.groupedItems[n].push(e[s]),i=n>0&&1===this.groupedItems[n].length&&this.manageHeaders),t&&this.listItems.splice(o,0,e[s]),i&&this.addHeaders(n)}}removeItems(e,t=!0){for(let s=0;s<e.length;s++){let i=0,n=0;const o=e[s].groupId;void 0!==o&&(i=this.internalGroups.findIndex(e=>e.id===o)+1);for(let e=0;e<i;e++)n+=this.groupedItems[e].length;const l=this.groupedItems[i],r=l.indexOf(e[s]);l.splice(r,1),t&&this.listItems.splice(n+r,1)}}}}(),function(e){t.UtilitiesPivotItemProvider={},Object.defineProperty(t,"__esModule",{value:!0});t.UtilitiesPivotItemProvider.PivotItemProvider=class{constructor(e){this.listItems=new i.ObservableArray,this.internalPivots=e;for(let t=0;t<e.length;t++)this.listItems.push(...i.ObservableLike.getValue(e[t].items))}get pivots(){return this.internalPivots}get length(){return this.listItems.length}get value(){return this.listItems.value}subscribe(e,t){this.listItems.subscribe(e,t)}unsubscribe(e,t){return this.listItems.unsubscribe(e,t)}push(e,...t){let s=0;for(let i=0;i<this.pivots.length;i++)if(s+=this.pivots[i].items.length,this.pivots[i].id===e){this.pivots[i].items.push(...t),this.listItems.splice(s,0,...t);break}return this.length}pop(e){let t=0;for(let s=0;s<this.pivots.length;s++)if(t+=this.pivots[s].items.length,this.pivots[s].id===e)return this.pivots[s].items.pop(),this.listItems.splice(t-1,1)[0]}removeAll(e,t){let s=0;const n=[];for(let o=0;o<this.pivots.length;o++){if(this.pivots[o].id===e){const e=[...i.ObservableLike.getValue(this.pivots[o].items)];for(let i=0;i<e.length;i++)if(!t||t(e[i])){const e=this.pivots[o].items.splice(i,1);n.push(...e),this.listItems.splice(s+i,1)}break}s+=this.pivots[o].items.length}return n}splice(e,t,s,...i){let n=0;for(let o=0;o<this.pivots.length;o++){if(this.pivots[o].id===e){const e=this.pivots[o].items.splice(t,s,...i);return this.listItems.splice(n+t,s,...i),e}n+=this.pivots[o].items.length}return[]}}}()},["Resources.Dropdown","Components/ExpandableTextField/ExpandableTextField","ExpandableTextField","Utilities/DropdownSelection","Components/ListBox/ListBox","ListBox","Components/Dropdown/DropdownCallout","Components/Dropdown/DropdownExpandableTextField","Components/Dropdown/Dropdown","Components/Dropdown/DropdownExpandableButton","Components/Dropdown/DropdownFilterBarItem","Components/Dropdown/WithPivots","Dropdown","Utilities/EditableDropdownItemProvider","Components/EditableDropdown/CustomEditableDropdown","Components/EditableDropdown/EditableDropdown","EditableDropdown","Utilities/GroupedItemProvider","Utilities/PivotItemProvider"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-features.ui-dropdown-content"}}));