"use strict";define("Tfs/Frame",["require","exports","react","VSS/Platform/Layout","VSSUI/FocusZone","VSSUI/Expandable","VSSUI/Icon","VSSUI/Menu","VSS/Features/PlatformUI/ContributedMenu","VSS/Platform/Location","VSS/Platform/UserClaims","VSSUI/Observer","VSS/Features/PlatformUI/FPSLink","VSS/Core/Util/Screen","VSS/Core/Observable","VSS/Core/Util/String","VSS/Platform/FPS","VSSUI/Callout","VSSUI/FocusGroup","VSSUI/TooltipEx","VSSUI/Util","VSSUI/Utilities/Focus","Tfs/Platform/Navigation","Tfs/Platform/ProjectPersona","VSS/Features/PlatformUI/ContributedIcon","VSS/Platform/Util/Url","VSSUI/Link","VSS/Features/Services/OrganizationsService","VSSUI/VssPersona","VSS/Platform/Identity","VSS/Platform/Context","Tfs/Platform/HeaderActions"],function(e,t,n,o,s,a,i,r,l,c,m,d,u,p,h,g,v,f,C,x,b,S,w,N,E,I,y,k,P,M,L,O){var U,z,A,H,V,j;U=t.Resources={},Object.defineProperty(t,"__esModule",{value:!0}),t.Resources.AccessLevels="Access levels",t.Resources.CollectionSettings="Collection Settings",t.Resources.BrandName="Azure",t.Resources.Collections="Collections",t.Resources.Create="Create",t.Resources.Documentation="Documentation",t.Resources.GetHelp="Get help",t.Resources.ManageUserSettings="Manage the currently logged in user settings",t.Resources.Marketplace="Marketplace",t.Resources.MyOrgs="My organizations",t.Resources.MyWorkLabel="My Work",t.Resources.NewOrg="New organization",t.Resources.OrgSettings="Organization settings",t.Resources.ProjectSettings="Project settings",t.Resources.ProductName="DevOps",t.Resources.RelatedPages="Related pages",t.Resources.ShowLess="Show less information",t.Resources.ShowMore="Show more information",t.Resources.SignIn="Sign in",t.Resources.SuiteLogoLabel="Azure DevOps organization home page",t.Resources.SuiteLogoLabelOnPrem="Azure DevOps collection home page",t.Resources.WhatsNew="What's new in DevOps",t.Resources.MoreOrganizations="{0} more organizations",t.Resources.OneMoreOrganization="1 more organization",t.Resources.AzureDevOpsProfile="User settings",t.Resources.PreviewFeatures="Preview features",function(e){t.ComponentsHeaderProjectHeader={},Object.defineProperty(t,"__esModule",{value:!0});o.Components.add("ms.vss-tfs-web.frame.project-header",class extends n.Component{render(){return n.createElement(s.FocusZone,{circularNavigation:!0,direction:1,focusGroupProps:{defaultElementId:"suite-logo"}},n.createElement("div",{className:"project-header flex-row flex-noshrink",role:"navigation"},n.createElement(o.RegionComponent,{className:"flex-row flex-grow",componentRegion:"header",role:"menubar"})))}})}(),function(e){t.ComponentsHeaderTopLevelHeader={},Object.defineProperty(t,"__esModule",{value:!0});o.Components.add("ms.vss-tfs-web.frame.top-level-header",class extends n.Component{render(){return n.createElement(s.FocusZone,{circularNavigation:!0,direction:1,focusGroupProps:{defaultElementId:"suite-logo"}},n.createElement("div",{className:"top-level-header flex-row flex-noshrink",role:"navigation"},n.createElement(o.RegionComponent,{className:"flex-row flex-grow",componentRegion:"header",role:"menubar"})))}})}(),function(e){t.ComponentsHelpHelp={},Object.defineProperty(t,"__esModule",{value:!0});class s extends o.VssComponent{constructor(){super(...arguments),this.renderCallout=((e,t,o)=>n.createElement(r.ContextualMenu,{onDismiss:e.collapse,anchorElement:o,anchorOrigin:{horizontal:"end",vertical:"end"},menuProps:{id:"help-menu",items:l.getMenuItems(this.context.pageContext,"ms.vss-tfs-web.help-menu")},menuOrigin:{horizontal:"end",vertical:"start"}}))}render(){return n.createElement(a.ExpandableContainer,{className:"commandbar-item commandbar-icon cursor-pointer flex-row flex-noshrink justify-center",renderCallout:this.renderCallout,role:"menuitem"},n.createElement(i.Icon,{iconName:"Help"}))}}t.ComponentsHelpHelp.Help=s,o.VssComponent.register("ms.vss-tfs-web.help",s)}(),function(e){t.ComponentsMarketMarket={},Object.defineProperty(t,"__esModule",{value:!0});class s extends o.VssComponent{constructor(){super(...arguments),this.renderCallout=((e,t,o)=>n.createElement(r.ContextualMenu,{onDismiss:e.collapse,anchorElement:o,anchorOrigin:{horizontal:"end",vertical:"end"},menuProps:{id:t,items:l.getMenuItems(this.context.pageContext,"ms.vss-tfs-web.market-menu")},menuOrigin:{horizontal:"end",vertical:"start"}}))}render(){return n.createElement(a.ExpandableContainer,{ariaLabel:U.Marketplace,className:"commandbar-item commandbar-icon cursor-pointer flex-row flex-noshrink justify-center",expandableId:"market-menu",renderCallout:this.renderCallout,role:"menuitem"},n.createElement(i.Icon,{iconName:"Shop"}))}}t.ComponentsMarketMarket.Market=s,o.VssComponent.register("ms.vss-tfs-web.market",s)}(),function(e){z=t.ComponentsSuiteLogoSuiteLogo={},Object.defineProperty(t,"__esModule",{value:!0});class s extends o.VssComponent{constructor(e,t){super(e,t),e.routeId&&m.userHasClaim(this.context.pageContext,"member")&&(this.href=c.routeUrl(this.context.pageContext,e.routeId));const n=t.pageContext.getService("IVssPageService").getData();if(this.isHosted=n.isHosted,this.props.alwaysExpanded)this.expanded=2;else{const e=t.pageContext.getService("ITfsNavigationService");this.expanded=e.getNavigationDisplayMode()}}render(){return n.createElement(p.ScreenContext.Consumer,null,e=>n.createElement(d.Observer,{key:"suite-logo",expanded:this.expanded,size:e.size},e=>n.createElement(u.FPSLink,{ariaLabel:this.isHosted?U.SuiteLogoLabel:U.SuiteLogoLabelOnPrem,className:"commandbar-item suite-logo flex-row flex-noshrink flex-center",href:this.href,id:"suite-logo",role:"menuitem",telemetrySource:"applicationLink"},n.createElement(i.Icon,{className:"suite-image commandbar-icon justify-center",iconName:"VSTSLogo"}),2===e.expanded&&(e.size>1||this.props.alwaysExpanded)&&n.createElement("span",{className:"font-size-m font-weight-heavy brand"},U.BrandName," ",U.ProductName))))}}t.ComponentsSuiteLogoSuiteLogo.SuiteLogo=s,o.VssComponent.register("ms.vss-tfs-web.suite-logo",s)}(),function(e){A=t.ComponentsNavigationProjectNavigation={},Object.defineProperty(t,"__esModule",{value:!0});class I extends o.VssComponent{constructor(e,t){super(e),this.navListRef=n.createRef(),this.checkAvailableNavigationHeight=(e=>!(1===e&&!1!==this.props.collapse||this.props.collapse)||window.innerHeight>=this.navigationHeight+this.fixedElementHeight),this.onActivateMenuItem=((e,t)=>v.onClickFPS(this.context.pageContext,e.href,!0,t)),this.onExpandedChange=(e=>{const t=this.checkAvailableNavigationHeight(e);return t!==this.showHubs.value&&(this.showHubs.value=t),!0}),this.onKeyDownToggle=(e=>{e.defaultPrevented||32!==e.which&&13!==e.which||(this.props.onToggleExpand?this.props.onToggleExpand():this.toggleExpansion(),e.preventDefault())}),this.onFpsLoading=(e=>{if(e.detail&&e.detail.data&&e.detail.data.navigationId){const t=this.context.pageContext.getService("IVssNavigationService"),n=t.getNavigation(e.detail.data.navigationId);n&&n.parentId&&(this.displayedHubGroupId=n.parentId,this.displayedHubId=n.id,this.buildNavigationLists(t,this.displayedHubGroupCollectionId,this.displayedHubGroupId),this.forceUpdate())}}),this.onResize=(()=>{const e=this.checkAvailableNavigationHeight(this.expanded.value);e!==this.showHubs.value&&(this.showHubs.value=e)}),this.onTransitionEnd=(e=>{this.navListRef.current===e.target&&window.dispatchEvent(new CustomEvent("resize"))}),this.renderMenuCell=((e,t,o)=>{if(1===e){const e=t.data;return n.createElement("div",{className:"bolt-menuitem-cell-content bolt-menuitem-cell-icon flex-row"},n.createElement(E.ContributedIcon,{alt:e.name,contributionId:e.id,icon:e.icon,iconAsset:e.iconAsset,iconName:e.iconName,iconSize:"medium",pageContext:this.context.pageContext}))}}),this.toggleExpansion=(()=>{this.context.pageContext.getService("ITfsNavigationService").setNavigationDisplayMode(2===this.expanded.value?1:2),this.context.pageContext.getService("IVssTelemetryService").publishEvent("WebPlatform","VerticalNavigation",{action:"vertical-nav-expanded",displayMode:this.expanded.value,hubsAreVisible:this.showHubs.value})});const o=t.pageContext.getService("ITfsNavigationService");this.expanded=o.getNavigationDisplayMode();const s=t.pageContext.getService("ITfsPageService").getData();s&&s.project&&(this.projectName=s.project.name,this.projectImageUrl=s.project.imageUrl,this.settingsUrl=c.routeUrl(t.pageContext,"ms.vss-admin-web.project-admin-hub-route",{project:this.projectName})),this.userIsMember=m.userHasClaim(t.pageContext,"member");const a=t.pageContext.getService("IVssLayoutManager").getComponentsForRegion("footer");this.fixedElementHeight=144+(a&&a.length>0?22:0)+2+8+(this.userIsMember?48:0)+(this.settingsUrl?48:0);const i=t.pageContext.getService("IVssNavigationService"),r=i.getDisplayedNavigation();this.displayedHubGroupCollectionId=r[1],this.displayedHubGroupId=r[2],this.displayedHubId=r[3],this.buildNavigationLists(i,this.displayedHubGroupCollectionId,this.displayedHubGroupId);let l=0;for(const e of this.hubGroups)l=Math.max(l,e.children.length);this.navigationHeight=48*this.hubGroups.length+40*l,this.showHubs=new h.ObservableValue(this.checkAvailableNavigationHeight(this.expanded.value))}render(){const{collapse:e,isCallout:t,onToggleExpand:o}=this.props;return n.createElement(d.Observer,{expanded:{filter:this.onExpandedChange,observableValue:this.expanded},showHubs:this.showHubs},c=>{let m,d,p;return!1===e||void 0===e&&2===c.expanded?(d=U.ShowLess,p="DoubleChevronLeft",m="expanded"):(d=U.ShowMore,p="DoubleChevronRight",m="collapsed"),n.createElement(s.FocusZone,{circularNavigation:!0,direction:2,focusGroupProps:{defaultElementId:"create-action"},focusOnMount:t,handleTabKey:t,postprocessKeyStroke:()=>2},n.createElement("div",{className:b.css("project-navigation region-navigation flex-column flex-grow font-size-m",m),"data-renderedregion":"navigation",ref:this.navListRef,role:"navigation",onTransitionEnd:this.onTransitionEnd},t&&n.createElement("div",{className:"region-header flex-row flex-noshrink"},n.createElement(z.SuiteLogo,{alwaysExpanded:!0})),n.createElement("div",{className:"collapsible-section flex-noshrink"},n.createElement("div",{className:"project-item flex-row flex-grow flex-center scroll-hidden"},n.createElement("span",{className:"navigation-icon flex-row flex-center flex-noshrink justify-center"},n.createElement(N.ProjectPersona,{displayName:this.projectName,size:"small",url:this.projectImageUrl})),n.createElement("span",{className:"font-weight-heavy font-size-m expanded-only flex-grow text-ellipsis"},this.projectName)),this.userIsMember&&n.createElement(a.ExpandableContainer,{ariaLabel:U.Create,className:"focus-treatment alt-hover-effect font-size-ml flex-row cursor-pointer",expandableId:"ms.vss-tfs-web.vertical-header-create-menu",expandKey:39,id:"create-action",renderCallout:(e,t,o)=>n.createElement(r.ContextualMenu,{anchorElement:o,anchorOrigin:{horizontal:"end",vertical:"start"},menuProps:{id:t,items:l.getMenuItems(this.context.pageContext,"ms.vss-tfs-web.vertical-header-create-menu")},menuOrigin:{horizontal:"start",vertical:"start"},onDismiss:e.collapse})},n.createElement(i.Icon,{className:"navigation-icon flex-row flex-center justify-center",iconName:"Add",size:"medium"}))),n.createElement("div",{className:"separator flex-row flex-noshrink"}),n.createElement("div",{className:b.css("navigation-section flex-column flex-grow scroll-hidden v-scroll-auto custom-scrollbar",(1===c.expanded&&!1!==e||!0===e)&&"custom-scrollbar-hidden"),role:"menubar"},this.hubGroups.map(e=>this.renderNavigation(e,!0,e.id===this.displayedHubGroupId&&c.showHubs))),n.createElement("div",{className:"separator flex-row flex-noshrink"}),n.createElement("div",{className:"collapsible-section flex-noshrink"},this.userIsMember&&n.createElement(u.FPSLink,{className:b.css("hub stand-alone navigation-element navigation-link focus-treatment hover-effect flex-row flex-grow flex-center scroll-hidden relative","ms.vss-admin-web.project-admin-hub"===this.displayedHubId&&"displayed"),href:this.settingsUrl,id:"settings-link",telemetrySource:"vertical.settings"},n.createElement(i.Icon,{ariaLabelledBy:"project-settings-text",className:"navigation-icon font-size-ml flex-row flex-center justify-center",iconName:"Settings",size:"medium"}),n.createElement("span",{className:"navigation-text expanded-only text-ellipsis",id:b.getSafeId("project-settings-text")},U.ProjectSettings)),n.createElement(C.FocusGroupContext.Consumer,null,e=>n.createElement(s.FocusZoneContext.Consumer,null,t=>n.createElement(x.Tooltip,{text:d},n.createElement("div",{"aria-label":d,className:"focus-treatment alt-hover-effect font-size flex-row","data-focuszone":t.focuszoneId,id:"project-expansion-toggle",onClick:o||this.toggleExpansion,onFocus:()=>{e.onFocus("project-expansion-toggle")},onKeyDown:this.onKeyDownToggle,role:"button",tabIndex:S.getTabIndex({id:"project-expansion-toggle"},e)},n.createElement(i.Icon,{className:"navigation-icon flex-row flex-center flex-noshrink justify-center cursor-pointer",iconName:p,size:"medium"}))))))))})}componentDidMount(){super.componentDidMount(),this.addEventListener(window,"resize",this.onResize),this.addEventListener(document.body,"fpsLoading",this.onFpsLoading)}buildNavigationLists(e,t,n){this.hubGroups=[],this.hubs=[];let o=e.getNavigation(t);if(o&&o.children)for(const e of o.children)32!=(32&(e.flags||0))&&e.children&&e.children.length&&this.hubGroups.push(e);if((o=e.getNavigation(n))&&o.children)for(const e of o.children)32!=(32&(e.flags||0))&&this.hubs.push(e);this.hubGroups=this.sortNavigationList(this.hubGroups),this.hubs=this.sortNavigationList(this.hubs)}getMenuProps(e){const t=[];t.push({id:e.id,itemType:2,text:e.name});for(let n=0;n<e.children.length;n++){const o=e.children[n];t.push({data:o,id:o.id,href:o.href,onActivate:this.onActivateMenuItem,renderMenuCell:this.renderMenuCell,text:o.name})}return{id:"menu-"+e.id,items:t}}navigationComparer(e,t){return e.order===t.order?g.localeIgnoreCaseComparer(e.id,t.id):e.order-t.order}renderNavigation(e,t,o){const s=t?b.css("hub-group",e.id===this.displayedHubGroupId&&"displayed"):b.css("hub",e.id===this.displayedHubId&&"displayed");let i=n.createElement("span",{className:"navigation-icon font-size-m flex-row flex-center flex-noshrink justify-center"},n.createElement(E.ContributedIcon,{alt:e.name,contributionId:e.id,icon:e.icon,iconAsset:e.iconAsset,iconName:e.iconName||"ViewAll",iconSize:"medium",pageContext:this.context.pageContext}));return 1!==this.expanded.value&&!this.props.collapse||t&&1!==e.children.length||(i=n.createElement(x.Tooltip,{text:e.name},i)),i=n.createElement(u.FPSLink,{ariaLabel:e.name,className:b.css(s,"navigation-element navigation-link focus-treatment flex-row flex-grow flex-center scroll-hidden relative"),href:e.href,id:e.id+"-link",key:e.id,navigationId:t?e.children[0].id:e.id,telemetrySource:"vertical.hub"},i,n.createElement("span",{className:"navigation-text expanded-only text-ellipsis"},e.name)),t&&(e.children.length>1&&(o&&e.id===this.displayedHubGroupId||(i=n.createElement(a.ExpandableContainer,{className:"flex-row flex-noshrink",collapseDelay:90,expandKey:39,excludeFocusZone:!0,excludeTabStop:!0,expandableId:e.id,expandDelay:100,expandOnHover:!0,id:e.id+"-container",renderCallout:(t,o,s)=>n.createElement(r.ContextualMenu,{anchorElement:s,anchorOrigin:{horizontal:"end",vertical:"start"},menuProps:this.getMenuProps(e),menuOrigin:{horizontal:"start",vertical:"start"},onDismiss:t.collapse}),role:"menuitem"},i)),o&&(i=n.createElement(n.Fragment,null,i,this.hubs.map(e=>this.renderNavigation(e,!1,!1))))),i=n.createElement("div",{key:e.id,className:b.css("flex-column flex-noshrink relative",e.id===this.displayedHubGroupId&&"hub-group-container",(!o||e.children.length<=1)&&"hub-group-only")},i)),i}sortNavigationList(e){const t=[],n=[];for(const o of e)w.isNavigationItemBuiltinOrTrusted(o)?n.push(o):(0===o.order&&(o.order=100),t.push(o));return n.sort(this.navigationComparer),t.sort(this.navigationComparer),[...n,...t]}}class y extends o.VssComponent{constructor(e,t){super(e),this.collapseCallout=(()=>{this.isCollapsing.value=!0}),this.onAnimationEnd=(()=>{this.isCollapsing.value&&this.props.closeCallout()}),this.isCollapsing=new h.ObservableValue(!1);const n=t.pageContext.getService("IVssLayoutManager").getComponentsForRegion("footer");this.pageHasFooter=n&&n.length>0}render(){return n.createElement(d.Observer,{isCollapsing:this.isCollapsing},e=>n.createElement(f.Callout,{anchorElement:document.body,anchorPoint:{x:0,y:0},calloutOrigin:{horizontal:"start",vertical:"start"},className:b.css("navigation-callout scroll-hidden",this.pageHasFooter&&"pageHasFooter"),contentClassName:"flex-column",lightDismiss:!0,modal:!0,onDismiss:this.collapseCallout},n.createElement("div",{className:b.css("nav-animation-container flex-row flex-grow scroll-hidden",e.isCollapsing&&"collapsing"),onAnimationEnd:this.onAnimationEnd},n.createElement(I,{isCallout:!0,onToggleExpand:this.collapseCallout,collapse:this.props.collapse}))))}}t.ComponentsNavigationProjectNavigation.ProjectNavigationCallout=y;class k extends n.Component{constructor(){super(...arguments),this.showPanel=new h.ObservableValue(!1),this.togglePanel=(()=>{this.showPanel.value=!this.showPanel.value})}render(){return n.createElement(d.Observer,{showPanel:this.showPanel,size:this.context.size},e=>0!==e.size&&n.createElement("div",{className:"navigation-container flex-column"},e.showPanel?n.createElement(n.Fragment,null,n.createElement("div",{className:"project-navigation region-navigation placeholder flex-column flex-grow flex-noshrink",role:"presentation"}),n.createElement(y,{collapse:!1,closeCallout:this.togglePanel})):n.createElement(I,{onToggleExpand:e.size<2?this.togglePanel:void 0,collapse:e.size<2||void 0})))}}k.contextType=p.ScreenContext,o.VssComponent.register("ms.vss-tfs-web.frame.project-navigation",k)}(),function(e){t.ComponentsNavigationNavigationHeaderButton={},Object.defineProperty(t,"__esModule",{value:!0});class s extends n.Component{constructor(e){super(e),this.renderCallout=(e=>n.createElement(A.ProjectNavigationCallout,{collapse:!1,closeCallout:e.collapse}))}render(){return n.createElement(d.Observer,{size:this.context.size},e=>e.size<1&&n.createElement(a.ExpandableContainer,{className:"navigation-header-button commandbar-item commandbar-icon flex-noshrink justify-center cursor-pointer",renderCallout:this.renderCallout,tabIndex:0,expandKey:[13,32]},n.createElement(i.Icon,{iconName:"GlobalNavButton",size:"medium"})))}}s.contextType=p.ScreenContext,o.VssComponent.register("ms.vss-tfs-web.frame.navigation-header-button",s)}(),function(e){t.ComponentsNavigationTopLevelNavigation={},Object.defineProperty(t,"__esModule",{value:!0});o.Components.add("ms.vss-tfs-web.frame.top-level-navigation",class extends o.VssComponent{constructor(e,t){super(e,t),this.showMoreLink=!0,this.renderListItem=(e=>{const t="host-"+e.id;return n.createElement(y.Link,{className:b.css("host-link navigation-link focus-treatment flex-row flex-center flex-noshrink relative",e.id===this.state.displayedHostId&&"displayed"),id:t,key:t,href:e.url,role:"listitem"},n.createElement(N.ProjectPersona,{displayName:e.name,size:"small"}),n.createElement("span",{className:"text-ellipsis"},e.name))}),this.updateCollectionList=(e=>{const t=c.getServiceLocation(this.context.pageContext,void 0,1),n=e.map((e,n)=>({id:e.id,name:e.name,url:I.combineUrlPaths(t,encodeURIComponent(e.name))}));n.sort((e,t)=>e.id===this.state.displayedHostId?-1:t.id===this.state.displayedHostId?1:g.localeIgnoreCaseComparer(e.name,t.name)),this.state.collections.push(...n)}),this.updateEnterpriseData=(e=>{this.state.enterpriseData.value=e}),this.updateNewOrgUrl=(e=>{if(e){const t=new I.Uri(e);t.addQueryParam("campaign","o~msft~vsts~orghome",!0),this.state.newOrgLink.value=t.absoluteUri}}),this.onKeyDown=(e=>{13!==e.keyCode&&32!==e.keyCode||this.showAllHostsClicked()}),this.showAllHostsClicked=(()=>{this.showMoreLink=!1,this.updateOrganizationList()}),this.updateOrganizationList=(()=>{let e=this.allOrganizations;if(this.mruOrganizations){const t=[];let n=!1;e=[];for(const o of[...this.mruOrganizations,...this.allOrganizations])if(t.indexOf(o.id)<0&&(t.push(o.id),o.id===this.state.displayedHostId?(e.unshift(o),n=!0):e.push(o),n&&this.showMoreLink&&e.length>=4))break}const t=this.showMoreLink&&e.length>4?e.slice(0,4):e;this.state.organizations.splice(0,this.state.organizations.length,...t)});const o=t.pageContext.getService("IVssContributionService"),s=t.pageContext.getService("IVssPageService").getData();let a;if(!s.isHosted&&t.pageContext.getService("IVssSecurityService").hasPermission("1f4179b3-6bac-4d01-b421-71ea09171400","FrameworkGlobalSecurity",2)){const e=c.getServiceLocation(t.pageContext,void 0,1);a=c.routeUrl(t.pageContext,"ms.vss-admin-web.admin-access-levels-route",{},e)}if(this.state={accessLevelsLink:a,collections:new h.ObservableArray([]),displayedHostId:s.hostId,enterpriseData:new h.ObservableValue(void 0),isHosted:s.isHosted,newOrgLink:new h.ObservableValue(void 0),organizations:new h.ObservableArray([]),settingsLink:c.routeUrl(t.pageContext,"ms.vss-admin-web.collection-admin-hub-route")},this.state.isHosted)this.trackPromise(Promise.all([k.getMostRecentlyAccessedUserOrganizations(t.pageContext),k.getUserOrganizations(t.pageContext)])).promise.then(e=>{this.mruOrganizations=e[0],this.allOrganizations=e[1],this.updateOrganizationList()}),this.trackPromise(k.getNewOrganizationUrl(t.pageContext)).promise.then(this.updateNewOrgUrl),this.trackPromise(o.getDataAsync("ms.vss-tfs-web.enterprise-navigation-data-provider")).promise.then(this.updateEnterpriseData);else{const e=t.pageContext.getRestClient("ICoreRestClient",{hostType:1});this.trackPromise(e.getProjectCollections(1e3)).promise.then(this.updateCollectionList)}}render(){return n.createElement("div",{className:"top-level-navigation region-navigation flex-column flex-noshrink scroll-hidden expanded",role:"navigation"},n.createElement(d.Observer,{enterpriseData:this.state.enterpriseData},e=>e.enterpriseData?n.createElement("div",{className:"flex-column flex-noshrink"},n.createElement(y.Link,{className:"enterprise-link navigation-link focus-treatment relative",href:e.enterpriseData.url},e.enterpriseData.name),n.createElement("div",{className:"enterprise-separator"})):null),n.createElement("div",{className:"top-level-section scroll-hidden flex-column flex-grow"},n.createElement("span",{className:"section-header"},this.state.isHosted?U.MyOrgs:U.Collections),n.createElement(d.Observer,{hosts:this.state.isHosted?this.state.organizations:this.state.collections},e=>e.hosts.length?n.createElement(n.Fragment,null,n.createElement(s.FocusZone,{direction:2,focusGroupProps:{defaultElementId:"host-"+e.hosts[0].id}},n.createElement("div",{className:b.css("flex-column v-scroll-auto h-scroll-hidden custom-scrollbar",(!this.state.isHosted||this.allOrganizations&&this.allOrganizations.length-e.hosts.length==0)&&"flex-grow"),role:"list"},e.hosts.map(this.renderListItem))),this.state.isHosted&&this.allOrganizations&&this.allOrganizations.length-e.hosts.length>0?n.createElement("div",{className:"show-more-container flex-grow"},n.createElement(y.Link,{onClick:this.showAllHostsClicked},this.allOrganizations.length-e.hosts.length==1?U.OneMoreOrganization:g.format(U.MoreOrganizations,this.allOrganizations.length-e.hosts.length))):null):null)),n.createElement("div",{className:"announcements-section flex-column flex-noshrink"},n.createElement(o.WrappedComponent,{wrappedType:"globalAnnouncement",dependencies:["ms.vss-tfs-web.suite-me-page-content"]})),this.state.isHosted?null:n.createElement("div",{className:"related-pages-section flex-column flex-noshrink"},n.createElement("span",{className:"section-header"},U.RelatedPages),this.state.isHosted&&n.createElement("span",{className:"related-link"},n.createElement(y.Link,{className:"link-text",href:"https://docs.microsoft.com/en-us/azure/devops/release-notes/"},U.WhatsNew)),n.createElement("span",{className:"related-link"},n.createElement(y.Link,{className:"link-text",href:"https://docs.microsoft.com/en-us/azure/devops/?view=azdevops"},U.Documentation)),n.createElement("span",{className:"related-link"},n.createElement(y.Link,{className:"link-text",href:"https://azure.microsoft.com/en-us/support/devops/"},U.GetHelp)),!this.state.isHosted&&this.state.accessLevelsLink&&n.createElement("span",{className:"related-link"},n.createElement(y.Link,{className:"link-text",href:this.state.accessLevelsLink},U.AccessLevels))),n.createElement("div",{className:"action-section flex-column flex-noshrink"},n.createElement(d.Observer,{newOrgUrl:this.state.newOrgLink},e=>this.state.isHosted&&e.newOrgUrl?n.createElement(y.Link,{className:"action-link navigation-link focus-treatment flex-row flex-center relative",href:e.newOrgUrl,id:"new-org-link"},n.createElement(i.Icon,{className:"icon-margin",iconName:"Add",size:"medium"}),U.NewOrg):null),n.createElement(u.FPSLink,{className:"action-link navigation-link focus-treatment flex-row flex-center relative",href:this.state.settingsLink,id:"settings-link"},n.createElement(i.Icon,{className:"icon-margin",iconName:"Settings",size:"medium"}),n.createElement("span",{className:"text-ellipsis"},this.state.isHosted?U.OrgSettings:U.CollectionSettings))))}})}(),function(e){t.ComponentsMyWorkMyWork={},Object.defineProperty(t,"__esModule",{value:!0});class s extends n.Component{constructor(){super(...arguments),this.renderDropdown=((e,t)=>n.createElement(o.WrappedComponent,{wrappedType:"customPanel",dependencies:["ms.vss-features.ui-layer-content","ms.vss-features.ui-hub-content"],contentClassName:"flyout-my-work",id:t,modal:!1,onDismiss:e.collapse},n.createElement(o.WrappedComponent,{dependencies:["ms.vss-features.ui-hub-content"],wrappedType:"vertical-header-my-work-flyout"})))}render(){return n.createElement(a.ExpandableContainer,{ariaLabel:U.MyWorkLabel,className:"commandbar-item commandbar-icon cursor-pointer flex-row flex-noshrink justify-center",expandableId:"my-work-panel",renderCallout:this.renderDropdown,role:"menuitem"},n.createElement(i.Icon,{iconName:"CheckList"}))}}t.ComponentsMyWorkMyWork.MyWork=s,o.VssComponent.register("ms.vss-tfs-web.my-work",s)}(),function(e){t.ComponentsProfileProfile={},Object.defineProperty(t,"__esModule",{value:!0});class s extends o.VssComponent{constructor(e,t){super(e,t),this.renderDropdown=((e,t,o)=>n.createElement(r.ContextualMenu,{onDismiss:e.collapse,anchorElement:o,anchorOrigin:{horizontal:"end",vertical:"end"},menuProps:{id:t,items:l.getMenuItems(this.context.pageContext,"ms.vss-tfs-web.profile-menu")},menuOrigin:{horizontal:"end",vertical:"start"}}));const o=t.pageContext.getService("IVssPageService").getData();o&&o.user&&(this.displayName=o.user.displayName,this.imageUrl=M.getIdentityImageUrl(t.pageContext,o.user,1))}render(){return n.createElement(a.ExpandableContainer,{className:"navigation-profile-menu commandbar-item commandbar-icon cursor-pointer flex-row flex-noshrink justify-center",expandableId:"profile-menu",role:"menuitem",renderCallout:this.renderDropdown},n.createElement(P.VssPersona,{imgAltText:U.ManageUserSettings,size:"small",suppressPersonaCard:!0,identityDetailsProvider:{getIdentityImageUrl:e=>this.imageUrl,getDisplayName:()=>this.displayName||""}}))}}t.ComponentsProfileProfile.Profile=s,o.VssComponent.register("ms.vss-tfs-web.profile",s)}(),function(e){t.ComponentsProfileServiceMeControlService={},Object.defineProperty(t,"__esModule",{value:!0});L.Services.add("IMeControlService",{serviceFactory:class extends L.VssService{constructor(){super(...arguments),this._showPreviewFeatures=(()=>{this.pageContext.getService("IVssContributionService").executeCommandEx("preview-feature",{methodName:"show",serviceName:"IFeaturePanel",dependencies:["ms.vss-tfs-web.feature-management-content"]})})}getConfigurations(e,t){return{apiGeneration:"GEN2",containerId:"me-control-container",currentAccount:e.currentAccount.isAnonymous?void 0:{type:!0===e.currentAccount.isMsa?"msa":"aad",memberName:e.currentAccount.email,displayName:e.currentAccount.name,orgName:e.currentAccount.aadTenantDisplayName,pictureUrl:t,authenticatedState:"signedIn",profile:{profileName:e.currentAccount.name,profilePictureUrl:t,editProfilePictureUrl:""}},authProviderConfig:{type:"webAadOnly",appSignInUrl:e.authProviderConfig.signInUrl,appSignInToUrl:e.authProviderConfig.signInToUrl,appSignOutUrl:e.currentAccount.isAnonymous?"":e.authProviderConfig.signOutUrl,appSwitchUrl:e.currentAccount.isAnonymous?"":e.authProviderConfig.switchUrl,appSwitchToUrl:e.currentAccount.isAnonymous?"":e.authProviderConfig.switchToUrl,aad:{signOutUrl:e.currentAccount.isAnonymous?"":e.aadIdpConfig.aadIdpSignOutUrl,signOutAndForgetUrl:e.currentAccount.isAnonymous?"":e.aadIdpConfig.aadIdpForgetUrl,signOutAndForgetMsaFedUrl:e.currentAccount.isAnonymous?"":e.aadIdpConfig.aadIdpSignOutAndForgetMsaFedUrl,forgetUrl:e.currentAccount.isAnonymous?"":e.aadIdpConfig.aadIdpForgetUrl,rememberedAccountsUrl:e.aadIdpConfig.aadIdpRememberedAccountsUrl}},primaryUXConfig:e.currentAccount.isAnonymous?"":{displayModes:[{type:"compressed",widthBreakpoint:5e3}]},appContextConfig:e.currentAccount.isAnonymous?"":{commands:[{text:U.AzureDevOpsProfile,id:"userSettingsLink",ariaLabel:U.AzureDevOpsProfile,openInNewTab:!1,url:e.profileUrl,type:"link"},{text:U.PreviewFeatures,id:"previewFeatureLink",ariaLabel:U.PreviewFeatures,openInNewTab:!1,type:"link",onClick:this._showPreviewFeatures}]}}}}})}(),H=t[j="ComponentsProfileUtilMeControlConstants"]={},Object.defineProperty(t,"__esModule",{value:!0}),(V=t[j].MeControlConstants||(t[j].MeControlConstants={})).LoadScriptScenario="LoadMeControlScriptScenario",V.Area="MeControl",V.LoadScriptFeature="LoadMeControlScript",V.LoadScriptFailAction="Load me control script failure",V.LoadComponentFeature="LoadMeControlComponent",V.LoadComponentFailAction="Load me control component failure",function(e){t.ComponentsProfileMeControl={},Object.defineProperty(t,"__esModule",{value:!0});const s="ms.vss-tfs-web.vertical-header-me-control-data-provider";class a extends o.VssComponent{constructor(e,t){super(e,t),this._onLoadMeControlScript=(()=>{const e=this.context.pageContext.getService("IVssContentService"),t=this.context.pageContext.getService("IVssPerformanceService"),n=this.context.pageContext.getService("IVssTelemetryService");if(this.state.data.meControlScriptUrl){const o={url:this.state.data.meControlScriptUrl,contentLength:16e3,clientId:"me-control-script",contributionId:"vertical-header-profile",contentType:"text/javascript"};t.startScenario(H.MeControlConstants.LoadScriptScenario,!1),e.loadScript(o).then(e=>{t.endScenario(H.MeControlConstants.Area,H.MeControlConstants.LoadScriptScenario,!1),this._loadMeControlComponent(n)},e=>{t.endScenario(H.MeControlConstants.Area,H.MeControlConstants.LoadScriptScenario,!1,void 0,{status:"failed"}),n.publishEvent(H.MeControlConstants.Area,H.MeControlConstants.LoadScriptFeature,{Action:H.MeControlConstants.LoadScriptFailAction,ErrorMessage:e.message})})}}),this._loadMeControlComponent=(e=>{window.MeControl.Loader.load(this.state.configDetails)||e.publishEvent(H.MeControlConstants.Area,H.MeControlConstants.LoadComponentFeature,{Action:H.MeControlConstants.LoadComponentFailAction})});const n=t.pageContext.getService("IVssPageService").getData(),o=this.context.pageContext.getService("IVssContributionService").getData(s);let a="";n&&n.user&&(a=M.getIdentityImageUrl(t.pageContext,n.user,2)+"&"+(new Date).getTime());const i=this.context.pageContext.getService("IMeControlService");this.state={data:o,configDetails:i.getConfigurations(o,a)}}render(){return n.createElement("div",{className:"me-control-div commandbar-item commandbar-icon flex-row flex-noshrink "+(this.state.data&&this.state.data.currentAccount.isAnonymous?"sign-in":"")},n.createElement("div",{id:"me-control-container"}))}componentDidMount(){super.componentDidMount(),this.state.data&&this._loadMeControlScriptAfterTTI()}componentWillUnmount(){super.componentWillUnmount(),this.context.pageContext.getService("IVssContributionEventService").unsubscribe(()=>{this._onLoadMeControlScript()},"page-interactive")}_loadMeControlScriptAfterTTI(){let e=this.setTimeout(()=>{this._onLoadMeControlScript(),this.clearTimeout(e)},500);this.context.pageContext.getService("IVssContributionEventService").subscribe(()=>{this._onLoadMeControlScript(),this.clearTimeout(e)},"page-interactive")}}t.ComponentsProfileMeControl.MeControl=a,o.VssComponent.register("ms.vss-tfs-web.me-control",a)}(),function(e){t.ComponentsSignInSignIn={},Object.defineProperty(t,"__esModule",{value:!0});class s extends o.VssComponent{constructor(e,t){super(e,t);const n=O.getHeaderActionData(t.pageContext)||{};this.state={signInUrl:n.signInUrl}}render(){return n.createElement(y.Link,{className:"sign-in-link commandbar-item",href:this.state.signInUrl},U.SignIn)}}t.ComponentsSignInSignIn.SignInLink=s,o.VssComponent.register("ms.vss-tfs-web.sign-in-link",s)}(),function(e){t.ComponentsUserMenuItemUserMenuItem={},Object.defineProperty(t,"__esModule",{value:!0});o.Components.add("userMenuItem",class extends o.VssComponent{constructor(e,t){super(e,t);const n=t.pageContext.getService("IVssPageService").getData();n&&n.user&&(this.userDisplayName=n.user.displayName,this.userUniqueName=n.user.uniqueName,this.userImageUrl=M.getIdentityImageUrl(t.pageContext,n.user,1))}render(){return n.createElement("tr",{"aria-posinset":this.props.details.position,"aria-setsize":this.props.details.setSize,className:"bolt-menuitem-row bolt-list-row user-menuitem-row",role:"presentation"},n.createElement("td",{className:"bolt-menuitem-cell bolt-list-cell"}),n.createElement("td",{className:"bolt-menuitem-cell bolt-list-cell",colSpan:5},n.createElement("div",{className:"flex-row flex-center"},n.createElement("img",{className:"user-menu-item-image",src:this.userImageUrl,alt:""}),n.createElement("div",{className:"user-menu-item-details"},n.createElement("div",null,this.userDisplayName),n.createElement("div",{className:"user-menu-item-unique-name"},this.userUniqueName)))),n.createElement("td",{className:"bolt-menuitem-cell bolt-list-cell"}))}})}()},["Resources","Components/Header/ProjectHeader","Components/Header/TopLevelHeader","Components/Help/Help","Components/Market/Market","Components/SuiteLogo/SuiteLogo","Components/Navigation/ProjectNavigation","Components/Navigation/NavigationHeaderButton","Components/Navigation/TopLevelNavigation","Components/MyWork/MyWork","Components/Profile/Profile","Components/Profile/Service/MeControlService","Components/Profile/Util/MeControlConstants","Components/Profile/MeControl","Components/SignIn/SignIn","Components/UserMenuItem/UserMenuItem"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-tfs-web.frame-content"}}));