"use strict";!function(e,t,n){function s(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)}function i(e){if("keypress"==e.type){var t=String.fromCharCode(e.which);return e.shiftKey||(t=t.toLowerCase()),t}return u[e.which]?u[e.which]:l[e.which]?l[e.which]:String.fromCharCode(e.which).toLowerCase()}function r(e){return"shift"==e||"ctrl"==e||"alt"==e||"meta"==e}function o(e,t){var n,s=[],i=e;for("+"===i?i=["+"]:i=(i=i.replace(/\+{2}/g,"+plus")).split("+"),n=0;n<i.length;++n){var o=i[n];h[o]&&(o=h[o]),t&&"keypress"!=t&&d[o]&&(o=d[o],s.push("shift")),r(o)&&s.push(o)}if(i=o,!(n=t)){if(!c)for(var a in c={},u)95<a&&112>a||u.hasOwnProperty(a)&&(c[u[a]]=a);n=c[i]?"keydown":"keypress"}return"keypress"==n&&s.length&&(n="keydown"),{key:o,modifiers:s,action:n}}function a(e){function n(e){e=e||{};var t,n=!1;for(t in m)e[t]?n=!0:m[t]=0;n||(S=!1)}function c(e,t,n,s,i,o){var a,c=[],u=n.type;if(!p._callbacks[e])return[];for("keyup"==u&&r(e)&&(t=[e]),a=0;a<p._callbacks[e].length;++a){var l,d=p._callbacks[e][a];if((s||!d.seq||m[d.seq]==d.level)&&u==d.action)(l="keypress"==u&&!n.metaKey&&!n.ctrlKey)||(l=d.modifiers,l=t.sort().join(",")===l.sort().join(",")),l&&(l=s&&d.seq==s&&d.level==o,(!s&&d.combo==i||l)&&p._callbacks[e].splice(a,1),c.push(d))}return c}function u(e,t,n,s){p.stopCallback(t,t.target||t.srcElement,n,s)||!1!==e(t,n)||(t.preventDefault?t.preventDefault():t.returnValue=!1,t.stopPropagation?t.stopPropagation():t.cancelBubble=!0)}function l(e){"number"!=typeof e.which&&(e.which=e.keyCode);var t=i(e);t&&("keyup"==e.type&&v===t?v=!1:p.handleKey(t,function(e){var t=[];return e.shiftKey&&t.push("shift"),e.altKey&&t.push("alt"),e.ctrlKey&&t.push("ctrl"),e.metaKey&&t.push("meta"),t}(e),e))}function d(e,t,s,r){function a(t){return function(){S=t,++m[e],clearTimeout(g),g=setTimeout(n,1e3)}}function c(t){u(s,t,e),"keyup"!==r&&(v=i(t)),setTimeout(n,10)}for(var l=m[e]=0;l<t.length;++l){var d=l+1===t.length?c:a(r||o(t[l+1]).action);h(t[l],d,r,e,l)}}function h(e,t,n,s,i){p._directMap[e+":"+n]=t;var r=(e=e.replace(/\s+/g," ")).split(" ");1<r.length?d(e,r,t,n):(n=o(e,n),p._callbacks[n.key]=p._callbacks[n.key]||[],c(n.key,n.modifiers,{type:n.action},s,e,i),p._callbacks[n.key][s?"unshift":"push"]({callback:t,modifiers:n.modifiers,action:n.action,seq:s,level:i,combo:e}))}var p=this;if(e=e||t,!(p instanceof a))return new a(e);p.target=e,p._callbacks={},p._directMap={};var g,m={},v=!1,f=!1,S=!1;p._handleKey=function(e,t,s){var i,o=c(e,t,s);t={};var a=0,l=!1;for(i=0;i<o.length;++i)o[i].seq&&(a=Math.max(a,o[i].level));for(i=0;i<o.length;++i)o[i].seq?o[i].level==a&&(l=!0,t[o[i].seq]=1,u(o[i].callback,s,o[i].combo,o[i].seq)):l||u(o[i].callback,s,o[i].combo);o="keypress"==s.type&&f,s.type!=S||r(e)||o||n(t),f=l&&"keydown"==s.type},p._bindMultiple=function(e,t,n){for(var s=0;s<e.length;++s)h(e[s],t,n)},s(e,"keypress",l),s(e,"keydown",l),s(e,"keyup",l)}if(e){var c,u={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},l={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},d={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},h={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"};for(n=1;20>n;++n)u[111+n]="f"+n;for(n=0;9>=n;++n)u[n+96]=n.toString();a.prototype.bind=function(e,t,n){return e=e instanceof Array?e:[e],this._bindMultiple.call(this,e,t,n),this},a.prototype.unbind=function(e,t){return this.bind.call(this,e,function(){},t)},a.prototype.trigger=function(e,t){return this._directMap[e+":"+t]&&this._directMap[e+":"+t]({},e),this},a.prototype.reset=function(){return this._callbacks={},this._directMap={},this},a.prototype.stopCallback=function(e,n){return!(-1<(" "+n.className+" ").indexOf(" mousetrap ")||function e(n,s){return null!==n&&n!==t&&(n===s||e(n.parentNode,s))}(n,this.target))&&("INPUT"==n.tagName||"SELECT"==n.tagName||"TEXTAREA"==n.tagName||n.isContentEditable)},a.prototype.handleKey=function(){return this._handleKey.apply(this,arguments)},a.addKeycodes=function(e){for(var t in e)e.hasOwnProperty(t)&&(u[t]=e[t]);c=null},a.init=function(){var e,n=a(t);for(e in n)"_"!==e.charAt(0)&&(a[e]=function(e){return function(){return n[e].apply(n,arguments)}}(e))},a.init(),e.Mousetrap=a,"undefined"!=typeof module&&module.exports&&(module.exports=a),"function"==typeof define&&define.amd&&define("mousetrap",function(){return a})}}("undefined"!=typeof window?window:null,"undefined"!=typeof window?document:null),define("VSS/Platform",["require","exports","VSS/Core/Observable","VSS/Core/Util/String","VSS/Core/Util/Theming","create-react-class","prop-types","react","react-dom","VSS/Core/EventManagement","VSS/Core/TimerManagement","VSS/Core/Util/Promise"],function(e,t,n,s,i,r,o,a,c,u,l,d){var h,p,g,m,v,f,S,b,y,C,_,I,P,w,E,T,R,D,x,N,V;h=t.Resources={},Object.defineProperty(t,"__esModule",{value:!0}),t.Resources.CdnFallbackErrorMessage="There was an error loading a required file. Would you like to reload the page to try to load again?",t.Resources.NetworkError="TF400893: Unable to contact the server. Please check your network connection and try again.",t.Resources.JustNow="Just now",t.Resources.AgoMinutes="{0}m ago",t.Resources.AgoHours="{0}h ago",t.Resources.Today="Today",t.Resources.Yesterday="Yesterday",t.Resources.DayAtTimeFormat="{0} at {1}",t.Resources.LessThanASecond="<1s",t.Resources.Seconds="{0}s",t.Resources.MinutesSeconds="{0}m {1}s",t.Resources.HoursMinutesSeconds="{0}h {1}m {2}s",t.Resources.DaysHoursMinutes="{0}d {1}h {2}m",t.Resources.Global="Global",function(e){p=t[e]={},Object.defineProperty(t,"__esModule",{value:!0});class s{_serviceStart(e){this.pageContext=e}_serviceEnd(e){}_serviceRestart(e){this.pageContext=e}}t[e].VssService=s;t[e].VssObservableService=class extends s{constructor(){super(...arguments),this.observable=new n.Observable}subscribe(e,t){this.observable.subscribe(e,t)}unsubscribe(e,t){this.observable.unsubscribe(e,t)}_notify(e,t,n){this.observable.notify(e,t,n)}},t[e].Services=new n.ObservableObject,t[e].RemoteSerializationSettingsKey="__remoteSerializationSettings",t[e].RestClients=new n.ObservableObject;function i(n,s){n[t[e].RemoteSerializationSettingsKey]=s}t[e].setRemoteSerializationSettings=i;new class{constructor(e,t){this.initializatonInProgress={},this.delayedServices=[],this.serviceInstances={},this.uniqueNumber=0,this.platformInitialized=new n.ObservableValue(!1),this.services=e,this.restClients=t,this.services.subscribe((e,t)=>{"add"===t&&e&&e.value&&e.value.options&&4==(4&e.value.options)&&(this.contentLoaded?this.getService(e.key):this.delayedServices.push(e.key))}),document.addEventListener("DOMContentLoaded",()=>{this.contentLoaded=!0;for(const e of this.delayedServices)this.getService(e);this.platformInitialized.value=!0,document.body.addEventListener("fpsLoading",e=>{this.platformInitialized.value=!1}),document.body.addEventListener("fpsCompleted",e=>{e.detail.success&&(this.platformInitialized.value=!0)}),document.body.addEventListener("fpsLoaded",e=>{const t={};this.contextUnloadInProgress=!0;for(const e in this.serviceInstances){const n=this.services.get(e);if(n&&n.options&&2==(2&n.options))t[e]=this.serviceInstances[e];else{const t=this.serviceInstances[e];if(t._serviceEnd)try{t._serviceEnd(this)}catch(e){console.error(e)}delete this.serviceInstances[e]}}this.contextUnloadInProgress=!1;for(const e in t){const n=t[e];n&&n._serviceRestart&&n._serviceRestart(this)}for(const e of this.services.keys()){const t=this.services.get(e);t&&t.options&&4==(4&t.options)&&(this.serviceInstances[e]||this._loadService(e,t))}})})}getService(e,t,n){if(this.contextUnloadInProgress)throw new Error("Services can't be requested while a shutdown is in progress");{let s=this.serviceInstances[e];if(!s){const i=this.services.get(e);if(i&&(!i.options||8!=(8&i.options)))if(t&&i.options&&1!=(1&i.options)){if(!n)throw new Error(`The ${e} service is not marked as remotable.`)}else s=this._loadService(e,i);if(!s&&!n)throw new Error(`No service has been registered with the name "${e}".`)}return s}}getRestClient(e,t){const n=this.restClients.get(e);if(!n)throw new Error(`No REST client has been registered with the name "${e}".`);const s=this.getService("IRestClientOptionsProviderService").populateRestClientOptions(n.options,t);return new n.factory(s)}getUniqueNumber(){return++this.uniqueNumber}_loadService(e,t){let n;if(this.initializatonInProgress[e])throw new Error("Unable to initialize service due to cyclic dependency: "+e);try{this.initializatonInProgress[e]=!0,n=new t.serviceFactory,t.options&&1==(1&t.options)&&i(n,{proxyFunctions:!0,ignoredProperties:{pageContext:!0}}),n._serviceStart&&n._serviceStart(this)}catch(t){throw delete this.initializatonInProgress[e],t}return this.serviceInstances[e]=n,delete this.initializatonInProgress[e],n}}(t[e].Services,t[e].RestClients)}("Context"),function(e){function n(e,t,n="/",s,i){const r=[`${e}=${t}`,`path=${n}`];s&&r.push(`expires=${s}`),i&&r.push(`max-age=${i}`),-1!==window.location.protocol.indexOf("https")&&r.push("secure"),document.cookie=r.join(";")}g=t.UtilCookie={},Object.defineProperty(t,"__esModule",{value:!0}),t.UtilCookie.getCookie=function(e){if(document.cookie&&document.cookie.length>0&&e){const t=e+"=",n=document.cookie.split(";");for(let e=0;e<n.length;e++){let s=n[e];for(;" "==s.charAt(0);)s=s.substring(1);if(0==s.indexOf(t))return decodeURIComponent(s.substring(t.length))}}return""},t.UtilCookie.setCookie=n,t.UtilCookie.deleteCookie=function(e,t="/"){n(e,"",t,"Thu, 01 Jan 1970 00:00:01 GMT")}}(),function(e){m=t.Fetch={},Object.defineProperty(t,"__esModule",{value:!0});let s=0;const i=new n.Observable;t.Fetch.requestListeners=i,t.Fetch.issueRequest=async function(e,t,n){const r=++s;let o=void 0;try{let s;if(i.notify({requestId:r,requestUrl:e,options:t,vssRequestOptions:n},"beforeRequest"),t||(t={}),t.headers){if(t.headers instanceof Headers)s=t.headers;else if(s=new Headers,"function"==typeof t.headers.hasOwnProperty)for(const e in t.headers)t.headers.hasOwnProperty(e)&&s.append(e,t.headers[e])}else s=new Headers;if(t.headers=s,s.append("X-VSS-ReauthenticationAction","Suppress"),n){const e=n.sessionId,t=n.command;e&&(t?s.append("X-TFS-Session",e+","+t):s.append("X-TFS-Session",e))}t.credentials="same-origin";const a=g.getCookie("AzDevRequestFaults");a&&s.append("AzDevRequestFaults",a);let c=!1;n&&n.authTokenProvider&&(s.append("Authorization",await n.authTokenProvider.getAuthorizationHeader(c)),s.append("X-TFS-FedAuthRedirect","Suppress"));try{o=await fetch(e,t)}catch(t){console.warn(`Unhandled exception in fetch for ${e}: ${t&&t.toString()}`);const n=new Error(h.NetworkError);throw n.name="NetworkException",n}if(401===o.status&&!c&&n&&n.authTokenProvider&&(c=!0),!o.ok){const e=new Error;if(e.name="TFS.WebApi.Exception",e.status=o.status,e.responseText=await o.text(),e.responseText&&""!==e.responseText)try{e.serverError=JSON.parse(e.responseText),e.serverError&&e.serverError.message&&(e.message=e.serverError.message)}catch(e){}throw e.message||(e.message=o.status+": "+o.statusText),e}}finally{i.notify({requestId:r,requestUrl:e,response:o,vssRequestOptions:n},"afterRequest")}return o}}(),function(e){v=t.UtilSerialization={},Object.defineProperty(t,"__esModule",{value:!0});const n=new RegExp('(^|[^\\\\])\\"\\\\/Date\\((-?[0-9]+)(?:[a-zA-Z]|(?:\\+|-)[0-9]{4})?\\)\\\\/\\"',"g");function s(e){let t=null;if(e){const s=e.replace(n,'$1{"__msjson_date__":$2 }');t=JSON.parse(s),s!==e&&function e(t,n,s){if(n&&"number"==typeof t.__msjson_date__)n[s]=new Date(t.__msjson_date__);else for(const n in t){const s=t[n];null!==s&&"object"==typeof s&&e(t[n],t,n)}}(t,null,"")}return t}function i(e,t,n){window.jsonIslandData||(window.jsonIslandData={}),window.jsonIslandData[e]=t,n&&(window[e]=t)}t.UtilSerialization.deserializeVssJsonObject=s,t.UtilSerialization.readJsonScript=function(e,t,n){if(window.jsonIslandData&&window.jsonIslandData[e])return window.jsonIslandData[e];const r=document.getElementById(e);let o=null;if(r){const e=r.textContent;e&&(o=s(e)),n&&r.parentElement&&r.parentElement.removeChild(r)}return i(e,o,t),o},t.UtilSerialization.updateJsonScriptValue=i}(),function(e){f=t.UtilUrl={},Object.defineProperty(t,"__esModule",{value:!0});class n{get absoluteUri(){let e="";if(this.scheme&&(e=encodeURI(decodeURI(this.scheme))+":",this.noSchemeSeparator||(e+="//")),this.host&&(e+=encodeURI(decodeURI(this.host)),this.port&&(e+=":"+this.port),this.noSchemeSeparator&&!this.path||(e+="/")),this.path){let t;if(this.noSchemeSeparator)t=encodeURI(decodeURI(this.path));else{t=this.path.split("/").map(e=>encodeURIComponent(decodeURIComponent(e))).join("/")}this.host?e=i(e,t):e+=t}const t=this.queryString;return t&&(e+="?"+t),this.hashString&&(e+="#"+encodeURI(this.hashString)),e}set absoluteUri(e){this._setFromUriString(e||"")}get queryString(){return this._getParamsAsString(this.queryParameters)}set queryString(e){this.queryParameters=this._splitStringIntoParams(e)}constructor(e,t){e&&this._setFromUriString(e,t)}getEffectivePort(){return this.port?this.port:s.equals(this.scheme,"http",!0)?80:s.equals(this.scheme,"https",!0)?443:0}getQueryParam(e){let t;if(this.queryParameters){const n=this.queryParameters.filter(t=>s.equals(t.name,e,!0));n.length>0&&(t=n[0].value)}return t}addQueryParam(e,t,n){n&&this.removeQueryParam(e),this.queryParameters||(this.queryParameters=[]),this.queryParameters.push({name:e,value:t})}addQueryParams(e,t,n){for(const s in e){const i=e[s];if(null!=i){const e=(n||"")+s;i instanceof Date?this.addQueryParam(e,i.toJSON(),t):Array.isArray(i)?i.forEach(n=>this.addQueryParam(e,""+n,t)):"object"==typeof i?this.addQueryParams(i,t,e+"."):this.addQueryParam(e,""+i,t)}}}removeQueryParam(e){this.queryParameters&&(this.queryParameters=this.queryParameters.filter(t=>!s.equals(t.name,e,!0)))}_setFromUriString(e,t){let n=e;const s=this._singleSplit(n,"#");s?(n=s.part1,this.hashString=this._decodeUriComponent(s.part2)):this.hashString="";const i=this._singleSplit(n,"?");i?(n=i.part1,this.queryString=i.part2):this.queryParameters=[],this.scheme="",this.host="",this.port=0,this.path="",this.noSchemeSeparator=!1;const r=this._singleSplit(n,":");if(r)if(this.scheme=r.part1,"//"===(n=r.part2).substr(0,2)){n=n.substr(2);const e=this._singleSplit(n,"/");e?(n=e.part1,this.path=e.part2):this.path="";const t=this._singleSplit(n,":");t?(this.host=t.part1,this.port=parseInt(t.part2),isNaN(this.port)&&(this.host+=":",this.path=t.part2+"/"+this.path)):this.host=n}else this.noSchemeSeparator=!0,this.path=n;else this.path=n;if(t&&t.absoluteUriRequired&&!this.scheme)throw new Error(`The uri string "${e}" does not represent a valid absolute uri.`)}_singleSplit(e,t){const n=e.indexOf(t);return n>=0?{part1:e.substr(0,n),part2:e.substr(n+1)}:void 0}_decodeUriComponent(e){return e&&(e=e.replace(/\+/g,"%20"),e=decodeURIComponent(e)),e}_getParamsAsString(e){return e&&e.length?e.map(e=>null!==e.value?encodeURIComponent(e.name)+"="+encodeURIComponent(e.value):encodeURIComponent(e.name)).join("&"):""}_splitStringIntoParams(e){const t=[];return e.split("&").forEach(e=>{if(e){const n=this._singleSplit(e,"=");n?t.push({name:this._decodeUriComponent(n.part1),value:this._decodeUriComponent(n.part2)}):t.push({name:this._decodeUriComponent(e),value:null})}}),t}}function i(...e){const t=[];for(let n=0,s=e.length-1;n<=s;n++){let i=e[n];i&&("/"!==i||0!==n&&n!==s?(n>0&&"/"===i[0]&&(i=i.substr(1)),n<s&&"/"===i[i.length-1]&&(i=i.substr(0,i.length-1)),i&&t.push(i)):t.push(""))}return 1===t.length&&""===t[0]?"/":t.join("/")}function r(e){const t={segments:[]};let n=-1,s=-1,i="";for(let r=0,o=e.length;r<o;r++){const o=e.charCodeAt(r);if(n>=0){if(125===o){let s=e.substring(n,r),i=!1;42===s.charCodeAt(0)&&(s=s.substr(1),i=!0),t.segments.push({paramName:s,isWildCardParam:i}),n=-1}}else if(123===o&&123!==e.charCodeAt(r+1)){if(i||s>=0){let n=i;s>=0&&(n+=e.substring(s,r)),n&&t.segments.push({text:n}),s=-1,i=""}n=r+1}else(123===o&&123===e.charCodeAt(r+1)||125===o&&125===e.charCodeAt(r+1))&&(i+=e.substring(s>=0?s:r,r+1),s=-1,r++),s<0&&(s=r)}if(s>=0||n>=0){const r=i+e.substring(s>=0?s:n);r&&t.segments.push({text:r})}let r=!1;for(let e=t.segments.length-1;e>=0;e--){const n=t.segments[e];n.text&&"/"!==n.text?r=!0:r&&n.paramName&&(n.isRequiredParam=!0)}return t}function o(e,t){let n;const s=Object.keys(t).length;for(const i of e){const e=a(i,t,!1);if(e&&(!n||e.matchedParametersCount>n.matchedParametersCount)&&(n=e,e.matchedParametersCount===s))return n}return n}function a(e,t,n){const s=[],i={};let r=0;for(let o=0,a=e.segments.length;o<a;o++){const a=e.segments[o];if(a.text){let e=a.text;n&&o>0&&"/"===e.charAt(0)&&0===s.length&&(e=e.substr(1)),e&&s.push(e)}else{const e=t[a.paramName];if(e||0===e)s.push(a.isWildCardParam?encodeURI(""+e):encodeURIComponent(""+e)),i[a.paramName]=!0,r++;else{if(!n){if(a.isRequiredParam)return;break}if(s.length){const e=s[s.length-1];"/"===e[e.length-1]&&(s[s.length-1]=e.substr(0,e.length-1))}}}}return{url:s.join(""),matchedParameters:i,matchedParametersCount:r}}t.UtilUrl.Uri=n,t.UtilUrl.combineUrlPaths=i,t.UtilUrl.parseRouteTemplate=r,t.UtilUrl.routeUrl=function(e,t){const s=o(e,t);if(!s)return"";const i=new n(s.url);for(const e in t)s.matchedParameters[e]||i.addQueryParam(e,t[e]);return i.absoluteUri},t.UtilUrl.getBestRouteMatch=o,t.UtilUrl.replaceParsedRouteValues=a,t.UtilUrl.replaceRouteValues=function(e,t){return a(r(e),t,!0).url},t.UtilUrl.isSameOrigin=function(e,t){const i=new n(e),r=new n(t);return s.equals(i.host,r.host,!0)&&i.getEffectivePort()===r.getEffectivePort()}}(),function(e){S=t.RestClientBase={},Object.defineProperty(t,"__esModule",{value:!0});t.RestClientBase.RestClientBase=class{constructor(e){this._options=e||{},"string"==typeof this._options.rootPath?this._rootPath=Promise.resolve(this._options.rootPath):this._rootPath=this._options.rootPath||Promise.resolve("/")}async getRootPath(){return this._rootPath}async beginRequest(e){return this._rootPath.then(t=>{let n=t+f.replaceRouteValues(e.routeTemplate,e.routeValues||{});if(e.queryParams){const t=new f.Uri(n);t.addQueryParams(e.queryParams),n=t.absoluteUri}return this._issueRequest(n,e.apiVersion,e)})}_issueRequest(e,t,n){const s={};s.method=n.method||"GET",s.mode="cors",!n.isRawData&&n.body&&"GET"!==s.method.toUpperCase()?s.body=JSON.stringify(n.body):s.body=n.body;const i=n.httpResponseType||"application/json",r=`${i};api-version=${t};excludeUrls=true;enumsAsNumbers=true;msDateFormat=true;noArrayWrap=true`;s.headers=Object.assign({Accept:r},n.body&&{"Content-Type":"application/json"},n.customHeaders);const o={authTokenProvider:this._options.authTokenProvider,sessionId:this._options.sessionId,command:n.command||this._options.command};return m.issueRequest(e,s,o).then(e=>n.returnRawResponse?e:i.toLowerCase().indexOf("json")>=0?e.text().then(v.deserializeVssJsonObject):"text/plain"===i.toLowerCase()?e.text():e.arrayBuffer())}}}(),function(e){t[e]={},Object.defineProperty(t,"__esModule",{value:!0});t[e].AuthenticationClientName="IAuthenticationRestClient",t[e].getAuthenticationClient=function(n,s){return n.getRestClient(t[e].AuthenticationClientName,s)},p.RestClients.add(t[e].AuthenticationClientName,{factory:class extends S.RestClientBase{constructor(e){super(e)}async createSessionToken(e){return this.beginRequest({apiVersion:"3.2-preview.1",method:"POST",routeTemplate:"_apis/WebPlatformAuth/SessionToken",body:e})}}})}("RestClientAuthentication"),function(e){function n(e){return"Bearer "+e}t.Authentication={},Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e,t,n=s.EmptyGuidString,i,r=0){if(this.pageContext=e,this.namedTokenId=t,this.tokenType=r,i){const e=i.indexOf(".");this.publisherName=i.substr(0,e),this.extensionName=i.substr(e+1)}else this.appId=n||s.EmptyGuidString}getAuthorizationHeader(e){return this.getSessionToken(e).then(e=>n(e.token))}getSessionToken(e){if(!e&&(this.tokenExpirationTime&&(new Date).getTime()>this.tokenExpirationTime.getTime()-6e4&&(delete this.tokenExpirationTime,delete this.tokenPromise),this.tokenPromise))return this.tokenPromise;const t={appId:this.appId,extensionName:this.extensionName,publisherName:this.publisherName,force:e,tokenType:this.tokenType,namedTokenId:this.namedTokenId},n=this.pageContext.getRestClient("IAuthenticationRestClient");return this.tokenPromise=n.createSessionToken(t).then(e=>(this.tokenExpirationTime=e.validTo,e)),this.tokenPromise}}t.Authentication.BearerTokenProvider=class{constructor(e){this.header=n(e)}getAuthorizationHeader(e){return Promise.resolve(this.header)}};p.Services.add("IAuthenticationService",{serviceFactory:class extends p.VssService{getDefaultTokenProvider(){return this._defaultProvider||(this._defaultProvider=new i(this.pageContext)),this._defaultProvider}getNamedTokenProvider(e){return this.getTokenProvider(e,void 0,0)}getExtensionTokenProvider(e,t){return this.getTokenProvider(void 0,e,t)}getBearerTokenProvider(e){return{getAuthorizationHeader:t=>Promise.resolve(n(e))}}getTokenProvider(e,t,n){const s=`${e}.${t}.${n}`;this._providers||(this._providers={});let r=this._providers[s];return r||(r=new i(this.pageContext,e,void 0,t,n),this._providers[s]=r),r}}})}(),function(e){t.Content={},Object.defineProperty(t,"__esModule",{value:!0});const s=new class{constructor(){this.pendingContent={},this.loadedContent={},this.contentLengthsByContributionId={},this.observable=new n.Observable,window.__contentLoaded=this.loadComplete.bind(this),window.__loadScript=this.loadScript.bind(this)}isContentAvailable(e){return!!this.loadedContent[this.getContentId(e)]}getContributionContentLengths(e){return this.contentLengthsByContributionId[e]}loadScript(e){let t;const n=this.getContentId(e);if(this.loadedContent[n])t=Promise.resolve(e);else if(this.pendingContent[n])t=this.pendingContent[n].loadPromise;else{const s=window.performance.now();t=new Promise((t,n)=>{let s;"text/javascript"===e.contentType?((s=document.createElement("script")).async=!1,s.src=e.url,e.integrity&&(s.integrity=e.integrity,s.crossOrigin="anonymous"),e.moduleNamespaces&&e.moduleNamespaces.length&&(window.__moduleNamespaces||(window.__moduleNamespaces=[]),window.__moduleNamespaces=window.__moduleNamespaces.concat(e.moduleNamespaces))):((s=document.createElement("link")).href=e.url,s.rel="stylesheet",s.crossOrigin="anonymous",e.integrity&&(s.integrity=e.integrity),s.setAttribute("crossorigin","anonymous")),s.setAttribute("data-contentlength",e.contentLength.toString()),e.clientId&&s.setAttribute("data-clientid",e.clientId),e.contributionId&&s.setAttribute("data-sourcecontribution",e.contributionId),s.addEventListener("load",e=>{t(this.loadComplete(e.target,!0))}),s.addEventListener("error",e=>{n(this.loadComplete(e.target,!1))}),document.head.appendChild(s)}),this.pendingContent[n]={startTime:s,loadPromise:t}}return t}subscribe(e){this.observable.subscribe(e)}getContentId(e){return e.clientId||e.url}loadComplete(e,t,n,s){const i={contentLength:parseInt(e.getAttribute("data-contentlength")),clientId:e.getAttribute("data-clientid"),contentType:"SCRIPT"===e.tagName.toUpperCase()?"text/javascript":"text/css",contributionId:e.getAttribute("data-sourcecontribution"),url:e instanceof HTMLScriptElement?e.src:e.href,integrity:e.getAttribute("integrity")},r=this.getContentId(i),o=this.pendingContent[r];delete this.pendingContent[r];const a={contentAttributes:i,contentElement:e,loadEnd:n=n||window.performance.now()};if(s&&(a.previousResourceLoadEnd=s),o&&(a.loadStart=o.startTime),t){if(this.loadedContent[r]=a,i.contributionId){let e=this.contentLengthsByContributionId[i.contributionId];e||(this.contentLengthsByContributionId[i.contributionId]=e={}),e[i.contentType]=(e[i.contentType]||0)+i.contentLength}this.observable.notify(a,"contentComplete",!0)}else this.observable.notify(a,"contentLoadError",!0);return i}};p.Services.add("IVssContentService",{serviceFactory:class extends p.VssObservableService{constructor(){super(...arguments),this.completedContributions={},this.scriptComplete=((e,t)=>{const n=e.contributionId,s=t[n];return s&&(t[n]=s-1,1===s&&(this.completedContributions[n]||(this._notify({contributionId:n},"contributionComplete",!0),this.completedContributions[n]=!0))),e})}_serviceStart(e){super._serviceStart(e),s.subscribe((e,t)=>{this._notify(e,t,!0)});const t=document.querySelectorAll("[data-sourcecontribution]");for(let e=0;e<t.length;e++){const n=t[e].getAttribute("data-sourcecontribution");this.completedContributions[n]||(this._notify({contributionId:n},"contributionComplete",!0),this.completedContributions[n]=!0)}}isLoaded(e){return!!this.completedContributions[e]}loadScript(e){return s.loadScript(e)}loadScripts(e){const t=[],n={};for(const i of e){if(!s.isContentAvailable(i)){const e=i.contributionId;e&&(n[e]?n[e]=n[e]+1:n[e]=1)}t.push(this.loadScript(i).then(e=>this.scriptComplete(e,n),e=>this.scriptComplete(e,n)))}return Promise.all(t)}getContributionContentLengths(e){return s.getContributionContentLengths(e)}},options:6})}(),function(e){t[e]={},Object.defineProperty(t,"__esModule",{value:!0});t[e].WebContributionsClientName="IWebContributionsRestClient",t[e].getWebContributionsClient=function(n,s){return n.getRestClient(t[e].WebContributionsClientName,s)},p.RestClients.add(t[e].WebContributionsClientName,{factory:class extends S.RestClientBase{constructor(e){super(e)}async queryContributedHierarchy(e,t,n){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"_apis/Contribution/HierarchyQuery/{scopeName}/{scopeValue}",routeValues:{scopeName:t,scopeValue:n},body:e})}}})}("RestClientWebContributions"),function(e){function n(e,t,...n){const r=Array.isArray(t),o=1===e.arrayOptions,a=!1!==e.deepClone;for(const e of n)r&&Array.isArray(e)?(o||(t.length=0),t.push.apply(t,a?s(e):e)):i(t,e,a,o);return t}function s(e){const t=[];for(let n=0,r=e.length;n<r;n++){const r=e[n];"object"!=typeof r||null===r||r instanceof Date?t[n]=r:Array.isArray(r)?t[n]=s(r):t[n]=i({},r,!0,!1)}return t}function i(e,t,n,r){for(const o in t){const a=t[o],c=e[o];if("object"!=typeof c||null===c||c instanceof Date)!n||"object"!=typeof a||null===a||a instanceof Date?e[o]=a:Array.isArray(a)?e[o]=s(a):e[o]=i({},a,n,r);else{const t=Array.isArray(c);if(t&&Array.isArray(a))if(r){let t=a;n&&(t=s(a)),e[o]=[...c,...a]}else e[o]=n?s(a):a;else if("object"!=typeof a||null===a||a instanceof Date)e[o]=a;else{const s=t?[...c]:Object.assign({},c);e[o]=i(s,a,n,r)}}}return e}b=t.UtilObject={},Object.defineProperty(t,"__esModule",{value:!0}),t.UtilObject.deepMerge=function(e,...t){return n({deepClone:!0,arrayOptions:0},e,...t)},t.UtilObject.deepMergeWithOptions=n}(),function(e){t.Contribution={},Object.defineProperty(t,"__esModule",{value:!0});const n="::Attributes";p.Services.add("IVssContributionService",{serviceFactory:class extends p.VssObservableService{constructor(){super(...arguments),this.dataProviderExceptions={},this.clientProviders={},this.dataProviders={},this.sharedData={},this.pendingContributions={},this.loadedContentContributions={},this.onContributionLoaded=(e=>{this.loadedContentContributions[e.contributionId]=!0})}_serviceStart(e){super._serviceStart(e),this.contentService=this.pageContext.getService("IVssContentService"),this.contentService.subscribe(this.onContributionLoaded,"contributionComplete");const t=v.readJsonScript("dataProviders",!0);t&&(this._applyData(t.data,t.sharedData,t.exceptions,t.clientProviders,void 0),this.dataProviderScope||(this.dataProviderScope={name:t.scopeName,value:t.scopeValue})),this.contributionPageData=this.getData("ms.vss-web.page-data")}_serviceEnd(e){super._serviceEnd(e),this.contentService.unsubscribe(this.onContributionLoaded,"contributionComplete")}async executeCommand(e,...t){const n=await this.getContributionAsync(e);return n?this.executeCommandEx(e,n,t):Promise.resolve(null)}async executeCommandEx(e,t,...n){let s=null;if(t){const i=await this.getServiceEx(e,t);if(i){const e=i[t.methodName];e&&(s=e.apply(i,t.methodArguments||n))}}return s}getContribution(e){let t=void 0;const n=this.getContributionData();return n&&n.contributions&&(t=n.contributions[e]),t}async getContributionAsync(e,t,n){return this.getContributionsAsync([e],t,n).then(e=>e[0])}async getContributionsAsync(e,t,n){return this.getContributionsAsyncInternal(e,t,n)}getContributionChildren(e,t){let n=[];const s=this.getContributionData();if(s&&s.relationships){let i={};if(s.relationships[e]){const t=s.relationships[e];t.children&&(i=t.children)}for(const t in s.relationships){const n=s.relationships[t];n&&n.parents&&n.parents[e]&&(i[t]=!0)}if(t){const e=this.getContributionIdsByType(t);if(!e||0===e.length)return n;for(const t of e)i[t]&&n.push(t)}else n=Object.keys(i)}return n}getContributionIdsByType(e){let t=[];const n=this.getContributionData();if(n&&n.types&&n.types[e]){const s=n.types[e];s&&(t=Object.keys(s))}return t}getContributionsByType(e){const t=this.getContributionIdsByType(e),n={},s=this.getContributionData();if(s)for(const e of t)n[e]=s.contributions[e];return n}getContributionProvider(e){let t;const n=this.getContributionData();if(n&&n.providers){const s=e.split("."),i=s[0]+"."+s[1];(t=n.providers[i])&&(t.id=i)}return t}getData(e,t){let n=void 0;const s=this._getParametersKey(t),i=this.dataProviders[e];return i&&(n=i[s]),n}async getDataAsync(e,t,n,s){let i=n?void 0:this.getData(e,t);if(!i){let n;for(const t in this.clientProviders)if(-1!==this.clientProviders[t].contributionIds.indexOf(e)){const e=this.clientProviders[t];s=s||e.queryServiceInstanceType,n=e.context.properties;break}const r=Object.assign({},n,t);await this.getContributionsAsyncInternal([e],r,!0,s),i=this.getData(e,r)}return Promise.resolve(i)}getSharedData(e){return this.sharedData[e]}getServiceSync(e,t){const n=this.getContribution(e);if(n)return n.dependencies&&n.dependencies.forEach(e=>{this.getContribution(e)||this.loadedContentContributions[e]}),this.pageContext.getService(n.serviceName,t,!0)}getService(e,t){return this.getContributionAsync(e).then(n=>n?this.getServiceEx(e,n,t):Promise.reject(void 0))}getServiceEx(e,t,n){let s;return(s=t.dependencies&&t.dependencies.length?this.getContributionsAsync(t.dependencies):Promise.resolve()).then(()=>{const s=this.pageContext.getService(t.serviceName,n,!0);return s||this.getContributionAsync("ms.vss-web.remote-service-providers").then(n=>this.getChildServices("ms.vss-web.remote-service-providers","ms.vss-web.service").then(n=>n.length?n[0].service.getService(e,t):void 0))})}getChildServices(e,t){const n=this.getChildServicesEx(e,t);return Promise.all(n.map(e=>e.service)).then(e=>{const t=[];for(let s=0,i=n.length;s<i;s++)e[s]&&t.push({id:n[s].id,service:e[s]});return t})}getChildServicesEx(e,t){const n=[],s=this.getContributionChildren(e,t);for(const e of s)n.push({id:e,service:this.getService(e)});return n}getDataProviderExceptions(){return this.dataProviderExceptions}isContributionResolved(e){let t=!1;if(this.contributionPageData){const n=this.getContributionData();if(n&&n.contributions){const s=this._getParametersKey();this.pendingContributions[e+"/"+s]||(t=n.contributions.hasOwnProperty(e)||this.loadedContentContributions[e]||void 0!==this.getData(e))}}return t}isContributionTrusted(e){let t=!1;const s=this.getContribution(e);return s&&64&s[n]&&(t=!0),t}getContributionData(){return this.getSharedData("_contributions")}async getContributionsAsyncInternal(e,t,n,s){let i=this.getContributionData(),r=i&&i.contributions||{};const o=this._getParametersKey(t);if(this.contributionPageData){const a=new Set,c=[];for(const s of e){const e=this.pendingContributions[s+"/"+o];e?c.push(e):(n||!r.hasOwnProperty(s)&&!this.loadedContentContributions[s]&&void 0===this.getData(s,t))&&a.add(s)}if(a.size>0){const e=this.fetchContributionsAsync(Array.from(a),t,s);c.push(e);for(const t of a)this.pendingContributions[t+"/"+o]=e}c.length&&await Promise.all(c),r=(i=this.getContributionData())&&i.contributions||{};for(const e of a)delete this.pendingContributions[e+"/"+o],i&&!i.contributions.hasOwnProperty(e)&&(i.contributions[e]=void 0)}const a=[];for(const t of e){const e=r[t];a.push(e)}return a}async fetchContributionsAsync(e,t,n){const s=Object.assign({},t);this._notify({contributionIds:e,properties:s},"dpqStarting");const i=this.pageContext.getRestClient("IWebContributionsRestClient",{serviceInstanceType:n}),r=await i.queryContributedHierarchy({contributionIds:e,dataProviderContext:{properties:s}},this.dataProviderScope.name,this.dataProviderScope.value);this._applyData(r.dataProviders,r.dataProviderSharedData,r.dataProviderExceptions,void 0,t),r.content&&await this.contentService.loadScripts(r.content),this._notify({dataProviders:r.dataProviders,dataProviderSharedData:r.dataProviderSharedData,dataProviderExceptions:r.dataProviderExceptions},"dpqCompleted")}_applyData(e,t,n,s,i){if(e){const t=this._getParametersKey(i);for(const n in e){let s=this.dataProviders[n];s||(this.dataProviders[n]=s={}),s[t]=e[n]}}if(t)for(const e in t){let n=t[e];const s=this.sharedData[e];s&&(n=b.deepMergeWithOptions({deepClone:!1},s,n)),this.sharedData[e]=n}if(s)for(const e in s)this.clientProviders[e]=s[e];if(n)for(const e in n){const t=n[e];this.dataProviderExceptions[e]=t,console.warn(`ContributionData unavailable for '${e}', ExceptionType: '${t.exceptionType}', Reason: ${t.message}, StackTrace: ${t.stackTrace}`)}}_getParametersKey(e){return e?JSON.stringify(e):"{}"}}});class s extends p.VssObservableService{constructor(){super(...arguments),this._lastSubscriptions={},this.onContributionDataLoaded=(()=>{this._lastSubscriptions=this.loadContributedSubscriptions(this._lastSubscriptions)})}_serviceStart(e){super._serviceStart(e),this._contributionService=this.pageContext.getService("IVssContributionService"),this._contributionService.subscribe(this.onContributionDataLoaded,"dpqCompleted"),this._lastSubscriptions=this.loadContributedSubscriptions({})}_serviceEnd(e){super._serviceEnd(e),this._contributionService.unsubscribe(this.onContributionDataLoaded,"dpqCompleted")}fireEvent(e,t,n){const s={name:e,data:t};this._notify(s,e,n)}loadContributedSubscriptions(e){const t=this.pageContext.getService("IVssContributionService"),n=this._contributionService.getContributionsByType("ms.vss-web.event-subscription");for(const s in n)if(!e[s]){const e=n[s];this.subscribe(n=>{e.command?t.executeCommandEx(s,e.command,n):e.commandId&&t.executeCommand(e.commandId,n)},e.eventName)}return n}}t.Contribution.VssContributedEventService=s,p.Services.add("IVssContributionEventService",{serviceFactory:s})}(),function(e){t.Page={},Object.defineProperty(t,"__esModule",{value:!0});p.Services.add("IVssPageService",{serviceFactory:class extends p.VssService{getData(){return this.pageContext.getService("IVssContributionService").getData("ms.vss-web.page-data")}}})}(),function(e){t[e]={},Object.defineProperty(t,"__esModule",{value:!0});t[e].CustomerIntelligenceClientName="ICustomerIntelligenceRestClient",t[e].getCustomerIntelligenceClient=function(n,s){return n.getRestClient(t[e].CustomerIntelligenceClientName,s)},p.RestClients.add(t[e].CustomerIntelligenceClientName,{factory:class extends S.RestClientBase{constructor(e){super(e)}async publishEvents(e){return this.beginRequest({apiVersion:"3.2-preview.1",method:"POST",routeTemplate:"_apis/customerintelligence/Events",body:e})}}})}("RestClientCustomerIntelligence"),function(e){function n(e,t){return e===t?0:e>t?1:-1}y=t.UtilArray={},Object.defineProperty(t,"__esModule",{value:!0}),t.UtilArray.groupBy=function(e,t){const n={};for(const s of e){const e=t(s)||"",i=n[e];i?i.push(s):n[e]=[s]}return n},t.UtilArray.toLookup=function(e,t){const n={};for(const s of e)n[t(s)]=s;return n},t.UtilArray.stableSort=function(e,t){const n=new Array(e.length);return function e(s,i,r){const o=r-i;if(o<2)return;const a=i+Math.floor(o/2);e(s,i,a),e(s,a,r),function(e,s,i,r){let o=s,a=i,c=0;for(;o<i&&a<r;)t(e[o],e[a])<=0?(n[c]=e[o],o++):(n[c]=e[a],a++),c++;for(;o<i;)n[c]=e[o],c++,o++;for(;a<r;)n[c]=e[a],c++,a++;for(o=0;o<r-s;o++)e[o+s]=n[o]}(s,i,a,r)}(e,0,e.length),e},t.UtilArray.uniqueSort=function(e,t=n){e.sort(t);for(let n=1,s=e.length;n<s;n++)0===t(e[n],e[n-1])&&(e.splice(n--,1),s--);return e},t.UtilArray.defaultComparer=n}(),function(e){function n(e,t=null){let n=null;try{n=localStorage.getItem(e)}catch(e){}return null===n?t:n}function s(e,t){try{return null==t?localStorage.removeItem(e):localStorage.setItem(e,t),!0}catch(e){return!1}}C=t.UtilStorage={},Object.defineProperty(t,"__esModule",{value:!0}),t.UtilStorage.tryGetLocalStorageValue=n,t.UtilStorage.tryGetLocalStorageObject=function(e,t){const s=n(e);if(!s)return t;try{return JSON.parse(s)}catch(e){return t}},t.UtilStorage.trySetLocalStorageValue=s,t.UtilStorage.trySetLocalStorageObject=function(e,t){return s(e,t?JSON.stringify(t):void 0)}}(),function(e){t.Telemetry={},Object.defineProperty(t,"__esModule",{value:!0});p.Services.add("IVssTelemetryService",{serviceFactory:class extends p.VssObservableService{constructor(){super(...arguments),this.events=[],this._onWindowUnload=(()=>{this.unloading=!0,this.events.length&&(this._writeEventsToLocalStorage(...this.events),this.events=[])})}_serviceStart(e){super._serviceStart(e),this._initializeService(),this.publishInterval=window.setInterval(this._sendEvents.bind(this),1e3),window.addEventListener("unload",this._onWindowUnload);const t=this._readEventsFromLocalStorage();t&&this.events.push(...t)}_serviceRestart(e){super._serviceRestart(e),this._sendEvents(),this._initializeService()}_serviceEnd(e){this.publishInterval&&(window.clearInterval(this.publishInterval),this.publishInterval=0),window.removeEventListener("unload",this._onWindowUnload),super._serviceEnd(e)}publishEvent(e,t,n,s){const i=Object.assign({},n);this.sessionId&&(i.SessionId=this.sessionId),i.EventTimestamp=(new Date).getTime(),e||(console.warn(`Publishing telemetry event with unknown area. Feature: ${t}. Properties: ${JSON.stringify(i)}`),e="Unknown"),t||(console.warn(`Publishing telemetry event with unknown feature. Area: ${e}. Properties: ${JSON.stringify(i)}`),t="Unknown");const r={area:e,feature:t,properties:i,serviceInstanceType:s};this._notify(r,"publish"),this.unloading?this._writeEventsToLocalStorage(r):this.events.push(r)}_initializeService(){const e=this.pageContext.getService("IVssPageService").getData();e&&(this.sessionId=e.sessionId,this.hostId=e.hostId)}_sendEvents(){const e=y.groupBy(this.events,e=>e.serviceInstanceType);this.events=[],Object.keys(e).forEach(t=>{try{const n=this.pageContext.getRestClient("ICustomerIntelligenceRestClient",{serviceInstanceType:t||void 0});e[t].forEach(e=>{delete e.serviceInstanceType}),n.publishEvents(e[t])}catch(e){console.error(e)}})}_readEventsFromLocalStorage(){let e;const t=`ciEvents/${this.hostId}`;return(e=C.tryGetLocalStorageObject(t))&&C.trySetLocalStorageObject(t,void 0),e}_writeEventsToLocalStorage(...e){let t=e;const n=this._readEventsFromLocalStorage();n&&(t=[...n,...t]),C.trySetLocalStorageObject(`ciEvents/${this.hostId}`,t)}},options:2})}(),function(e){_=t.Theming={},Object.defineProperty(t,"__esModule",{value:!0});const n="user-custom-theme";t.Theming.getCurrentTheme=function(e){return e.getService("IVssThemeService").getCurrentTheme()},p.Services.add("IVssThemeService",{serviceFactory:class extends p.VssObservableService{constructor(){super(...arguments),this.themeElementsBySelector={}}_serviceStart(e){super._serviceStart(e),this.createThemedSelector(":root",e=>e),this._initializeTheme()}_serviceRestart(e){super._serviceRestart(e),this._initializeTheme()}_serviceEnd(e){super._serviceEnd(e)}getThemeValue(e){return i.expandThemeableProperties(`var(--${e})`,this.currentTheme.data)}getCurrentTheme(){return this.currentTheme}getTheme(e){const t=this.pageContext.getService("IVssContributionService").getSharedData("_themes");return t&&t[e]}applyTheme(e){this.currentTheme=e,this._notify(e,"themeChanged")}saveCustomUserTheme(e){C.trySetLocalStorageObject(n,e)}createThemedSelector(e,t){const n="function"==typeof t?t:void 0;let s=this.themeElementsBySelector[e];if(s||((s=document.createElement("style")).type="text/css",document.head.appendChild(s),this.themeElementsBySelector[e]=s,n&&this.subscribe(t=>{const i=n(t),r=`${e} { ${this.getCSSVariablesContent(i&&i.data)} }`;s.innerText=r},"themeChanged")),this.currentTheme){const i=n?n(this.currentTheme):t,r=`${e} { ${this.getCSSVariablesContent(i&&i.data)} }`;s.innerText=r}}getCSSVariablesContent(e){const t=[];if(e)for(const n in e)t.push(`--${n}: ${e[n]}`);return t.join("; ")}_initializeTheme(){let e=void 0;if(!(e=C.tryGetLocalStorageObject(n))){const t=this.pageContext.getService("IVssContributionService").getData("ms.vss-web.theme-data");t&&t.requestedThemeId&&(e=this.getTheme(t.requestedThemeId))}this.currentTheme=e||{id:"empty-theme",name:"",data:{}},this.applyTheme(this.currentTheme)}},options:6})}(),function(e){t.Performance={},Object.defineProperty(t,"__esModule",{value:!0});const n=Math.random()<.02,i=new RegExp("//(.*?)/");function r(e){if(!e)return;const t=i.exec(e);return t?t[1]:void 0}class o{constructor(e,t,n,s,i,r,o){this.elaspsedTicks=0,this.endTime=-1,this.featureArea="",this.splitTimings=[],this.scenarioName=e,this.isPageInteractive=n,this.isPageNavigate=s,this.startTime=i,this.properties=Object.assign({},r),this.sessionId=t,this.onScenarioComplete=o,s||a.mark(u(e,c.Start))}complete(e){!this.isPageNavigate||e||document.hidden?this.completeNow(e):(this.splitTimings.push({name:"ScenarioEnd.PendingPaint",timestamp:Date.now()-this.startTime}),window.requestAnimationFrame(()=>{this.completeNow()}))}addProperties(e){this.properties=Object.assign({},this.properties,e)}completeNow(e){if(this.endTime=e||Date.now(),this.elaspsedTicks=this.endTime-this.startTime,this.onScenarioComplete(this),!e||this.isPageNavigate){const e=u(this.scenarioName,c.End);a.mark(e);const t=this.isPageNavigate?"navigationStart":u(this.scenarioName,c.Start);a.measure(this.scenarioName,t,e)}}}var a,c;function u(e,t){return`${e}-${t===c.Start?"start":"end"}`}p.Services.add("IVssPerformanceService",{serviceFactory:class extends p.VssObservableService{constructor(){super(...arguments),this.activeScenarios={},this.completedScenarios=[],this.pageNavigateScenario=!0,this.pageNavigateSplitTimings=[],this._completedContentCache=[],this.handleScenarioComplete=(e=>{e===this.activeScenarios[e.scenarioName]&&delete this.activeScenarios[e.scenarioName],this.completedScenarios.push(e),e.isPageNavigate&&this.pageNavigateSplitTimings.length&&(e.splitTimings.push(...this.pageNavigateSplitTimings),e.splitTimings.sort((e,t)=>e.timestamp-t.timestamp)),e.isPageInteractive&&(this.performanceData.timeToInteractive=e.endTime-e.startTime,this.performanceData.backgroundTab=document.hidden,this.setNewSessionId());const t=this.getScenarioTelemetry(e,e.properties.serviceInstanceType);t.properties.LWLS=!0,e.isPageInteractive&&(t.properties.isTTI=!0,t.properties.theme=_.getCurrentTheme(this.pageContext).id);const n=this.pageContext.getService("IVssTelemetryService");if(n.publishEvent(t.area,t.feature,t.properties,t.serviceInstanceType),e.isPageInteractive){const e=this._shouldCollectResourceTimings(),s=this.getTimingTelemetry(e);s&&n.publishEvent(s.area,s.feature,s.properties,t.serviceInstanceType),this._completedContentCache=[]}if(this._notify(e,"scenarioComplete"),e.isPageInteractive){const t=this.pageContext.getService("IVssContributionEventService");setTimeout(()=>{g.getCookie("TFS-BREAK-TTI"),t.fireEvent("page-interactive",e,!0)},0)}}),this._afterRequest=((e,t)=>{if(this.performanceData.contentData.ajaxCount++,e.response&&e.response.ok){const t=e.response.headers.get("content-length");t&&(this.performanceData.contentData.ajaxSize+=parseInt(t))}}),this._contentComplete=((e,t)=>{"text/css"===e.contentAttributes.contentType?(this.performanceData.contentData.cssCount++,this.performanceData.contentData.cssSize+=e.contentAttributes.contentLength):"text/javascript"===e.contentAttributes.contentType&&(this.performanceData.contentData.scriptsCount++,this.performanceData.contentData.scriptSize+=e.contentAttributes.contentLength),"contentComplete"!==t||this.performanceData.timeToInteractive||this._completedContentCache.push(e)}),this._legacyContentComplete=(e=>{e&&e.detail&&e.detail.size&&(e.detail.isCss?(this.performanceData.contentData.cssCount++,this.performanceData.contentData.cssSize+=e.detail.size):(this.performanceData.contentData.scriptsCount++,this.performanceData.contentData.scriptSize+=e.detail.size))}),this.fpsLoading=(e=>{this.pageNavigateScenario=!1,this.navigationStartTime=e.detail.startTime,window.lwpLastNavigationStartTime=this.navigationStartTime,document.body.dispatchEvent(new CustomEvent("lwpPerfNavigationReset",{cancelable:!1,detail:{}})),this.activeScenarios={},this.pageNavigateSplitTimings=[]}),this.legacyScenarioStarted=(e=>{const t=e.detail.descriptor;t&&this._startScenario(t.getName(),t.isPageInteractive(),this.pageNavigateScenario,t.getStartTime())}),this.legacyScenarioCompleted=(e=>{const t=e.detail.scenarioDetail;if(t){const e=t.scenario,n=t.telemetryData;e.isPageInteractive()?this.markTimeToInteractive(e.getFeatureArea(),e.getName(),void 0,e.getData(),e.getSplitTimings(),n):this.endScenario(e.getFeatureArea(),e.getName(),!1,e.getEndTime(),e.getData(),e.getSplitTimings(),n)}})}_serviceStart(e){super._serviceStart(e),this.resetPerformanceData(!0),this.navigationStartTime=window.performance.timing.navigationStart;const t=this.pageContext.getService("IVssContentService");t.subscribe(this._contentComplete,"contentComplete"),t.subscribe(this._contentComplete,"contentLoadError"),m.requestListeners.subscribe(this._afterRequest,"afterRequest"),document.addEventListener("scenarioStarted",this.legacyScenarioStarted),document.addEventListener("scenarioCompleted",this.legacyScenarioCompleted),document.addEventListener("legacyContentElementLoaded",this._legacyContentComplete),this.initializeService(),document.body.addEventListener("fpsLoading",this.fpsLoading)}_serviceRestart(e){super._serviceRestart(e),this.resetPerformanceData(!1),this.initializeService()}isFastPageSwitchScenario(){return!this.pageNavigateScenario}addSplitTiming(e,t){if(t){const n=this.activeScenarios[t];n&&n.splitTimings.push({name:e,timestamp:Date.now()-n.startTime})}else this.pageNavigateSplitTimings.push({name:e,timestamp:Date.now()-this.navigationStartTime})}getCompletedScenarios(){return this.completedScenarios}getActiveScenario(e){return this.activeScenarios[e]}getServerStatistics(){return this.serverStatistics}getPerformanceInsights(){return this.performanceInsights}getEntriesByName(e){return a.getEntriesByName(e)}getTimingByName(e){return a.getTimingByName(e)}getPerformanceData(){return this.performanceData}endScenario(e,t,n,s,i,r,o){let a=this.activeScenarios[t];return a?(n&&(a.isPageInteractive=!0),i&&a.addProperties(i)):a=this.startScenarioFromNavigation(t,n,i),e&&(a.featureArea=e),r&&a.splitTimings.push(...r),o&&(o.properties&&a.addProperties(o.properties),o.serviceInstanceType&&(a.properties.serviceInstanceType=o.serviceInstanceType)),a.complete(s),a}markTimeToInteractive(e,t,n,s,i,r){return this.endScenario(e,t,!0,n,s,i,r)}startScenario(e,t,n,s){return this._startScenario(e,t,!1,n||Date.now(),s)}startScenarioFromNavigation(e,t,n){return this._startScenario(e,t,this.pageNavigateScenario,this.navigationStartTime,n)}getDefaultNavigationEvents(e){const t=[];try{const e=[{name:"PLT",startEvent:"navigationStart",endEvent:"loadEventEnd",isAggregate:!0},{name:"Redirect",startEvent:"redirectStart",endEvent:"redirectEnd"},{name:"Unload",startEvent:"unloadEventStart",endEvent:"unloadEventEnd"},{name:"Fetch",startEvent:"fetchStart",endEvent:"domainLookupStart"},{name:"DNS",startEvent:"domainLookupStart",endEvent:"domainLookupEnd"},{name:"TCP",startEvent:"connectStart",endEvent:"connectEnd"},{name:"SSL",startEvent:"secureConnectionStart",endEvent:"connectEnd"},{name:"Request",startEvent:"connectEnd",endEvent:"responseStart"},{name:"Server Time",startEvent:"connectEnd",endEvent:"responseEnd",isAggregate:!0},{name:"Response",startEvent:"responseStart",endEvent:"responseEnd"},{name:"DOMInteractive",startEvent:"domInteractive",endEvent:"domComplete"},{name:"DOMProcessing",startEvent:"domLoading",endEvent:"domComplete"},{name:"onLoad",startEvent:"loadEventStart",endEvent:"loadEventEnd"},{name:"Network Time",startEvent:"domainLookupStart",endEvent:"connectEnd"},{name:"PreRequest",startEvent:"navigationStart",endEvent:"connectEnd",isAggregate:!0},{name:"RequestResponse",startEvent:"connectEnd",endEvent:"responseEnd",isAggregate:!0}];for(const n of e){let e=a.getEntriesByName(n.name);if(0===e.length){if(null==a.getTimingByName(n.startEvent)&&0===a.getEntriesByName(n.startEvent).length||null==a.getTimingByName(n.endEvent)&&0===a.getEntriesByName(n.endEvent).length)continue;a.measure(n.name,n.startEvent,n.endEvent),e=a.getEntriesByName(n.name)}const s=e.map(e=>({name:e.name,startTime:e.startTime,duration:e.duration}))[0];n.perfEntry=s,t.push(n)}}catch(e){}if(e){let n=0;e.endTime&&(n=e.startTime-e.endTime);const s={name:"TTI",perfEntry:{name:"TTI",duration:n,startTime:0},startEvent:"navigationStart",endEvent:e.scenarioName,isAggregate:!0};s&&t.push(s)}return t}getResourceTimingEntries(){return a.getEntriesByType("resource")||[]}getTimingTelemetry(e){const t=this._getContentTelemetryProperties(e);if(!t)return null;const n={area:"Performance",feature:"ResourceTiming",properties:t};if(n.properties.individualTimings){let e=JSON.stringify(n,null,2);const t=3e4,s=450;for(;e.length>t;){const i=e.length-t,r=Math.ceil(i/s),o=Object.keys(n.properties.individualTimings);if(o.length<=10)return null;const a=o.slice(Math.max(20,o.length-r));for(const e of a)delete n.properties.individualTimings[e];e=JSON.stringify(n,null,2)}}return n}getScenarioTelemetry(e,t){let n={activityId:e.sessionId,backgroundTab:document.hidden,debugMode:this.isDebugMode,elapsedTime:e.endTime-e.startTime,featureArea:e.featureArea||"",name:e.scenarioName,pageId:this.pageId,pageNavigateScenario:e.isPageNavigate,serviceVersion:this.serviceVersion,splitTimings:e.splitTimings,startTime:e.startTime,timeZoneOffset:(new Date).getTimezoneOffset()};if(n=Object.assign({},e.properties,n),e.isPageInteractive)try{const e=this._getPageInteractiveTelemetryProperties(n.pageNavigateScenario);Object.assign(n,e)}catch(e){}return{area:"Performance",feature:"Scenario",elapsedTime:e.endTime-e.startTime,properties:n,serviceInstanceType:t}}_startScenario(e,t,n,s,i){const r=new o(e,this.sessionId,t,n,s,i,this.handleScenarioComplete);return this.activeScenarios[e]=r,r}initializeService(){const e=this.pageContext.getService("IVssPageService").getData();e&&(this.isDebugMode=e.isDebugMode,this.sessionId=e.sessionId,this.pageId=e.sessionId,this.serviceVersion=e.serviceVersion);const t=v.readJsonScript("serverStatistics",!0);if(this.serverStatistics=t?t.serverTimings:null,this.performanceInsights=t?t.insights:void 0,this.serverStatistics)for(const e in this.serverStatistics){const t=this.serverStatistics[e];switch(e){case"AAD":case"ServiceBus":this.performanceData.serverPerformanceData.totalRemote+=t.count;break;case"BlobStorage":case"TableStorage":this.performanceData.serverPerformanceData.storage+=t.count,this.performanceData.serverPerformanceData.totalRemote+=t.count;break;case"Redis":this.performanceData.serverPerformanceData.redis+=t.count,this.performanceData.serverPerformanceData.totalRemote+=t.count;break;case"SQL":this.performanceData.serverPerformanceData.sql+=t.count,this.performanceData.serverPerformanceData.totalRemote+=t.count;break;case"VssClient":this.performanceData.serverPerformanceData.rest+=t.count,this.performanceData.serverPerformanceData.totalRemote+=t.count}}}setNewSessionId(){this.sessionId=s.newGuid()}_getPageInteractiveTelemetryProperties(e){const t={},n={resourceCount:this.performanceData.contentData.cssCount+this.performanceData.contentData.scriptsCount,scriptResourceCount:this.performanceData.contentData.scriptsCount,cssResourceCount:this.performanceData.contentData.cssCount,ajaxRequests:this.performanceData.contentData.ajaxCount,scriptSize:this.performanceData.contentData.scriptSize,cssSize:this.performanceData.contentData.cssSize};if(e){const e=this.getDefaultNavigationEvents();for(let n=0;n<e.length;n++){const s=e[n].perfEntry;s&&(t[s.name]={start:s.startTime,duration:s.duration})}n.navigation=t;const s=window.resourceLoadStrategy;s&&(n.resourceLoadStrategy=s)}try{n.screen={h:window.screen.height,w:window.screen.width,winH:window.innerHeight,winW:window.innerWidth,winOH:window.outerHeight,winOW:window.outerWidth};const e=window.navigator;e&&e.connection&&(n.connection={rtt:e.connection.rtt,type:e.connection.effectiveType,downlink:e.connection.downlink})}catch(e){}return n}resetPerformanceData(e){this.performanceData={timeToInteractive:0,backgroundTab:!1,contentData:{ajaxCount:0,ajaxSize:0,cssCount:0,cssSize:0,other:"",scriptsCount:0,scriptSize:0},serverPerformanceData:{redis:0,rest:0,sql:0,storage:0,totalRemote:0},initialPageLoad:e}}_shouldCollectResourceTimings(){const e=this.pageContext.getService("IVssPageService").getData(),t=window.location.href.indexOf("collectResourceTimings=true")>=0||document.cookie.indexOf("TFS-COLLECT-TIMING=true")>=0,s=this.performanceData.timeToInteractive>8e3;if(e){if(e.isBundlingEnabled&&!e.isDebugMode&&e.isCdnEnabled){if(n)return 1;if(s)return 2}if(t)return 3}return 0}_getContentTelemetryProperties(e){const t={cdnResourceCount:0,diskcachedResourceCount:0,memcachedResourceCount:0,resourceCount:0,skippedResources:0,totalDuration:0,totalTransferSize:0},n={aggregate:t,reason:e};if(0!==e&&(n.individualTimings={}),0===this._completedContentCache.length)return null;try{const e={},s=this.getResourceTimingEntries();for(const t of s)e[t.name]=t;for(const s of this._completedContentCache){if(!s.contentAttributes.clientId)continue;const i=s.contentElement instanceof HTMLLinkElement?s.contentElement.href:s.contentElement.src,o=e[i],a=r(i);let c,u,l;if(o&&(l=o.transferSize,u=Math.round(o.duration),c=this._extrapolateResourceLoadSource(o),a&&(t.resourceCount++,t.totalTransferSize+=l,t.cdnResourceCount+=a.indexOf("cdn")>=0?1:0,t.diskcachedResourceCount+=2===c?1:0,t.memcachedResourceCount+=1===c?1:0,t.totalDuration+=u,s.previousResourceLoadEnd?t.resourceStartTime=Math.min(t.resourceStartTime||s.previousResourceLoadEnd,s.previousResourceLoadEnd):s.loadStart&&(t.resourceStartTime=Math.min(t.resourceStartTime||s.loadStart,s.loadStart)),s.loadEnd&&(t.resourceEndTime=Math.max(t.resourceEndTime||s.loadEnd,s.loadEnd)))),n.individualTimings){const e={contentType:s.contentAttributes.contentType,contributionId:s.contentAttributes.contributionId,domain:a,loadStart:s.loadStart,loadEnd:s.loadEnd,previousResourceLoadEnd:s.previousResourceLoadEnd};o&&(Object.assign(e,{decodedBodySize:o.decodedBodySize,encodedBodySize:o.encodedBodySize,source:c,totalDuration:u,transferSize:l}),o.requestStart&&(e.requestStart=o.requestStart),o.responseStart&&(e.responseStart=o.responseStart),o.responseEnd&&(e.responseEnd=o.responseEnd)),n.individualTimings[s.contentAttributes.clientId]=e}}}catch(e){console.warn("Error while collecting telemetry data: "+e&&e.message||e.toString())}return n}_extrapolateResourceLoadSource(e){const t=e.responseStart-e.requestStart;return e.responseEnd-e.requestStart<10?1:t<60?2:3}},options:6}),function(e){function t(e){return function(e){const t=window.performance&&window.performance.timing&&window.performance.timing[e]||null;return null!=t}(e)||s(e).length>0}function n(e){return window.performance&&window.performance.getEntriesByType&&window.performance.getEntriesByType(e)||[]}function s(e){return window.performance&&window.performance.getEntriesByType&&window.performance.getEntriesByName(e)||[]}e.mark=function(e){window.performance&&window.performance.mark&&window.performance.mark(e),console&&console.timeStamp&&console.timeStamp(e)},e.measure=function(e,n,s){if(window.performance&&window.performance.measure){if(!t(n)||!t(s))return;window.performance.measure(e,n,s)}},e.getEntriesByType=n,e.getEntriesByName=s,e.getMeasures=function(e){return n("measure")},e.getMarks=function(){return n("mark")},e.getTimingByName=function(e){return window.performance&&window.performance.timing&&window.performance.timing[e]||null}}(a=t.Performance.Timing||(t.Performance.Timing={})),function(e){e[e.Start=0]="Start",e[e.End=1]="End"}(c||(c={}))}(),function(e){function s(...e){return e.filter(e=>e).join(" ").trim()}I=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),a.PropTypes=o,a.createClass=r,t[e].css=s,t[e].Components=new n.ObservableObject;const i=a.createContext({});class h extends a.Component{constructor(e,t){super(e,t),t&&(this.context=t),this.componentId=++h.uniqueNumber,h.prototype.componentWillReceiveProps.__suppressDeprecationWarning=!0}static register(n,s){t[e].Components.add(n,s)}componentDidMount(){}componentDidUpdate(e,t,n){this._manageObservables(this.props)}componentWillReceiveProps(e){}componentWillUnmount(){if(this._manageObservables(),this.events&&(this.events.removeAllListeners(),delete this.events),this.timers&&(this.timers.clearAllTimers(),delete this.timers),this.promises)for(const e of this.promises)e.cancel()}addEventListener(e,t,n,s){this.events||(this.events=new u.EventManagement),this.events.addEventListener(e,t,n,s)}removeEventListener(e,t,n,s){this.events&&this.events.removeEventListener(e,t,n,s)}clearInterval(e){this.timers&&this.timers.clearInterval(e)}clearTimeout(e){this.timers&&this.timers.clearTimeout(e)}setInterval(e,t,...n){return this.timers||(this.timers=new l.TimerManagement),this.timers.setInterval(e,t,...n)}setTimeout(e,t,...n){return this.timers||(this.timers=new l.TimerManagement),this.timers.setTimeout(e,t,...n)}trackPromise(e){this.promises||(this.promises=[]);const t=d.makeCancelable(e);return e.then(()=>{this.promises=this.promises.filter(e=>e!==t)},()=>{this.promises=this.promises.filter(e=>e!==t)}),this.promises.push(t),t}observe(e){this.observers={},this.observables||(this.observables={});for(const t of e)this.observers[t.propertyName]||(this.observers[t.propertyName]=[]),this.observers[t.propertyName].push(t);this._manageObservables(this.props)}_manageObservables(e){if(this.observables){for(const e in this.observables){for(const t of this.observables[e])t.observable.unsubscribe(t.observer,t.action);delete this.observables[e]}if(e&&this.observers)for(const t in this.observers){const n=e[t];if(n&&n.subscribe&&n.unsubscribe)for(const e of this.observers[t])n.subscribe(e.observer,e.action),this.observables[t]||(this.observables[t]=[]),this.observables[t].push({observable:n,observer:e.observer,action:e.action})}}}}h.uniqueNumber=0,h.defaultProps={},h.contextType=i,t[e].VssComponent=h;p.Services.add("IVssLayoutManager",{serviceFactory:class extends p.VssService{constructor(){super(...arguments),this.onDataProviderQueryEnd=(e=>{if(e.dataProviders){const t=e.dataProviders["ms.vss-web.component-data"];if(t)for(const e in t){const n=t[e],s=this.regionMapping[e];if(s)for(const e of n)s.some(t=>t.componentId===e.componentId)||s.push(e);else this.regionMapping[e]=n}}}),this.onFpsLoading=(e=>{this.callouts&&(this.callouts.forEach((e,t)=>{e()}),this.callouts=void 0),document.body.removeEventListener("fpsLoading",this.onFpsLoading)})}_serviceStart(e){super._serviceStart(e),this.contributionService=this.pageContext.getService("IVssContributionService"),this.contributionService.subscribe(this.onDataProviderQueryEnd,"dpqCompleted"),this.regionMapping=this.contributionService.getData("ms.vss-web.component-data")||{}}_serviceEnd(e){this.contributionService.unsubscribe(this.onDataProviderQueryEnd,"dpqCompleted")}getComponentsForRegion(e){let t=this.regionMapping[e];return t&&(t=[...t]).sort((e,t)=>(e.componentProperties&&e.componentProperties.componentOrder||Number.MAX_VALUE)-(t.componentProperties&&t.componentProperties.componentOrder||Number.MAX_VALUE)),t}renderCallout(e){const t=document.createElement("div");document.body.appendChild(t);const n=g++,s=()=>{this.callouts&&this.callouts.has(n)&&(c.unmountComponentAtNode(t),document.body.removeChild(t),this.callouts.delete(n))};void 0===this.callouts&&(this.callouts=new Map,document.body.addEventListener("fpsLoading",this.onFpsLoading)),this.callouts.set(n,s),c.render(a.createElement(m,{pageContext:this.pageContext},e(s)),t)}getFullScreenMode(){return this._fullScreenMode||(this._fullScreenMode=new n.ObservableValue(-1!==window.location.href.indexOf("fullScreen=true"))),this._fullScreenMode}setFullScreenMode(e){this._fullScreenMode?this._fullScreenMode.value=e:this._fullScreenMode=new n.ObservableValue(e),e?document.body&&document.body.classList.add("full-screen-mode"):document.body&&document.body.classList.remove("full-screen-mode")}}});let g=0;p.Services.add("VssPageRenderingService",{serviceFactory:class extends p.VssService{constructor(){super(...arguments),this.reactRootKey=0}_serviceStart(e){super._serviceStart(e),this.pageRegions=document.querySelectorAll("[data-componentregion]"),this.pageContext.platformInitialized.subscribe(e=>{e&&this.renderPage()})}renderPage(){const e=this.pageContext.getService("IVssPerformanceService");e.addSplitTiming("VssPageRenderingService.renderPage.start");const t=this.pageContext.getService("IVssLayoutManager");t.setFullScreenMode(t.getFullScreenMode().value);let n=this.pageRegions.length;const s=()=>{0==--n&&this.pageContext.getService("IVssContributionEventService").fireEvent("page-rendered",{},!0)};for(let e=0;e<this.pageRegions.length;e++){const t=this.pageRegions[e].getAttribute("data-componentregion");t?c.render(a.createElement(m,{key:this.reactRootKey++,pageContext:this.pageContext},a.createElement(v,{componentRegion:t,className:"full-size"},null)),this.pageRegions[e],s):s()}e.addSplitTiming("VssPageRenderingService.renderPage.end")}},options:6});class m extends h{render(){const e=a.createElement(i.Provider,{value:{pageContext:this.props.pageContext}},this.props.children);return e}}t[e].ReactRootComponent=m;class v extends h{render(){const e=this.context.pageContext.getService("IVssLayoutManager").getComponentsForRegion(this.props.componentRegion)||[];return 0===e.length&&this.props.fallbackComponent?this.props.fallbackComponent():a.createElement("div",{className:s(this.props.className,"region-"+this.props.componentRegion),"data-renderedregion":this.props.componentRegion,role:this.props.role},e.map((e,t)=>a.createElement(f,Object.assign({key:t},this.props.childComponentProperties,e.componentProperties,{wrappedType:e.componentType}))))}}function f(n){const s=S(),{trackPromise:i}=d.usePromise();let r;if(n.dependencies){const e=s.pageContext.getService("IVssContributionService"),t=n.dependencies.filter(t=>!e.isContributionResolved(t));t.length&&(r=t)}const[o,c]=a.useState(()=>t[e].Components.get(n.wrappedType)),[u,l]=a.useState(!r&&!n.onDependenciesResolved),[h,p]=a.useState(!1);return a.useEffect(()=>{const e=async()=>{if(n.onDependenciesResolved){const e=n.onDependenciesResolved();if(e)try{await i(e)}catch(e){}}};if(r){const t=s.pageContext.getService("IVssContributionService");i(t.getContributionsAsync(n.dependencies||[])).then(async()=>{await e(),l(!0)}).catch(e=>{e&&!e.canceled&&console.error(e)})}else n.onDependenciesResolved&&e().then(()=>{l(!0)})},[n.dependencies]),a.useEffect(()=>{const s=t[e].Components.get(n.wrappedType);if(!s){const s=i=>{i.key===n.wrappedType&&(t[e].Components.unsubscribe(s,"add"),c(()=>i.value))};return t[e].Components.subscribe(s,"add"),()=>{t[e].Components.unsubscribe(s,"add")}}c(()=>s)},[n.wrappedType]),a.useEffect(()=>{if(n.loadingComponent&&(!o||!u)){const e=setTimeout(()=>{p(!0)},100);return()=>{clearTimeout(e)}}},[n.loadingComponent]),o&&u&&a.createElement(o,Object.assign({ref:n.wrappedRef},n.wrappedProps||n),n.children)||h&&n.loadingComponent&&n.loadingComponent()||null}function S(){return a.useContext(i)}t[e].RegionComponent=v,t[e].WrappedComponent=f,t[e].useComponentContext=S}("Layout"),function(e){t.Navigation={},Object.defineProperty(t,"__esModule",{value:!0});p.Services.add("IVssNavigationService",{serviceFactory:class extends p.VssService{_serviceStart(e){super._serviceStart(e);const t=e.getService("IVssContributionService");if(this.navigationData=t.getData("ms.vss-web.navigation-data"),!this.navigationData)return;let n=this.navigationData.resolvedUrl;if(n){window.location.hash&&(n+=window.location.hash);try{window.history.replaceState(history.state,document.title,n)}catch(e){console.error(`Failed to update URL to '${n}: ${e.message}`)}}if(this.navigationData.navigation){if(this.navigationData.location)for(const e in this.navigationData.navigation){const t=this.navigationData.navigation[e];t.href=this.navigationData.location[t.id]}let e=!1;for(let t=this.navigationData.displayed.length-1;t>=0;t--)e=this.navigationData.navigation[this.navigationData.displayed[t]].supportsMobile||e;if(e){const e=document.querySelector("meta[name=viewport]");if(e)e.content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no";else{const e=document.createElement("meta");e.name="viewport",e.content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no",document.head.appendChild(e)}}else{const e=document.querySelector("meta[name=viewport]");e&&(e.content="")}if(this.navigationData.hierarchy){for(const e in this.navigationData.hierarchy){const t=this.navigationData.navigation[e],n=this.navigationData.hierarchy[e],s={},i=[];t.children=[];for(const e of n){const n=this.navigationData.navigation[e];2!=(2&(n.flags||0))&&(n.order=(n.order||0)+1e5),void 0!==n.flags&&32!=(32&n.flags)?(n.parentId=t.id,t.children.push(n)):n.href&&i.push(n)}t.children.sort((e,t)=>{let n=e.order-t.order;return 0===n&&(n=e.id.toUpperCase().localeCompare(t.id.toUpperCase())),n});let r=1;for(const e of t.children){const t=e.navGroup||"";s[t]||(s[t]=r++)}if(t.children.sort((e,t)=>{let n=s[e.navGroup||""]-s[t.navGroup||""];return 0===n&&0==(n=e.order-t.order)&&(n=e.id.localeCompare(t.id)),n}),!t.href){for(const e of t.children)if(e.href){t.href=e.href;break}!t.href&&i.length>0&&(i.sort((e,t)=>e.order-t.order),t.href=i[0].href)}}if(this.matchedRoute={routeId:this.navigationData.routeId,parsedRoutes:[],routeTemplates:this.navigationData.routeTemplates,routeValues:this.navigationData.routeValues},this.navigationData.routeTemplates)for(const e of this.navigationData.routeTemplates)this.matchedRoute.parsedRoutes.push(f.parseRouteTemplate(e))}}}getCurrentRoute(){return this.matchedRoute}getDisplayedNavigation(){return this.navigationData.displayed}getNavigation(e){return this.navigationData.navigation[e]}getRouteValues(){return this.navigationData.routeValues}isDisplayed(e){return-1!=this.navigationData.displayed.indexOf(e)}getPageTitle(){return this.navigationData.pageTitle}},options:4}),t.Navigation.getCurrentRoute=function(e){return e.getService("IVssNavigationService").getCurrentRoute()},t.Navigation.getDisplayedNavigation=function(e){return e.getService("IVssNavigationService").getDisplayedNavigation()},t.Navigation.getNavigation=function(e,t){return e.getService("IVssNavigationService").getNavigation(t)},t.Navigation.getRouteValues=function(e){return e.getService("IVssNavigationService").getRouteValues()},t.Navigation.isDisplayed=function(e,t){return e.getService("IVssNavigationService").isDisplayed(t)}}(),function(e){t[e]={},Object.defineProperty(t,"__esModule",{value:!0});t[e].ClientTraceClientName="IClientTraceRestClient",t[e].getClientTraceClient=function(n,s){return n.getRestClient(t[e].ClientTraceClientName,s)},p.RestClients.add(t[e].ClientTraceClientName,{factory:class extends S.RestClientBase{constructor(e){super(e)}async publishEvents(e){return this.beginRequest({apiVersion:"4.1-preview.1",method:"POST",routeTemplate:"_apis/ClientTrace/Events",body:e})}}})}("RestClientClientTrace"),function(e){t.Trace={},Object.defineProperty(t,"__esModule",{value:!0}),t.Trace.traceError=function(e,t,n,s,i){e.getService("IVssTraceService").traceError(t,n,s,i)},t.Trace.traceException=function(e,t,n,s,i){e.getService("IVssTraceService").traceException(t,n,s,i)},t.Trace.traceWarning=function(e,t,n,s,i){e.getService("IVssTraceService").traceWarning(t,n,s,i)},t.Trace.trace=function(e,t){e.getService("IVssTraceService").trace(t)};const n=5;p.Services.add("IVssTraceService",{serviceFactory:class extends p.VssService{constructor(){super(...arguments),this.events=[],this.globalErrorCount=0,this._onWindowError=(e=>{if(e.filename&&this.globalErrorCount++<n){const t={filename:e.filename,lineNumber:e.lineno,columnNumber:e.colno,errorType:"UnhandledException"},n=this.pageContext.getService("IVssNavigationService").getCurrentRoute().routeId;this.traceException("WebUnhandledExceptions",n,e.error,t)}}),this._onUnhandledRejection=(e=>{const t=e.reason;if(t&&!t.isCanceled&&(console.warn(`Unhandled promise rejection: ${t}`),this.globalErrorCount++<n)){const e={errorType:"UnhandledRejection"},n=this.pageContext.getService("IVssNavigationService").getCurrentRoute().routeId;this.traceException("WebUnhandledExceptions",n,t,e)}})}_serviceStart(e){if(super._serviceStart(e),onPreTraceServiceError&&window.removeEventListener("error",onPreTraceServiceError),preTraceServiceStartErrors&&preTraceServiceStartErrors.length>0){for(const e of preTraceServiceStartErrors)this._onWindowError(e);preTraceServiceStartErrors.length=0}this.publishInterval=window.setInterval(this._sendEvents.bind(this),1e3),window.addEventListener("error",this._onWindowError),window.addEventListener("unhandledrejection",this._onUnhandledRejection)}_serviceRestart(e){super._serviceRestart(e),this.globalErrorCount=0,this._sendEvents()}_serviceEnd(e){this.publishInterval&&(window.clearInterval(this.publishInterval),this.publishInterval=0),window.removeEventListener("error",this._onWindowError),window.removeEventListener("unhandledrejection",this._onUnhandledRejection),super._serviceEnd(e)}traceError(e,t,n,s){const i={area:e,feature:t,message:n,properties:s,level:1};this.trace(i)}traceException(e,t,n,s){const i={area:e,feature:t,message:n?n.message:n||"unknown",exceptionType:"",properties:s,level:2};n&&(i.properties||(i.properties={}),i.properties.stackTrace=n.stack,i.exceptionType=n.name),this.trace(i)}traceWarning(e,t,n,s){const i={area:e,feature:t,message:n,properties:s,level:2};this.trace(i)}trace(e){this.events.push(e)}_sendEvents(){if(this.events.length>0){const e=this.events;this.events=[],this.pageContext.getRestClient("IClientTraceRestClient").publishEvents(e)}}},options:6})}(),function(e){P=t.ComponentsErrorBoundaryErrorBoundary={},Object.defineProperty(t,"__esModule",{value:!0});t.ComponentsErrorBoundaryErrorBoundary.ErrorBoundary=class extends I.VssComponent{constructor(e){super(e),this.state={}}componentDidCatch(e,t){if(this.setState({error:e,errorInfo:t}),e){const n=this.context.pageContext.getService("IVssNavigationService").getCurrentRoute().routeId,s={};t&&t.componentStack&&(s.componentStack=t.componentStack),this.context.pageContext.getService("IVssTraceService").traceException("WebUnhandledExceptions",n,e,s)}}render(){if(this.state.error){const e=this.props.handlerComponentProps||{},t=Object.assign({},e,{reloadComponent:()=>{this.setState({error:void 0,errorInfo:void 0})},error:this.state.error,errorInfo:this.state.errorInfo});return a.createElement(I.WrappedComponent,{wrappedType:this.props.handlerComponentType,wrappedProps:t,key:"error-boundary-ui"},[])}return this.props.children}}}(),function(e){t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),function(n){for(var s in n)t[e].hasOwnProperty(s)||(t[e][s]=n[s])}(P)}("ComponentsErrorBoundary"),w=t.ComponentsFormatFormat={},Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentsFormatFormat.FormatComponent=(e=>{let t=void 0;const{format:n,elementType:s,children:i}=e,r=__rest(e,["format","elementType","children"]);if(n){const e=n.split(/(?:\{)([0-9]+)(?:\})/),s=a.Children.toArray(i);t=[];const r={};for(let n=0;n<e.length;++n){const i=e[n];if(1&n){const e=parseInt(i,10);if(r[e])throw new Error(`Index in the format can only be used once, recurring index is ${e}`);{const n=s[e];if(!n)throw new Error(`No element found for the specified index ${e}`);t.push(n),r[e]=!0}}else t.push(i)}}return a.createElement(s||"span",r,t||i)}),function(e){t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),function(n){for(var s in n)t[e].hasOwnProperty(s)||(t[e][s]=n[s])}(w)}("ComponentsFormat"),function(e){E=t.ComponentsLayoutLayout={},Object.defineProperty(t,"__esModule",{value:!0});class n extends I.VssComponent{render(){return a.createElement(this.props.elementType||"div",{"aria-label":this.props["aria-label"],className:I.css(this.props.orientation&&"column"===this.props.orientation?"flex-column":"flex-row",this.props.className)},this.props.components.map((e,t)=>{let n;return e.componentType?n=a.createElement(I.WrappedComponent,Object.assign({key:t,hasBoundary:!!e.errorBoundaryProps},e.componentProperties,{wrappedType:e.componentType})):e.componentRegion&&(n=a.createElement(I.RegionComponent,Object.assign({key:t,hasBoundary:!!e.errorBoundaryProps},e.componentProperties,{componentRegion:e.componentRegion}))),e.errorBoundaryProps?a.createElement(P.ErrorBoundary,Object.assign({key:t},e.errorBoundaryProps),n):n}))}}n.componentType="layout",t.ComponentsLayoutLayout.LayoutComponent=n,I.VssComponent.register(n.componentType,n);class s extends I.VssComponent{render(){return a.createElement("div",{className:I.css("flex-grow",this.props.className)})}}s.componentType="layoutFiller",t.ComponentsLayoutLayout.LayoutFillerComponent=s,I.VssComponent.register(s.componentType,s);class i extends I.VssComponent{render(){return a.createElement(this.props.elementType||"div",{className:this.props.className},this.props.text)}}i.componentType="htmlElement",t.ComponentsLayoutLayout.HtmlElementComponent=i,I.VssComponent.register(i.componentType,i);class r extends a.Component{render(){return null}}r.componentType="NoOp",t.ComponentsLayoutLayout.NoOpComponent=r,I.VssComponent.register(r.componentType,r)}(),function(e){t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),function(n){for(var s in n)t[e].hasOwnProperty(s)||(t[e][s]=n[s])}(E)}("ComponentsLayout"),function(e){var n;T=t.History={},Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.statePopped="statePopped"}(n=t.History.HistoryServiceEventNames||(t.History.HistoryServiceEventNames={}));p.Services.add("IVssHistoryService",{serviceFactory:class extends p.VssObservableService{constructor(){super(...arguments),this.onbeginDataProviderQuery=(e=>{e.properties.sourcePage={url:window.location.href,routeId:this._currentRoute.routeId,routeValues:this.getCurrentRouteValues()}}),this._onPopState=(e=>{const t=e.state;let s;t&&t.vssNavigationState&&(s=t.vssNavigationState);const i=this._currentState;this._currentState=s;const r={oldState:i,newState:s};this._notify(r,n.statePopped)})}_serviceStart(e){super._serviceStart(e),this._initialize(),window.addEventListener("popstate",this._onPopState),this._currentRoute&&this.replaceState(void 0,void 0)}_serviceRestart(e){super._serviceRestart(e),this._initialize(),this.replaceState(void 0,window.location.href)}replaceState(e,t,n,s){this._setState(!0,e,t,n,s)}pushState(e,t,n,s){this._setState(!1,e,t,n,s)}getData(){return this._currentState&&this._currentState.data}getState(){let e;return e=this._currentState&&this._currentState.state?Object.assign({},this._currentState.state):this._getStateFromUrl(window.location.href)}generateUrl(e,t=2){const n=this._currentRoute.routeValues;let s;switch(t){case 2:s=Object.assign({},this.getState(),e);break;case 1:s=Object.assign({},this.getCurrentRouteValues(),e);break;default:s=e}const i=f.getBestRouteMatch(this._currentRoute.parsedRoutes,s);let r="";i&&(r=i.url);const o=new f.Uri(f.combineUrlPaths(this._pageData.hostPath,r));if(i)for(const e in s)if(!i.matchedParameters[e]){const t=s[e];null!=t&&n[e]!==t&&o.addQueryParam(e,t)}return o.absoluteUri}getCurrentRouteValues(){const e=this._currentRoute.routeValues,t={},n=this.getState();for(const s in e)t[s]=n[s];return t}_initialize(){const e=this.pageContext.getService("IVssPageService");this._pageData=e.getData();const t=this.pageContext.getService("IVssNavigationService");this._currentRoute=t.getCurrentRoute(),this._unsubscribeOnRestart&&this._unsubscribeOnRestart();const n=this.pageContext.getService("IVssContributionService");n.subscribe(this.onbeginDataProviderQuery,"dpqStarting"),this._unsubscribeOnRestart=(()=>{n.unsubscribe(this.onbeginDataProviderQuery,"dpqStarting")})}_setState(e,t,n,s,i){n&&!t?t=this._getStateFromUrl(n):t&&!n?n=this.generateUrl(t,0):n||t||(n=window.location.href,(t=this._currentState&&this._currentState.state)||(t=this._getStateFromUrl(n))),null==s&&(s=this._currentRoute.routeId);const r=window.history.state;let o={};e&&r&&r.vssNavigationState&&(o=r.vssNavigationState.data),i&&(o=Object.assign({},o,i));const a={state:t,routeId:s,data:o,url:n},c=e?Object.assign({},r,{vssNavigationState:a}):{vssNavigationState:a};this._currentState=a,e||window.location.href===n?window.history.replaceState(c,void 0,n):window.history.pushState(c,void 0,n)}_getStateFromUrl(e){const t=Object.assign({},this._currentRoute.routeValues);if(e){const n=new f.Uri(e);for(const e of n.queryParameters)t[e.name]=e.value||""}return t}},options:6})}(),function(e){R=t.FPS={},Object.defineProperty(t,"__esModule",{value:!0});const n="navigation/fpsCIEvent";let s,i=0;function r(e,t,n={}){const s=e.getService("IVssNavigationService"),i=e.getService("IVssPageService").getData(),r=s.getDisplayedNavigation();return Object.assign({},n,{source:t||"unknown",sourceNavigationId:r[r.length-1],sourceRouteId:s.getCurrentRoute().routeId,startNavigationOffset:Date.now()-window.performance.timing.navigationStart,serviceVersion:i?i.serviceVersion:void 0})}function o(e,t){t.endNavigationOffset=Date.now()-window.performance.timing.navigationStart,e.getService("IVssTelemetryService").publishEvent("WebPlatform","FPS",t)}function a(e,t,a,c={}){const u=++i,l={pageContext:e,href:t,recordHistoryEntry:a,data:c,startTime:Date.now()};s&&(s.cancel(),s=null);const h=r(e,c.telemetrySource,c.telemetryProperties),p=new CustomEvent("fpsStarting",{cancelable:!0,detail:Object.assign({},l)});if(document.body.dispatchEvent(p)){const i={cache:"no-cache",method:"GET",mode:"same-origin"},r=new f.Uri(t);r.addQueryParam("__rt","fps");const c=e.getService("IVssPageService").getData();c&&r.addQueryParam("__ver",""+c.webPlatformVersion),document.body.dispatchEvent(new CustomEvent("fpsLoading",{cancelable:!1,detail:Object.assign({},l)})),e.getService("IVssPerformanceService").addSplitTiming("fpsRequestStarting");const p=d.makeCancelable(m.issueRequest(r.absoluteUri,i)),g=p.promise.then(i=>(s===p&&(s=null),i.text().then(s=>{e.getService("IVssPerformanceService").addSplitTiming("fpsResponseReceived");let i=null;try{i=v.deserializeVssJsonObject(s)}catch(e){return console.log(`Not a valid FPS response: ${e.message||e}. Performing full page navigation`),h.invalidFPSResponse=!0,C.trySetLocalStorageObject(n,h),window.location.href=t,!0}const r=i&&i.fps;if(r&&(r.dataProviders&&v.updateJsonScriptValue("dataProviders",r.dataProviders,!0),r.performance&&v.updateJsonScriptValue("serverStatistics",r.performance),r.content)){if(e.getService("IFastPageSwitchService").hasStaleContent(r.content))return h.staleContent=!0,o(e,h),window.location.href=t,!0;e.getService("IVssContentService").loadScripts(r.content)}const c=e.getService("IVssHistoryService");a?c.pushState(void 0,t,void 0,{fpsNavigationId:u}):c.replaceState(void 0,t,void 0,{fpsNavigationId:u}),document.body.dispatchEvent(new CustomEvent("fpsLoaded",{cancelable:!1,detail:Object.assign({fpsResponse:i},l)})),document.body.dispatchEvent(new CustomEvent("fpsCompleted",{cancelable:!1,detail:Object.assign({fpsResponse:i,success:!0},l)}));const d=e.getService("IVssNavigationService"),p=d.getDisplayedNavigation();return h.targetNavigationId=p[p.length-1],h.targetRouteId=d.getCurrentRoute().routeId,h.success=!0,o(e,h),!0}))).catch(i=>(s!==p||i.isCanceled?(h.cancelledByOtherFPS=!0,o(e,h)):(h.failed=!0,C.trySetLocalStorageObject(n,h),window.location.href=t),s===p&&(s=null),document.body.dispatchEvent(new CustomEvent("fpsCompleted",{cancelable:!1,detail:Object.assign({success:!1,reason:i},l)})),!1));return s=p,g}return h.cancelledByUser=!0,p.detail.cancellationReason&&(h.cancellationReason=p.detail.cancellationReason),o(e,h),Promise.resolve(!1)}t.FPS.onClickFPS=function(e,t,n,s,i={}){if(!s||!(s.ctrlKey||s.metaKey||s.shiftKey||1===s.button))return a(e,t,n,i),s&&s.preventDefault(),!0;{const t=r(e,i.telemetrySource,i.telemetryProperties);t.external=!0,t.ctrlKey=s&&s.ctrlKey,t.metaKey=s&&s.metaKey,t.shiftKey=s&&s.shiftKey,t.middleClick=1===(s&&s.button),o(e,t)}},t.FPS.FastPageSwitch=a;p.Services.add("IFastPageSwitchService",{serviceFactory:class extends p.VssService{constructor(){super(...arguments),this.loadedContentIntegrity={},this.loadedContentFilenames={},this._onNavigate=(e=>{e.newState&&(e.oldState&&e.oldState.data&&e.oldState.data.fpsNavigationId)!==(e.newState.data&&e.newState.data.fpsNavigationId)&&a(this.pageContext,e.newState.url,!1,{})}),this._onContentLoaded=(e=>{const t=e.contentAttributes;t&&t.clientId&&(t.integrity&&(this.loadedContentIntegrity[t.clientId]=t.integrity),this.loadedContentFilenames[t.clientId]=this.getFileName(t.url))})}_serviceStart(e){super._serviceStart(e);try{const t=C.tryGetLocalStorageObject(n);if(C.trySetLocalStorageObject(n,void 0),t){const n=e.getService("IVssNavigationService"),s=n.getDisplayedNavigation();t.targetNavigationId=s[s.length-1],t.targetRouteId=n.getCurrentRoute().routeId,o(e,t)}}catch(e){}e.getService("IVssHistoryService").subscribe(this._onNavigate,T.HistoryServiceEventNames.statePopped);const t=e.getService("IVssPageService").getData();t&&t.isBundlingEnabled&&(this.bundlingEnabled=!0,e.getService("IVssContentService").subscribe(this._onContentLoaded,"contentComplete"))}hasStaleContent(e){let t=!1;if(this.bundlingEnabled)for(const n of e)if(n.clientId){if(n.integrity){const e=this.loadedContentIntegrity[n.clientId];if(e&&e!==n.integrity){t=!0;break}}const e=this.loadedContentFilenames[n.clientId];if(e&&e!==this.getFileName(n.url)){t=!0;break}}return t}getFileName(e){const t=e.lastIndexOf("/");return t>=0?e.substr(t+1):e}},options:6})}(),function(e){D=t.ComponentsFPSLinkFPSLink={},Object.defineProperty(t,"__esModule",{value:!0});t.ComponentsFPSLinkFPSLink.FPSLinkComponent=class extends I.VssComponent{render(){const e=Object.assign({},this.props,{onClick:e=>{e.isDefaultPrevented()||(this.props.href&&!1!==this.props.supportsFPS?R.onClickFPS(this.context.pageContext,this.props.href,!0,e,{telemetrySource:this.props.telemetrySource,telemetryProperties:this.props.telemetryProperties,navigationId:this.props.navigationId}):this.props.telemetrySource&&this.context.pageContext.getService("IVssTelemetryService").publishEvent("WebPlatform","Link",Object.assign({},this.props.telemetryProperties||{},{source:this.props.telemetrySource})))}});return delete e.navigationId,delete e.supportsFPS,delete e.telemetrySource,delete e.telemetryProperties,a.createElement("a",e,this.props.children)}}}(),function(e){t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),function(n){for(var s in n)t[e].hasOwnProperty(s)||(t[e][s]=n[s])}(D)}("ComponentsFPSLink"),function(e){t.Fallback={},Object.defineProperty(t,"__esModule",{value:!0});const n="cdn.fallback.service";p.Services.add("IVssFallbacksService",{serviceFactory:class extends p.VssService{constructor(){super(...arguments),this.secureFlag="",this.usedCdnFallback=!1,this.contentLoadError=(e=>{if(!this.usedCdnFallback){this.usedCdnFallback=!0;const t=28800;document.cookie=`TFS-CDN=disabled;max-age=${t};path=/${this.secureFlag}`,document.cookie=`TFS-CDNTRACE=report-true;path=/${this.secureFlag}`,R.onClickFPS(this.pageContext,window.location.href,!1,void 0,{telemetrySource:n,telemetryProperties:{failingContent:e},customUnloadMessage:h.CdnFallbackErrorMessage})}})}_serviceStart(e){super._serviceStart(e);const t=this.pageContext.getService("IVssPageService").getData();t&&t.isCdnEnabled&&(t.isSslOnly&&(this.secureFlag=";secure"),this.pageContext.getService("IVssContentService").subscribe(this.contentLoadError,"contentLoadError"))}},options:6})}(),function(e){x=t.Feature={},Object.defineProperty(t,"__esModule",{value:!0});p.Services.add("IVssFeatureService",{serviceFactory:class extends p.VssService{isFeatureEnabled(e,t){const n=this.getSharedDataState("_features",e,t);if(void 0===n)throw new Error(`Could not find feature state for feature '${e}'. Ensure that the feature is included in shared data.`);return n}isFeatureFlagEnabled(e,t){const n=this.getSharedDataState("_featureFlags",e,t);if(void 0===n)throw new Error(`Could not find feature flag state for '${e}'. Ensure that the feature flag is included in shared data.`);return n}getSharedDataState(e,t,n){const s=this.pageContext.getService("IVssContributionService").getSharedData(e);if(s){const e=s[t];if(void 0!==e)return e}return n}}}),t.Feature.isFeatureEnabled=function(e,t,n){return e.getService("IVssFeatureService").isFeatureEnabled(t,n)},t.Feature.isFeatureFlagEnabled=function(e,t,n){return e.getService("IVssFeatureService").isFeatureFlagEnabled(t,n)}}(),function(e){t.Identity={},Object.defineProperty(t,"__esModule",{value:!0});const n="_identityDetails";p.Services.add("IVssIdentityService",{serviceFactory:class extends p.VssService{constructor(){super(...arguments),this.cachedIdentityDetails={}}getIdentityDetails(e){let t=this.cachedIdentityDetails[e];if(!t){const n=this.getSharedIdentityDetails(e);n&&(t={id:e,displayName:n.displayName,imageId:n.identityImageId,imageUrl:this.getIdentityImageUrl(e)},this.cachedIdentityDetails[e]=t)}if(!t)throw new Error(`Missing shared identity details for identity with id ${e}.`);return t}getIdentityImageUrl(e,t=0){return"string"==typeof e?this._getIdentityImageUrlFromIdentityId(e,t):this._getIdentityImageUrlFromIdentityRef(e,t)}getSharedIdentityDetails(e){const t=this.pageContext.getService("IVssContributionService").getSharedData(n);return t?t[e]:void 0}_getIdentityImageUrlFromIdentityId(e,t){let n;const s=this.getSharedIdentityDetails(e);s&&(n=s.identityImageId||"0");let i=`_api/_common/identityImage?id=${e}&size=${t}`;n&&(i+=`&t=${n}`);const r=this.pageContext.getService("IVssPageService").getData();return r&&r.hostPath&&(i=f.combineUrlPaths(encodeURI(r.hostPath),i)),i}_getIdentityImageUrlFromIdentityRef(e,t){const n=!x.isFeatureFlagEnabled(this.pageContext,"VisualStudio.Services.WebPlatform.DisableNewAvatarImage");if(e._links&&e._links.avatar&&e._links.avatar.href&&n){const n=new f.Uri(e._links.avatar.href);return n.addQueryParam("size",""+t,!0),n.absoluteUri}return e.descriptor&&n?this._getIdentityAvatarUrl(e.descriptor):e.imageUrl||this._getIdentityImageUrlFromIdentityId(e.id,t)}_getIdentityAvatarUrl(e){let t=`_apis/GraphProfile/MemberAvatars/${e}`;const n=this.pageContext.getService("IVssPageService").getData();return n&&n.hostPath&&(t=f.combineUrlPaths(encodeURI(n.hostPath),t)),t}}}),t.Identity.getIdentityImageUrl=function(e,t,n){return e.getService("IVssIdentityService").getIdentityImageUrl(t,n)}}(),function(e){t.KeyboardShortcuts={},Object.defineProperty(t,"__esModule",{value:!0});p.Services.add("IVssKeyboardShortcutService",{serviceFactory:class extends p.VssService{constructor(){super(...arguments),this._originalStopCallback=window.Mousetrap.prototype.stopCallback}_serviceStart(e){super._serviceStart(e);const t=this;window.Mousetrap.prototype.stopCallback=function(e,n,s,i){return!t._globalCombos[s]&&!t._globalCombos[i]&&("true"===n.getAttribute("data-onlyglobalshortcuts")||t._originalStopCallback.call(this,e,n,s))},this.initializeService()}_serviceRestart(e){super._serviceRestart(e),this.initializeService()}getShortcutGroups(){return Object.keys(this._shortcutsGroups).map(e=>this._shortcutsGroups[e])}getGlobalCombos(){return Object.keys(this._globalCombos)}registerShortcut(e,t){this._shortcutsGroups[e]||(this._shortcutsGroups[e]={name:e,shortcuts:[]});const n=t=>{this.pageContext.getService("IVssTelemetryService").publishEvent("KeyboardShortcuts","ShortcutInvoked",{group:e,shortcut:t})};let s;const i=(e,s)=>(n(s),t.isPageNavigationShortcut&&this.reset(),t.action(e,s),t.allowPropagation||!1);let r;if("string"==typeof t.element)try{r=document.querySelector(t.element)}catch(e){r=null}else r=t.element;r?(s=window.Mousetrap(r)).bind(t.combos,i):window.Mousetrap.bind(t.combos,i);const o=t.globalCombos||[];for(const e of t.combos)o.indexOf(e)>=0&&(this._globalCombos[e]=!0);const a=[];for(const e of t.combos)this._registeredCombos[e]||(a.push(e),this._registeredCombos[e]=!0);const c=Object.assign({},t,{combos:t.combos,combosToDisplay:t.hideFromHelpDialog?[]:a,mousetrapInstance:s});this._shortcutsGroups[e].shortcuts.push(c)}unRegisterShortcut(e,t){if(this._registeredCombos[t]&&delete this._registeredCombos[t],!this._shortcutsGroups[e])return;const n=this._shortcutsGroups[e].shortcuts;let s=0,i=!1;for(;s<n.length;s++){const e=n[s];if(e.combos.indexOf(t)>=0){e.mousetrapInstance?e.mousetrapInstance.unbind(t):window.Mousetrap.unbind(t),1===e.combos.length&&(i=!0),delete this._globalCombos[t];break}}i&&(n.splice(s,1),0===n.length&&this.removeShortcutGroup(e))}removeShortcutGroup(e){if(!this._shortcutsGroups[e])return;const t=this._shortcutsGroups[e].shortcuts;delete this._shortcutsGroups[e],t.forEach(e=>{e.mousetrapInstance?e.mousetrapInstance.unbind(e.combos):window.Mousetrap.unbind(e.combos);for(const t of e.combos)delete this._registeredCombos[t],delete this._globalCombos[t]})}initializeService(){this.reset();const e=this.pageContext.getService("IVssContributionService"),t=e.getContributionsByType("ms.vss-web.shortcut");for(const n in t){const s=t[n];this.registerShortcut(s.group,{combos:s.combos,description:s.description,isPageNavigationShortcut:s.isPageNavigationShortcut,action:()=>{s.command?e.executeCommandEx(n,s.command):s.commandId&&e.executeCommand(s.commandId)}})}}reset(){window.Mousetrap.reset(),this._globalCombos={},this._registeredCombos={},this._shortcutsGroups={}}},options:6})}(),function(e){N=t.Location={},Object.defineProperty(t,"__esModule",{value:!0});p.Services.add("IVssLocationService",{serviceFactory:class extends p.VssService{constructor(){super(...arguments),this._parsedRoutes={}}getAssetLocation(e){const t=this.pageContext.getService("IVssContributionService").getSharedData("_assets");if(t)return t[e];throw new Error(`Could not find asset for service ${e}. Ensure that the asset is added through a shared data value.`)}getServiceInstanceTypeForResourceArea(e){const t=this.pageContext.getService("IVssContributionService").getSharedData("_resourceAreas");if(t)return t[e]}getServiceLocation(e,t){const n=this.getServiceLocationLocal(e,t);if(!n)throw new Error(`Could not find location for service ${e} and hostType ${t}. Ensure that the requested service location is included in shared data.`);return n}getServiceLocationAsync(e,t){const n=this.getServiceLocationLocal(e,t);if(n)return Promise.resolve(n);const s=this.pageContext.getService("IVssPageService").getData(),i=this.pageContext.getService("IVssContributionService"),r={_sharedData:{locations:[{ServiceInstanceId:e&&s.isHosted?e:s.serviceInstanceType,HostType:t||s.hostType}]}};return i.getDataAsync("ms.vss-web.shared-data",r).then(()=>this.getServiceLocation(e,t))}routeUrl(e,t,n){let s=this._parsedRoutes[e];if(!s){const t=this.pageContext.getService("IVssContributionService").getSharedData("_routes");if(t){const n=t[e];n&&(s=[],n.forEach(e=>{s.push(f.parseRouteTemplate(e))}),this._parsedRoutes[e]=s)}}if(s){const e=f.routeUrl(s,t||{});if(!n){const e=this.pageContext.getService("IVssPageService").getData();e&&e.hostPath&&(n=e.hostPath)}if(n){const t=encodeURI(n);return f.combineUrlPaths(t,e)}}throw new Error(`Could not find route for route id ${e}. Ensure that the requested route is added to routes shared data.`)}getServiceLocationLocal(e,t){const n=this.pageContext.getService("IVssPageService").getData();t||(t=n.hostType),e&&n.isHosted||(e=n.serviceInstanceType);const s=this.pageContext.getService("IVssContributionService").getSharedData("_locations");if(s){const n=s[e];if(n){const e=n[t];if(e)return e}}}}}),t.Location.getAssetLocation=function(e,t){return e.getService("IVssLocationService").getAssetLocation(t)},t.Location.getServiceLocation=function(e,t,n){return e.getService("IVssLocationService").getServiceLocation(t,n)},t.Location.routeUrl=function(e,t,n,s){return e.getService("IVssLocationService").routeUrl(t,n,s)}}(),function(e){V=t.UserClaims={},Object.defineProperty(t,"__esModule",{value:!0});p.Services.add("IVssUserClaimsService",{serviceFactory:class extends p.VssService{hasClaim(e){if(!this.claims){const e=this.pageContext.getService("IVssContributionService");this.claims=e.getData("ms.vss-web.user-claims-data")||this.getDefaultClaims()}return e=(e||"").toLowerCase(),this.claims[e]}getDefaultClaims(){const e={member:!0};return e}}}),t.UserClaims.userHasClaim=function(e,t){return e.getService("IVssUserClaimsService").hasClaim(t)}}(),function(e){t.RestClientOptionsProvider={},Object.defineProperty(t,"__esModule",{value:!0});p.Services.add("IRestClientOptionsProviderService",{serviceFactory:class extends p.VssService{populateRestClientOptions(e,t){const n=Object.assign({},t),s=this.pageContext.getService("IVssPageService").getData();if(s&&(n.sessionId||(n.sessionId=s.sessionId),!n.rootPath)){const t=n.hostType;let i=n.serviceInstanceType;if(!i&&e&&(e.resourceAreaId&&(i=this.pageContext.getService("IVssLocationService").getServiceInstanceTypeForResourceArea(e.resourceAreaId)),i||(i=e.serviceInstanceType)),s.isHosted&&i&&i!==s.serviceInstanceType||t&&t!==s.hostType){if(s.isHosted&&V.userHasClaim(this.pageContext,"member")&&!n.authTokenProvider){const e=this.pageContext.getService("IAuthenticationService");n.authTokenProvider=e.getDefaultTokenProvider()}n.rootPath=N.getServiceLocation(this.pageContext,i,n.hostType)}else n.rootPath=s.hostPath||"/"}return n}}})}(),function(e){t[e]={},Object.defineProperty(t,"__esModule",{value:!0});t[e].ContributionsClientName="IContributionsRestClient",t[e].getContributionsClient=function(n,s){return n.getRestClient(t[e].ContributionsClientName,s)},p.RestClients.add(t[e].ContributionsClientName,{factory:class extends S.RestClientBase{constructor(e){super(e)}async queryDataProviders(e,t,n){return this.beginRequest({apiVersion:"3.2-preview.1",method:"POST",routeTemplate:"_apis/Contribution/dataProviders/query/{scopeName}/{scopeValue}",routeValues:{scopeName:t,scopeValue:n},body:e})}}})}("RestClientContributions"),function(e){t[e]={},Object.defineProperty(t,"__esModule",{value:!0});t[e].LocationsClientName="ILocationsRestClient",t[e].getLocationsClient=function(n,s){return n.getRestClient(t[e].LocationsClientName,s)},p.RestClients.add(t[e].LocationsClientName,{factory:class extends S.RestClientBase{constructor(e){super(e)}async getResourceArea(e,t,n){const s={enterpriseName:t,organizationName:n};return this.beginRequest({apiVersion:"4.0-preview.1",routeTemplate:"_apis/ResourceAreas/{areaId}",routeValues:{areaId:e},queryParams:s})}async getResourceAreaByHost(e,t){const n={hostId:t};return this.beginRequest({apiVersion:"4.0-preview.1",routeTemplate:"_apis/ResourceAreas/{areaId}",routeValues:{areaId:e},queryParams:n})}}})}("RestClientLocations"),function(e){t[e]={},Object.defineProperty(t,"__esModule",{value:!0});t[e].SettingsClientName="ISettingsRestClient",t[e].getSettingsClient=function(n,s){return n.getRestClient(t[e].SettingsClientName,s)},p.RestClients.add(t[e].SettingsClientName,{factory:class extends S.RestClientBase{constructor(e){super(e)}async getEntries(e,t){return this.beginRequest({apiVersion:"4.1-preview.1",routeTemplate:"_apis/Settings/Entries/{userScope}/{*key}",routeValues:{userScope:e,key:t}})}async removeEntries(e,t){return this.beginRequest({apiVersion:"4.1-preview.1",method:"DELETE",routeTemplate:"_apis/Settings/Entries/{userScope}/{*key}",routeValues:{userScope:e,key:t}})}async setEntries(e,t){return this.beginRequest({apiVersion:"4.1-preview.1",method:"PATCH",routeTemplate:"_apis/Settings/Entries/{userScope}/{*key}",routeValues:{userScope:t},body:e})}async getEntriesForScope(e,t,n,s){return this.beginRequest({apiVersion:"4.1-preview.1",routeTemplate:"_apis/Settings/{scopeName}/{scopeValue}/Entries/{userScope}/{*key}",routeValues:{userScope:e,scopeName:t,scopeValue:n,key:s}})}async removeEntriesForScope(e,t,n,s){return this.beginRequest({apiVersion:"4.1-preview.1",method:"DELETE",routeTemplate:"_apis/Settings/{scopeName}/{scopeValue}/Entries/{userScope}/{*key}",routeValues:{userScope:e,scopeName:t,scopeValue:n,key:s}})}async setEntriesForScope(e,t,n,s){return this.beginRequest({apiVersion:"4.1-preview.1",method:"PATCH",routeTemplate:"_apis/Settings/{scopeName}/{scopeValue}/Entries/{userScope}/{*key}",routeValues:{userScope:t,scopeName:n,scopeValue:s},body:e})}}})}("RestClientSettings"),function(e){t.Search={},Object.defineProperty(t,"__esModule",{value:!0});const n="ms.vss-web.search-coordinator",s="ms.vss-web.search-provider";p.Services.add("IVssSearchService",{serviceFactory:class extends p.VssObservableService{execute(e){const t=this.pageContext.getService("IVssContributionService"),s=t.getContributionsByType(n);let i=void 0,r=void 0;for(const e in s)(!r||s[e].priority>r.priority)&&(r=s[i=e]);return i?t.getService(i).then(t=>{if(t)return t.execute(e).then(e=>(this._notify(e,"searchStarted"),e));throw new Error("Failed to create the configured search coordinator")}):Promise.reject("No search coordinator is available to perform the search operation.")}getProviders(){return this.pageContext.getService("IVssContributionService").getContributionsByType(s)}getSelectedProvider(){let e=this.selectedProviderId||this.defaultProviderId;if(!e){const t=this.getProviders(),n=Object.keys(t);if(n.length>0){const s=this.pageContext.getService("IVssNavigationService"),i=s.getDisplayedNavigation(),r=[];for(let e=i.length-1;e>=0;e--){const t=s.getNavigation(i[e]);t&&t.displayedDocTypes&&r.splice(i.length,0,...t.displayedDocTypes)}e:for(const n of r)for(const s in t){const i=t[s];if(i.supportedDocTypes&&-1!==i.supportedDocTypes.indexOf(n)){e=s;break e}}if(!e){e=n[0];for(const n in t){const s=t[n],i=t[e];void 0!==s.priority&&(void 0===i.priority||s.priority>i.priority)&&(e=n)}}this.defaultProviderId=e}}return e}setSelectedProvider(e){this.getProviders()[e]&&(this.selectedProviderId=e,this._notify(this.selectedProviderId,"providerSelected"))}}})}(),function(e){t.Security={},Object.defineProperty(t,"__esModule",{value:!0});const n="_permissions";p.Services.add("IVssSecurityService",{serviceFactory:class extends p.VssService{hasPermission(e,t,s){const i=this.pageContext.getService("IVssContributionService").getSharedData(n);if(!i)return this.handleMissingState("No shared permissions found");const r=i[e.toLowerCase()];if(!r)return this.handleMissingState(`Security namespace with id '${e}' not found`);const o=r[t];return void 0===o?this.handleMissingState(`No permissions found for security namespace '${e}' and token '${t}'`):(s&o)>0}checkPermission(e,t,n){if(!this.hasPermission(e,t,n))throw new Error(`Access denied: Permission ${n} is needed for the resource ${t}.`)}handleMissingState(e){return console.error(`${e}. Ensure that the effective permissions are included in shared data.`),!1}}})}(),function(e){t.Settings={},Object.defineProperty(t,"__esModule",{value:!0});const n=Promise.resolve({value:{},count:0}),s=Promise.resolve();p.Services.add("ISettingsService",{serviceFactory:class extends p.VssService{getEntry(e,t,n,s){const i=this.getEntriesForKey(t,n,s);if(i){const t=i[e];if(void 0!==t)return t;const n=e.split("/");for(let e=n.length-2;e>=0;e--){const t=i[n.slice(0,e+1).join("/")];if(t){let s=t;for(let t=e+1;t<n.length&&s;t++)s=s[n[t]];return s}}}}getEntriesAsync(e,t,s,i){if(!this.canCallSettingsEndpoint)return n;let r;return(r=s?this.httpClient.getEntriesForScope(this.userScopeToString(t),s,i,e):this.httpClient.getEntries(this.userScopeToString(t),e)).then(n=>this.updateLocalEntries(e,n,t,s,i))}setEntries(e,t,n,i){if(!this.canCallSettingsEndpoint)return s;for(const s in e)this.updateLocalEntries(s,e[s],t,n,i);return n?this.httpClient.setEntriesForScope(e,this.userScopeToString(t),n,i):this.httpClient.setEntries(e,this.userScopeToString(t))}removeEntries(e,t,n,i){return this.canCallSettingsEndpoint?(this.updateLocalEntries(e,void 0,t,n,i),n?this.httpClient.removeEntriesForScope(this.userScopeToString(t),n,i,e):this.httpClient.removeEntries(this.userScopeToString(t),e)):s}userScopeToString(e){return 2===e?"globalme":1===e?"host":"me"}get httpClient(){return this._httpClient||(this._httpClient=this.pageContext.getRestClient("ISettingsRestClient")),this._httpClient}get canCallSettingsEndpoint(){return void 0===this._canCallSettingsEndpoint&&(this._canCallSettingsEndpoint=V.userHasClaim(this.pageContext,"member")),this._canCallSettingsEndpoint}updateLocalEntries(e,t,n,s,i){const r=this.getEntriesForKey(n,s,i);if(r){r[e]=t;const n=e.split("/");for(let e=n.length-2;e>=0;e--){const s=r[n.slice(0,e+1).join("/")];if(s){let i=s;for(let t=e+1;t<n.length-1&&i;t++){let e=i[n[t]];e||(e=i[n[t]]={}),i=e}i[n[n.length-1]]=t}}}return t}getEntriesForKey(e,t,n){let s;if(this.canCallSettingsEndpoint){const i=this.pageContext.getService("IVssContributionService").getSharedData("_settings");if(i){let r=this.userScopeToString(e);t&&(r+=";"+t+";"+(n||"")),s=i[r]}}return s}}})}(),function(e){function n(e,t){if(e.contains(t))return!0;const n=e.getAttribute("aria-owns");if(n&&s(n,t))return!0;const i=e.querySelectorAll("[aria-owns]");for(let e=0;e<i.length;e++){if(s(i[e].getAttribute("aria-owns"),t))return!0}return!1}function s(e,t){const s=document.querySelector("[id='"+e+"']");return!(!s||!n(s,t))}t.UtilDOM={},Object.defineProperty(t,"__esModule",{value:!0}),t.UtilDOM.contains=n}(),function(e){t.UtilLinking={},Object.defineProperty(t,"__esModule",{value:!0});const n="vstfs:///",s="/";function i(e){let t;return t=e.replace(/\+/g," "),t=decodeURIComponent(t)}t.UtilLinking.encodeUri=function(e){return n+[encodeURIComponent(e.tool),encodeURIComponent(e.type),encodeURIComponent(e.id)].join(s)},t.UtilLinking.decodeUri=function(e){let t,r;if(e.length>n.length&&(t=e.substr(0,n.length).toLowerCase())===n&&(r=e.substr(n.length).split(s)).length>=3){const t=r[0],n=r[1],s=r.slice(2).join("/");return{uri:e,tool:i(t),type:i(n),id:i(s)}}throw new Error(`Invalid artifact uri: ${e}`)}}(),function(e){t.UtilNumber={},Object.defineProperty(t,"__esModule",{value:!0}),t.UtilNumber.parseFloatLocale=function(e,t=navigator.language){const n=Intl.NumberFormat(t).format(1.1)[1],s=Intl.NumberFormat(t).format(1e3)[1];let i,r;const o=(e=e.trim()).indexOf(n);o<0?(i=e,r=null):(i=e.substr(0,o),r=e.substr(o+1));const a=(i=i.split(s).join(""))+(r?"."+r:"");return a.match(/^[+-]?\d*\.?\d*$/)?parseFloat(a):Number.NaN}}()},["Resources","Context","Util/Cookie","Fetch","Util/Serialization","Util/Url","RestClientBase","RestClient/Authentication","Authentication","Content","RestClient/WebContributions","Util/Object","Contribution","Page","RestClient/CustomerIntelligence","Util/Array","Util/Storage","Telemetry","Theming","Performance","Layout","Navigation","RestClient/ClientTrace","Trace","Components/ErrorBoundary/ErrorBoundary","Components/ErrorBoundary","Components/Format/Format","Components/Format","Components/Layout/Layout","Components/Layout","History","FPS","Components/FPSLink/FPSLink","Components/FPSLink","Fallback","Feature","Identity","KeyboardShortcuts","Location","UserClaims","RestClientOptionsProvider","RestClient/Contributions","RestClient/Locations","RestClient/Settings","Search","Security","Settings","Util/DOM","Util/Linking","Util/Number"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-web.platform-content"}}));