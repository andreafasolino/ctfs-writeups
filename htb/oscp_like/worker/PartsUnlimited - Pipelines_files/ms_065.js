"use strict";define("VSSUI",["require","exports","react","OfficeFabric/Utilities","OfficeFabric/ContextualMenu","OfficeFabric/FocusZone","OfficeFabric/Icon","OfficeFabric/Slider","OfficeFabric/Toggle","OfficeFabric/CommandBar","OfficeFabric/Callout","OfficeFabric/Button","OfficeFabric/Link","OfficeFabric/ResizeGroup","VSS/Core/Util/Object","VSS/Core/Observable","OfficeFabric/Dropdown","OfficeFabric/Fabric","VSS/Platform/Layout"],function(e,t,i,s,o,r,n,a,c,l,d,m,p,h,u,v,b,P,_){var g,f,I,B,k,y,C,w,S,x,O,E,A,V,T,L;!function(e){g=t.ComponentsPivotBarPivotBarItem={},Object.defineProperty(t,"__esModule",{value:!0});t.ComponentsPivotBarPivotBarItem.PivotBarItem=class extends s.BaseComponent{render(){return i.createElement("div",Object.assign({},s.getNativeProps(this.props,s.divProperties),{className:t.Util.css("vss-PivotBarItem",this.props.className)}),this.props.children)}}}(),function(e){f=t.ComponentsPivotBarPivotBarAction={},Object.defineProperty(t,"__esModule",{value:!0});const l="vss-PivotBar--commandBar-item";var d,m;function p(e,i,s,o){let r=[];for(let t of e||[]){const e=m.getInstance(i,t.actionType||0);r=r.concat(e.getVisualization(t,s,o))}return r.forEach(e=>{e.className=t.Util.css(e.className,l)}),r}function h(e,t,i,s,o){e?e.setViewOption(t,i):"function"==typeof o.onClick&&o.onClick(s,o)}!function(e){e[e.Bar=0]="Bar",e[e.Overflow=1]="Overflow"}(d||(d={})),t.ComponentsPivotBarPivotBarAction.mapActionsToItems=function(e,t,i){return p(e,d.Bar,t,i)},t.ComponentsPivotBarPivotBarAction.mapItemToActions=function e(t){const i=t.iconProps.iconType,s=i===n.IconType.default||i===n.IconType.Default?0:3,r={key:t.key,name:t.name,href:t.href,title:t.title,iconProps:Object.assign({},t.iconProps,{iconType:s}),onClick:t.onClick,disabled:t.disabled,important:t.important,target:t.target,separator:t.itemType===o.ContextualMenuItemType.Divider};return t.items&&(r.children=t.items.map(e)),r},function(e){const t={};function i(e,t){return`${e}:${t}`}e.register=function(e,s,o){const r=i(e,s);t[r]=o},e.getInstance=function(e,s){const o=i(e,s);let r=t[o];if(!r)throw new Error(`No visualization found for area ${e} and action type ${s}`);return new r}}(m||(m={}));class u{getVisualization(e,i){const s={key:e.key,name:e.name||"",ariaLabel:e.ariaLabel,className:e.actionProps&&e.actionProps.className,title:e.title,onClick:e.onClick,href:e.href,disabled:e.disabled,target:e.target,itemType:e.separator?o.ContextualMenuItemType.Divider:o.ContextualMenuItemType.Normal};if(e.iconProps){const i=Object.assign({},e.iconProps);i.className=t.Util.css(i.className,"vss-PivotBar--commandBar-icon"),s.iconProps=t.VssIcon.VssIcon.getIconProps(i)}const r=e.actionProps;return r&&r.showChevron&&(s.subMenuProps={items:[]}),Array.isArray(e.children)&&(s.subMenuProps={className:"vss-PivotBar--commandBar-overflow",items:p(e.children,d.Overflow,i)}),[s]}}m.register(d.Bar,0,u),m.register(d.Overflow,0,u);class v{getVisualization(e,t){return[]}getActionProps(e){return e.actionProps||(e.actionProps={on:!1}),e.actionProps}isOn(e,t){return!!t&&!0===t.getViewOption(e)}}m.register(d.Bar,1,class extends v{getVisualization(e,s,o){const r=this.getActionProps(e),n=this.isOn(e.key,s),a=n?t.VSSResourcesVSSUI.PivotBarViewActionOnText:t.VSSResourcesVSSUI.PivotBarViewActionOffText;let c;!1!==r.showText&&(c=a);let l=n?r.onAriaLabel:r.offAriaLabel,d=e.title;void 0===l&&(l=void 0!==d?d:a),void 0===d&&(d=void 0!==l?l:a);let m=n?r.onIconProps:r.offIconProps;return m||(m=e.iconProps),[{key:e.key,onRender:(a,p,u,v)=>{const b=i.createElement(t.Button.Button,{subtle:!0,className:t.Util.css("vss-PivotBar--commandBar-toggle","pivotBar-toggle-button",r.className),text:c,ariaSetSize:v,ariaPosInSet:u,ariaChecked:n,disabled:e.disabled,iconProps:t.VssIcon.VssIcon.getIconProps(m,"vss-PivotBar--commandBar-icon"),onClick:t=>{h(s,a.key,!this.isOn(a.key,s),t,e),o&&o()},ariaLabel:l,role:"switch",tooltipProps:d?{showOnFocus:!0,text:d}:void 0});return d?i.createElement(t.TooltipEx.Tooltip,{text:d},i.createElement("span",{className:"vss-PivotBar-commandBar-toggle-host"},b)):b}}]}});m.register(d.Overflow,1,class extends v{getVisualization(e,s){const r=this.getActionProps(e);let n=[];const a=r.onText||t.VSSResourcesVSSUI.PivotBarViewActionOnText,l=r.offText||t.VSSResourcesVSSUI.PivotBarViewActionOffText,d=r.onAriaLabel||(e.ariaLabel?e.ariaLabel+" "+a:null),m=r.offAriaLabel||(e.ariaLabel?e.ariaLabel+" "+l:null),p={key:e.key,onRender:o=>{const n=i.createElement(c.Toggle,{key:`${e.key}-toggle`,className:t.Util.css("vss-PivotBar--commandBar-toggle",r.className),styles:{root:{paddingLeft:8,marginTop:4},container:{alignItems:"center"},pill:{fontSize:"15px"}},checked:this.isOn(e.key,s),disabled:e.disabled,onText:a,offText:l,onAriaLabel:d,offAriaLabel:m,onChanged:t=>{h(s,o.key,t,null,e)}});return e.title?i.createElement(t.Tooltip.TooltipHost,{content:e.title,key:`${e.key}-toggle-tooltip`},n):n}};return e.name?n.push({key:e.key,sectionProps:{items:[p],title:e.name,key:`${e.key}-section`},itemType:o.ContextualMenuItemType.Section}):n.push(p),n}});class b{getVisualization(e,t){return[]}getActionProps(e){if(!e.actionProps)throw new Error(`Options must be specified for the choice group ${e.key}`);return e.actionProps}getSelectedOption(e,t,i){const s=(i?i.getViewOption(e):null)||t.defaultSelectedKey;return t.options.filter(e=>e.key===s)[0]||t.options[0]}}class P extends s.BaseComponent{constructor(e){super(e),this._onCycleClick=(e=>{this._changeOption(e,this._getNextOptionIndex(this.props.options))}),this._onOptionClick=((e,t)=>{e.stopPropagation(),this._changeOption(e,s.findIndex(this.props.options,e=>e.key===t.key))}),this._onDropClick=(e=>{this.setState({showDropdown:!0,dropTarget:e.currentTarget})}),this._onDismiss=(e=>{this.setState({showDropdown:!1})}),this.state={showDropdown:!1,selectedOptionIndex:this._getSelectedOptionIndex(this.props.options,this.props.defaultSelectedKey)}}componentWillReceiveProps(e){this.setState({showDropdown:!1,selectedOptionIndex:this._getSelectedOptionIndex(e.options,e.defaultSelectedKey)})}render(){const{dropButtonClassName:e,ariaLabel:s,dropButtonAriaLabel:r,options:n}=this.props,{selectedOptionIndex:a,showDropdown:c,dropTarget:l}=this.state,d=n[a];return i.createElement("div",{className:"vss-ChoiceGroupButton"},i.createElement(t.Button.Button,{subtle:!0,ariaLabel:s||r||t.VSSResourcesVSSUI.PivotBarMoreOptionsAriaLabel,role:"listbox","aria-expanded":c,"aria-haspopup":!0,className:t.Util.css("vss-ChoiceGroupButton--drop",e),text:d.text,onClick:this._onDropClick},t.Icon.Icon({iconName:"ChevronDown",className:"pivotBar-choice-group-icon"})),c?i.createElement(o.ContextualMenu,{shouldFocusOnMount:!0,isBeakVisible:!1,target:l,onDismiss:this._onDismiss,directionalHint:6,items:n.map(e=>({key:e.key,name:e.text,ariaLabel:e.ariaLabel,isChecked:e===d,canCheck:!0,onClick:this._onOptionClick}))}):null)}_getSelectedOptionIndex(e,t=null){const i=t?s.findIndex(e,e=>e.key===t):-1;return Math.max(i,0)}_getNextOptionIndex(e){let t=this.state.selectedOptionIndex+1;return t===e.length&&(t=0),t}_changeOption(e,t){const{onChange:i,options:s}=this.props;this.setState({selectedOptionIndex:t}),i&&i(e,s[t])}}m.register(d.Bar,2,class extends b{getVisualization(e,s){const o=this.getActionProps(e),r=this.getSelectedOption(e.key,o,s);return[{key:e.key,className:t.Util.css("vss-PivotBar--commandBar-barChoiceGroup",o.className),onRender:(t,n,a,c)=>i.createElement(P,{ariaLabel:t.ariaLabel,"aria-setsize":c,"aria-posinset":a,dropButtonAriaLabel:o.dropButtonAriaLabel,defaultSelectedKey:r.key,options:o.options,dropButtonClassName:"vss-PivotBar--commandBar-barChoiceDrop",onChange:(t,i)=>{h(s,e.key,i.key,t,e)}})}]}});m.register(d.Overflow,2,class extends b{getVisualization(e,t){const i=this.getActionProps(e),s=this.getSelectedOption(e.key,i,t);let r=[];e.name&&r.push({key:`${e.key}-header`,name:e.name,itemType:o.ContextualMenuItemType.Header});for(let o of i.options)r.push({key:o.key,name:o.text,ariaLabel:o.ariaLabel,isChecked:o===s,canCheck:!0,title:o.title,onClick:(i,s)=>{h(t,e.key,s.key,i,e),t&&i&&i.preventDefault()}});return r}});class _{getActionProps(e){const t=e.actionProps;if(!t||!t.text)throw new Error(`Text must be specified through actionProps for ${e.key}`);return t}getVisualization(e,s){const o=this.getActionProps(e);return[{key:e.key,className:"vss-PivotBar--commandBar-text",onRender:s=>{const r=i.createElement(t.Dynamic.DynamicText,{className:o.className,key:`${e.key}-text`,text:o.text});return e.title?i.createElement(t.TooltipEx.Tooltip,{text:e.title,key:`${e.key}-tooltip`},i.createElement("span",null,r)):r}}]}}m.register(d.Bar,3,_),m.register(d.Overflow,3,_);class g extends s.BaseComponent{constructor(){super(...arguments),this._onOuterKeyDown=(e=>{13===e.which&&this._innerFocus&&(this._innerFocus.focus(),e.preventDefault(),e.stopPropagation())}),this._onInnerKeyDown=(e=>{27===e.which&&this._outerFocus&&(this._outerFocus.focus(),e.preventDefault(),e.stopPropagation())})}render(){return i.createElement(t.TooltipEx.Tooltip,{text:this.props.title},i.createElement("div",{ref:e=>this._outerFocus=e,onKeyDown:this._onOuterKeyDown,"data-is-focusable":!0,className:"vss-PivotBarSlider"},i.createElement(r.FocusZone,{componentRef:e=>this._innerFocus=e,onKeyDown:this._onInnerKeyDown,direction:r.FocusZoneDirection.horizontal},i.createElement(a.Slider,Object.assign({},this.props)))))}}class I{getActionProps(e){return e.actionProps||(e.actionProps={}),e.actionProps}getValue(e,t){return t&&t.getViewOption(e)||0}get useLabel(){return!0}getVisualization(e,s){const o=this.getActionProps(e),r=this.getValue(e.key,s);return[{key:e.key,className:"vss-PivotBar--commandBar-barSlider",onRender:(n,a,c,l)=>i.createElement(g,{key:`${e.key}-slider`,className:t.Util.css("vss-PivotBar--commandBar-slider",o.className),label:this.useLabel?e.name:void 0,value:r,min:o.minValue,max:o.maxValue,step:o.step,ariaLabel:e.ariaLabel,"aria-setsize":l,"aria-posinset":c,title:e.title,showValue:!1,disabled:e.disabled,onChange:t=>{h(s,e.key,t,null,e)}})}]}}m.register(d.Bar,4,class extends I{});m.register(d.Overflow,4,class extends I{get useLabel(){return!1}getVisualization(e,t){const i=super.getVisualization(e,t);return e.name&&i.unshift({key:`${e.key}-header`,name:e.name,itemType:o.ContextualMenuItemType.Header}),i}})}(),function(e){I=t.ComponentsPivotBarPivotCommandBar={},Object.defineProperty(t,"__esModule",{value:!0});t.ComponentsPivotBarPivotCommandBar.PivotCommandBar=class extends s.BaseComponent{constructor(e){super(e),this._onCommandsChanged=(()=>{this.setState({commands:this._getCommands(this.props)})}),this._onViewActionsChanged=(()=>{this.setState({viewActions:this._getViewActions(this.props)})}),this._forceUpdate=(()=>{this.forceUpdate()}),this.state={commands:this._getCommands(this.props),viewActions:this._getViewActions(this.props)}}componentWillReceiveProps(e){let i=!1;t.Util.arrayEquals(this.props.commands,e.commands)||(this._unsubscribeItems(this.props.commands,this._onCommandsChanged),this._subscribeItems(e.commands,this._onCommandsChanged),i=!0),t.Util.arrayEquals(this.props.viewActions,e.viewActions)||(this._unsubscribeItems(this.props.viewActions,this._onViewActionsChanged),this._subscribeItems(e.viewActions,this._onViewActionsChanged),i=!0),this.props.showFilterAction===e.showFilterAction&&this.props.filterBar===e.filterBar||(i=!0),i&&this.setState({commands:this._getCommands(e),viewActions:this._getViewActions(e)})}componentDidMount(){this._subscribeItems(this.props.commands,this._onCommandsChanged),this._subscribeItems(this.props.viewActions,this._onViewActionsChanged)}componentWillUnmount(){this._unsubscribeItems(this.props.commands,this._onCommandsChanged),this._unsubscribeItems(this.props.viewActions,this._onViewActionsChanged)}render(){const{className:e,viewOptions:s,filterBar:o,hasAppliedFilter:r,showFilterAction:n,onShowFilterBarClicked:a,showFilterBarViewOptionKey:c,prependSeparator:d,role:m,ariaLabel:p,commandsMenuBarAriaLabel:h}=this.props,{commands:u,viewActions:v}=this.state;let b=[],P=[];if(u&&u.length){const e=u.filter(e=>e.important),t=u.filter(e=>!e.important);b=f.mapActionsToItems(e,s,this._forceUpdate),P=f.mapActionsToItems(t,s,this._forceUpdate)}const _=[];if(v&&v.length){_.push(...v.filter(e=>e.important&&1===e.viewActionRenderArea));const e=v.filter(e=>!e.important);e.length&&_.push({key:"viewOptions",title:t.VSSResourcesVSSUI.PivotBarViewOptionsText,ariaLabel:t.VSSResourcesVSSUI.PivotBarViewOptionsText,actionProps:{className:"vss-PivotBar--viewOptionsMenu"},important:!0,actionType:0,iconProps:{iconName:"Equalizer"},children:e}),_.push(...v.filter(e=>e.important&&1!==e.viewActionRenderArea&&2!==e.viewActionRenderArea))}n&&!o&&_.push({key:c,important:!0,actionType:1,actionProps:{showText:!1,onAriaLabel:t.VSSResourcesVSSUI.PivotBarFilterActionTextHide,offAriaLabel:t.VSSResourcesVSSUI.PivotBarFilterActionTextShow,onIconProps:{iconName:r?"FilterSolid":"Filter"},offIconProps:{iconName:r?"FilterSolid":"Filter"}},onClick:a}),v&&v.length&&_.push(...v.filter(e=>e.important&&2===e.viewActionRenderArea));const g=f.mapActionsToItems(_,s,this._forceUpdate);return o&&g.unshift({className:"vss-PivotBar--inlineFilterBar",key:"filterBar",onRender:()=>o}),b.length||P.length||g.length?i.createElement("div",{className:"vss-PivotBar--right",role:m,"aria-label":p},!(!d||!b.length&&!P.length)&&i.createElement("div",{className:"vss-PivotBar--separator"}),i.createElement(l.CommandBar,{componentRef:e=>{this._commandBar=e},className:t.Util.css(e),items:b,overflowItems:P,farItems:g,elipisisAriaLabel:t.VSSResourcesVSSUI.PivotBarMoreCommandsAriaLabel,ariaLabel:h})):null}focus(){this._commandBar&&this._commandBar.focus()}_subscribeItems(e,t){(e||[]).forEach(e=>e.subscribe(t))}_unsubscribeItems(e,t){(e||[]).forEach(e=>e.unsubscribe(t))}_getCommands(e){const t=[],i=e.commands||[];for(const e of i)t.push(...e.value);return t}_getViewActions(e){const t=[],i=e.viewActions||[];for(const e of i)t.push(...e.value);return t}}}(),function(e){B=t.ComponentsVssBreadcrumbVssBreadcrumb={},Object.defineProperty(t,"__esModule",{value:!0});const o=4;class n extends s.BaseComponent{constructor(e){super(e),this._onPositioned=(()=>{this._pickList.focus()}),this._onDismiss=(()=>{this.closeDropdown()}),this.state={calloutIsVisible:!1,itemPicker:e.item.itemPicker,events:this._events,updateDelegate:()=>this.forceUpdate()}}render(){const{getPinElement:e,item:s,width:o,minWidth:r,maxWidth:n,maxHeight:a,pickListClassName:c}=this.props;if(this.state.calloutIsVisible){const l=s.itemPicker;return i.createElement(d.Callout,{isBeakVisible:!1,target:e(),onPositioned:this._onPositioned,onDismiss:this._onDismiss},i.createElement(t.PickList.PickList,{className:t.Util.css("picker-dropdown",c),ref:e=>this._pickList=e,getActions:()=>l.actions,getListItem:l.getListItem,groups:l.groups,pivots:l.pivots,indicators:l.dropdownIndicators,initiallySelectedItems:l.selectedItem?[l.selectedItem]:void 0,isSearchable:l.isSearchable,items:l.getItems(),searchResultsLoadingText:l.searchResultsLoadingText,noItemsText:l.noItemsText,itemAriaDescription:l.itemAriaDescription,searchNoResultsText:l.searchNoResultsText,searchResultsGroupName:l.searchResultsGroupName,searchTextPlaceholder:l.searchTextPlaceholder,shouldVirtualize:e=>(e||[]).length>50,width:o,minWidth:r,maxWidth:n,maxHeight:a,onFocusLost:this._onDismiss,onSearch:l.onSearch,onSelectionChanged:s.onSelectionChanged,onRenderItemText:l.onRenderItemText,onSelectedPivotChanged:l.onSelectedPivotChanged}))}return null}componentDidMount(){this.props.item.isHeaderPickerItem&&this.props.item.itemPicker&&(this.props.item.itemPicker,this._events.on(this.props.item.itemPicker,t.PickList.PICKER_CHANGE_EVENT,this.state.updateDelegate))}componentWillUnmount(){this.props.item.isHeaderPickerItem&&this.props.item.itemPicker&&this._events.off(this.props.item.itemPicker,t.PickList.PICKER_CHANGE_EVENT,this.state.updateDelegate)}componentWillReceiveProps(e){this.props.item.isHeaderPickerItem&&this.props.item.itemPicker&&this.props.item.itemPicker!==e.item.itemPicker&&(this._events.off(this.props.item.itemPicker,t.PickList.PICKER_CHANGE_EVENT,this.state.updateDelegate),this._events.on(e.item.itemPicker,t.PickList.PICKER_CHANGE_EVENT,this.state.updateDelegate))}openDropdown(){this.props.onPickListOpened&&this.props.onPickListOpened(),this.setState({calloutIsVisible:!0})}closeDropdown(){this.setState({calloutIsVisible:!1}),this.props.onPickListClosed&&this.props.onPickListClosed()}toggleDropdown(){this.state.calloutIsVisible?this.closeDropdown():this.openDropdown()}}class a extends i.Component{constructor(e){super(e),this._pinElements={},this._linkElements={},this._breadcrumbElements={},this._focusedLinkIndex=-1,this._onItemClick=(e=>{this.setState({pickerItemKey:e.key},()=>{this.pickList&&this.pickList.toggleDropdown()})}),this.onRenderItem=((e,s)=>{const{presentationStyles:o,shouldUseFocusZone:r}=this.props,{pickerItemKey:n}=this.state,a=Object.assign({},e);delete a.onClick,delete a.href;const c=this._getIcon(e.leftIconProps),l=s(a),d=l.props&&l.props.className;let m=1&o?"vss-Breadcrumb--itemText-small":"vss-Breadcrumb--itemText vss-HubBreadcrumb--itemText";m=t.Util.css(m,"ellipsis-text",!!(2&o)&&"vss-Breadcrumb--light");const h=Object.assign({},l.props,{className:t.Util.css(d,m),style:l.props.style?Object.assign({},l.props.style):{}});this.props.maxItemWidth&&(h.style.maxWidth=this.props.maxItemWidth);const v=i.cloneElement(l,h),b=r?0:-2,P=u.getId("vss-breadcrumb-item-described-by");if(e.isHeaderPickerItem&&e.itemPicker){const s=!e.nonInteractive&&!!(8&o);let a;return e.nonInteractive||(a=this._onItemClick.bind(this,e)),i.createElement("div",{ref:t=>{t&&(this._pinElements[e.key]=t,this._breadcrumbElements[e.key]=t)},className:t.Util.css("vss-Breadcrumb--item vss-HubBreadcrumb--item",!a&&"no-click",!!(16&o)&&"vss-Breadcrumb--item-min-height")},i.createElement(p.Link,{key:"BreadcrumbItem$"+e.key,componentRef:t=>{t&&(this._linkElements[e.key]=t)},onClick:a,href:e.href,"aria-haspopup":!0,"aria-expanded":this.state.pickerIsOpen,"aria-label":e.ariaLabel,"aria-describedby":t.Util.getSafeId(P),tabIndex:b,onFocus:r?void 0:this._onLinkFocus.bind(this,e.key)},i.createElement("div",{className:"vss-Breadcrumb--itemContainer vss-HubBreadcrumb--itemContainer"},c,i.createElement(t.TooltipEx.Tooltip,{overflowOnly:!0,text:e.text},v),s&&this._getBreadcrumbIcon(e)),i.createElement("div",{id:t.Util.getSafeId(P),className:"vss-Breadcrumb--hiddenElement"},e.ariaDescription)),n&&n===e.key&&this._renderPickerDropdown(e),this._getIndicators(e))}return e.onClick||e.href?i.createElement("div",{ref:t=>{t&&(this._breadcrumbElements[e.key]=t)},className:t.Util.css("vss-Breadcrumb--item vss-HubBreadcrumb--item",!!(16&o)&&"vss-Breadcrumb--item-min-height")},i.createElement(p.Link,{componentRef:t=>{t&&(this._linkElements[e.key]=t)},key:"BreadcrumbItem$"+e.key,onClick:e.onClick,href:e.href,"aria-label":e.ariaLabel,"aria-describedby":t.Util.getSafeId(P),tabIndex:b,onFocus:r?void 0:this._onLinkFocus.bind(this,e.key)},i.createElement("div",{className:"vss-Breadcrumb--itemContainer"},c,v),i.createElement("div",{id:t.Util.getSafeId(P),className:"vss-Breadcrumb--hiddenElement"},e.ariaDescription))):i.createElement("div",{ref:t=>{t&&(this._breadcrumbElements[e.key]=t)},className:t.Util.css("vss-Breadcrumb--item vss-HubBreadcrumb--item",!!(16&o)&&"vss-Breadcrumb--item-min-height"),"aria-label":e.ariaLabel},c,v)}),this._onLinkFocus=(e=>{this._focusedLinkIndex<0&&(this._focusedLinkIndex=s.findIndex(this.state.linkItems,t=>t.key===e))}),this._getCustomDivider=(e=>{const s=e.item,{presentationStyles:o}=this.props;return void 0===o||8&o?i.createElement("div",{key:"BreadcrumbItemDivider$"+s.key,className:"vss-Breadcrumb--divider-container",ref:e=>{e&&(this._pinElements[s.key]=e,this._breadcrumbElements["BreadcrumbItemDivider$"+s.key]=e)}},this._getDividerButtonOrIcon(s)):i.createElement("div",{ref:e=>{e&&(this._breadcrumbElements["BreadcrumbItemDivider$"+s.key]=e)},key:"BreadcrumbItemDivider$"+s.key,className:t.Util.css("vss-Breadcrumb--divider vss-HubBreadcrumb--divider",!!(4&o)&&"vss-Breadcrumb--divider-extra-padding",!!(2&o)&&"vss-Breadcrumb--divider-light")},this._getBreadcrumbIcon(s))}),this._onKeyDown=(e=>{const{linkItems:t}=this.state;37===e.which&&this._focusedLinkIndex>0&&(this.props.extraContentSelected&&this.props.onExtraContentSelectionChanged(!1),this._linkElements[t[--this._focusedLinkIndex].key].focus(),e.preventDefault()),39===e.which&&this._focusedLinkIndex>=0&&(this._focusedLinkIndex<t.length-1?(this._linkElements[t[++this._focusedLinkIndex].key].focus(),e.preventDefault()):this._focusedLinkIndex===t.length-1&&this._isExtraContentSelectable()&&this.props.onExtraContentSelectionChanged?(this.props.onExtraContentSelectionChanged(!0),this._focusedLinkIndex++,e.preventDefault()):this.props.extraContentSelected&&this.props.onExtraContentSelectionChanged(!1)),40===e.which&&this._focusedLinkIndex>=0&&!this.props.extraContentSelected&&this._onItemClick(t[this._focusedLinkIndex])}),this._onBlur=(()=>{this.state.pickerIsOpen||this.props.extraContentSelected||(this._focusedLinkIndex=-1)}),this._dataDidRender=(e=>{const{dataDidRender:t}=this.props;if(t){let i=0;Object.keys(this._breadcrumbElements).map((e,t)=>{i+=this._breadcrumbElements[e].clientWidth}),t(e,i)}});const o=a._arrangeItems(e.items);this.state={pickerIsOpen:!1,pickerItemKey:null,displayedItems:o,linkItems:a._getLinkItems(o)}}static getDerivedStateFromProps(e,t){const i=a._arrangeItems(e.items);return Object.assign({},t,{displayedItems:i,linkItems:a._getLinkItems(i)})}componentDidUpdate(e){!e.extraContentSelected&&this.props.extraContentSelected?this._focusedLinkIndex=this.state.linkItems.length:e.extraContentSelected&&!this.props.extraContentSelected&&this._focusedLinkIndex===this.state.linkItems.length&&(this._focusedLinkIndex=-1)}static _getLinkItems(e){return e.filter(e=>e.isHeaderPickerItem&&e.itemPicker||e.href||e.onClick)}_getIcon(e){return e?i.createElement(t.VssIcon.VssIcon,Object.assign({},e,{className:t.Util.css("vss-Breadcrumb--item-leftIcon vss-HubBreadcrumb--item-leftIcon",e.className)})):null}_renderPickerDropdown(e){const{pickListClassName:t,pickListWidth:s,pickListMinWidth:o,pickListMaxWidth:r,pickListMaxHeight:a}=this.props,c=e.pickerWidth||s||o||this._pinElements[e.key]&&this._pinElements[e.key].clientWidth,l=!r,d=e.pickListClassName||t;return i.createElement(n,{ref:e=>{this.pickList=e},item:e,getPinElement:()=>this._pinElements[e.key],width:l&&c,minWidth:!l&&c,maxWidth:r,maxHeight:a,pickListClassName:d,onPickListClosed:()=>this.setState({pickerIsOpen:!1}),onPickListOpened:()=>this.setState({pickerIsOpen:!0})})}_getBreadcrumbIcon(e){const{pickerItemKey:s}=this.state,{dividerType:o}=this.props;return 1===o?i.createElement("div",{className:"vss-Breadcrumb--forward-slash"},"/"):i.createElement(t.VssIcon.VssIcon,{iconName:e.isHeaderPickerItem||e.key===s&&this.state.pickerIsOpen?"ChevronDown":"ChevronRight",iconType:0,key:"RightIcon$"+e.key,className:t.Util.css("vss-Breadcrumb--item-dropdown vss-HubBreadcrumb--item-dropdown",e.isHeaderPickerItem&&"vss-Breadcrumb--item-dropdown-with-picker vss-HubBreadcrumb--item-dropdown-with-picker")})}_getDividerButtonOrIcon(e){const{pickerItemKey:s}=this.state,o=this._getBreadcrumbIcon(e);return e.itemPicker?i.createElement(p.Link,{onClick:this._onItemClick.bind(this,e),"aria-expanded":this.state.pickerIsOpen,className:t.Util.css("vss-Breadcrumb--divider vss-Breadcrumb--divider-link")},o,s&&s===e.key&&e.itemPicker&&this._renderPickerDropdown(e)):o}_getIndicators(e){const s=e.isHeaderPickerItem&&e.itemPicker;return s&&s.selectedItem&&s.selectedItemIndicators&&s.selectedItemIndicators.length?i.createElement(t.ItemIndicator.ItemIndicatorSet,{indicators:s.selectedItemIndicators.map(e=>e.getItemIndicator(s.selectedItem))}):null}static _arrangeItems(e){const t={};e.forEach(e=>{(!t[e.key]||(t[e.key].priority||0)<=(e.priority||0))&&(t[e.key]=e)});const i=[];return Object.keys(t).forEach(e=>{i.push(t[e])}),i.some(e=>e.rank>=0)&&i.sort((e,t)=>{return(e.rank||Number.MAX_VALUE)-(t.rank||Number.MAX_VALUE)}),i}_isExtraContentSelectable(){const e=document.getElementById(t.Util.getSafeIdSelector("breadcrumb-extra-content"));return!!e&&!!e.querySelector('[tabindex="-2"]')}render(){const{ariaLabel:e,className:s,maxDisplayedItems:r=o,onReduceData:n,overflowIndex:a,shouldUseFocusZone:c,extraContent:l}=this.props;return i.createElement("div",{className:t.Util.css("vss-Breadcrumb--container vss-HubBreadcrumb--container",s),onKeyDown:c?void 0:this._onKeyDown,onBlur:c?void 0:this._onBlur},i.createElement(v,{onReduceData:n||(e=>void 0),dataDidRender:this._dataDidRender,items:this.state.displayedItems,className:t.Util.css("vss-Breadcrumb vss-HubBreadcrumb"),onRenderItem:this.onRenderItem,ariaLabel:e||t.VSSResourcesVSSUI.BreadcrumbAriaLabel,maxDisplayedItems:r,overflowIndex:a,dividerAs:this._getCustomDivider,shouldUseFocusZone:c,extraContent:l}))}}a.defaultProps={items:[]},t.ComponentsVssBreadcrumbVssBreadcrumb.VssBreadcrumb=a;const c="overflow",l=()=>null;class v extends i.Component{constructor(e){super(e),this._focusZone=s.createRef(),this._onRenderBreadcrumb=(e=>{const{ariaLabel:s,dividerAs:o=t.Icon.Icon,onRenderItem:n=this._onRenderItem,overflowAriaLabel:a,overflowIndex:d,className:p,shouldUseFocusZone:h,extraContent:u}=e.props,{renderedOverflowItems:v,renderedItems:b}=e,P=v.map((e,t)=>({name:e.text,key:e.key,onClick:e.onClick?this._onBreadcrumbClicked.bind(this,e):null,href:e.href})),_=b.length-1,g=v&&0!==v.length,f=b.map((e,t)=>i.createElement("li",{className:"internal-breadcrumb--listItem",key:e.key||String(t)},n(e,this._onRenderItem),(t!==_||g&&t===d-1)&&i.createElement(o,{className:"internal-breadcrumb--chevron",iconName:"ChevronRight",item:e})));g&&f.splice(d,0,i.createElement("li",{className:"internal-breadcrumb--overflow",key:c},i.createElement(m.IconButton,{className:"internal-breadcrumb--overflowButton",iconProps:{iconName:"More"},role:"button","aria-haspopup":"true",ariaLabel:a,onRenderMenuIcon:l,menuProps:{items:P,directionalHint:4}}),d!==_+1&&i.createElement(o,{className:"internal-breadcrumb--chevron",iconName:"ChevronRight",item:v[v.length-1]}))),u&&f.push(i.createElement("li",{key:"breadcrumb-extra-content",id:t.Util.getSafeId("breadcrumb-extra-content")},u));let I=i.createElement("ol",{className:"internal-breadcrumb--list"},f);return h&&(I=i.createElement(r.FocusZone,{componentRef:this._focusZone,direction:r.FocusZoneDirection.horizontal},I)),i.createElement("div",{className:p,role:"navigation","aria-label":s},I)}),this._onRenderItem=(e=>i.createElement("span",{className:"internal-breadcrumb--item"},e.text)),this._onBreadcrumbClicked=((e,t)=>{e.onClick&&e.onClick(t,e)}),v._validateProps(e),this.state={}}render(){const{onReduceData:e,dataDidRender:t,overflowIndex:s,maxDisplayedItems:o,items:r}=this.props,n=[...r],a=n.splice(s,n.length-o),c={props:this.props,renderedItems:n,renderedOverflowItems:a};return i.createElement(h.ResizeGroup,{onRenderData:this._onRenderBreadcrumb,onReduceData:e,dataDidRender:t,data:c,className:"vss-Breadcrumb--resizeGroup"})}static getDerivedStateFromProps(e,t){return v._validateProps(e),t}static _validateProps(e){const{maxDisplayedItems:t,overflowIndex:i,items:s}=e;if(i<0||t>1&&i>t-1||s.length>0&&i>s.length-1)throw new Error("Breadcrumb: overflowIndex out of range")}}v.defaultProps={items:[],maxDisplayedItems:999,overflowIndex:0}}(),function(e){k=t.ComponentsHubHeaderHubTitle={},Object.defineProperty(t,"__esModule",{value:!0});t.ComponentsHubHeaderHubTitle.HubTitle=class extends s.BaseComponent{constructor(e){super(e)}getIcon(){if(this.props.iconProps){const e=Object.assign({},this.props.iconProps,{className:t.Util.css(this.props.iconProps.className,"vss-HubTitle-titleIcon")});return i.createElement(t.VssIcon.VssIcon,Object.assign({},e))}return null}getTitleText(){return i.createElement("div",{className:"vss-HubTitle--titleText"},this.props.titleText)}render(){const e=t.Util.css("vss-HubTitle");return i.createElement("h1",{className:e,onClick:this.props.onClick},this.getIcon(),this.getTitleText())}}}(),function(e){y=t.ComponentsHubHeaderHubHeader={},Object.defineProperty(t,"__esModule",{value:!0});const o="340px";t.ComponentsHubHeaderHubHeader.HubHeader=class extends s.BaseComponent{constructor(e){super(e),this.dataDidRender=((e,t)=>{const{breadcrumbProps:i,breadcrumbDataDidRender:s}=this.props,{canBreadcrumbShrink:o}=this.state;if(i&&i.onReduceData){const t=i.onReduceData(e);void 0===t&&o?this.setState({canBreadcrumbShrink:!1}):void 0===t||o||this.setState({canBreadcrumbShrink:!0})}s&&s(e,t)}),this.onSelectionChanged=(e=>{const{headerItemPicker:t}=this.state;let i=!1;return t&&t.onSelectedItemChanged&&(i=!0===t.onSelectedItemChanged(e.selectedItems&&e.selectedItems.length>0?e.selectedItems[0]:null),this._hubBreadcrumb&&this._hubBreadcrumb.pickList&&this._hubBreadcrumb.pickList.closeDropdown()),i}),this.onHeaderPickerChanged=(e=>{this.setState({headerItemPicker:e})}),this.state={headerItemPicker:v.ObservableLike.getValue(this.props.headerItemPicker),canBreadcrumbShrink:!0}}componentWillMount(){v.ObservableLike.subscribe(this.props.headerItemPicker,this.onHeaderPickerChanged)}componentWillUnmount(){v.ObservableLike.unsubscribe(this.props.headerItemPicker,this.onHeaderPickerChanged)}componentWillReceiveProps(e){this.props.headerItemPicker!==e.headerItemPicker&&(this.setState({headerItemPicker:v.ObservableLike.getValue(e.headerItemPicker)}),v.ObservableLike.unsubscribe(this.props.headerItemPicker,this.onHeaderPickerChanged),v.ObservableLike.subscribe(e.headerItemPicker,this.onHeaderPickerChanged))}getTitle(){return this.props.breadcrumbItems&&this.props.breadcrumbItems.length>0||this.props.headerItemPicker?this.getBreadcrumb():this.props.title?i.createElement(k.HubTitle,{titleText:this.props.title,iconProps:this.props.iconProps}):(console.log("Must use title or breadcrumb items + headerItemPicker"),null)}getBreadcrumb(){let e=this.props.breadcrumbItems?[...this.props.breadcrumbItems]:[];const{maxBreadcrumbItemWidth:t,collapseBreadcrumb:s,iconProps:r,pickListClassName:n,pickListMinWidth:a,pickListMaxWidth:c,pickListMaxHeight:l,title:d,hubBreadcrumbAriaLabel:m,breadcrumbProps:p}=this.props,{headerItemPicker:h}=this.state;if(h&&h.getListItem){const t=h.selectedItem&&h.getListItem(h.selectedItem),i=h.selectedItem&&h.getTitleTextForItem?h.getTitleTextForItem(h.selectedItem):t&&t.name,s={key:"title-item",text:d||i,leftIconProps:r,onSelectionChanged:this.onSelectionChanged,itemPicker:h,ariaLabel:h.ariaLabel,isHeaderPickerItem:!0};e.push(s)}else if(d){const t={key:"title-item",text:d,leftIconProps:r};e.push(t)}return s&&(e=e.slice(e.length-1),p&&(p.overflowIndex=0)),i.createElement(B.VssBreadcrumb,Object.assign({},p,{dataDidRender:this.dataDidRender,ref:e=>{this._hubBreadcrumb=e},items:e,maxItemWidth:"string"==typeof t?t:o,pickListClassName:n,pickListMinWidth:a,pickListMaxWidth:c,pickListMaxHeight:l,ariaLabel:m,shouldUseFocusZone:!0,presentationStyles:24}))}render(){return i.createElement("div",{className:t.Util.css("vss-HubHeader",!this.state.canBreadcrumbShrink&&"vss-HubHeader-no-shrink")},this.getTitle(),this.props.children)}}}(),function(e){C=t.ComponentsHubHeaderHubTextTile={},Object.defineProperty(t,"__esModule",{value:!0});t.ComponentsHubHeaderHubTextTile.HubTextTile=class extends s.BaseComponent{render(){const{text:e,secondaryText:s}=this.props,o=t.Util.css("vss-HubTextTile vss-HubTile");return i.createElement("div",{className:o},i.createElement(t.Dynamic.DynamicText,{text:e,className:t.Util.css("vss-HubTextTile--primaryText",!this.props.secondaryText&&"vss-HubTextTile--primaryTextOnly")}),i.createElement(t.Dynamic.DynamicText,{text:s,className:"vss-HubTextTile--secondaryText"}))}}}(),function(e){w=t.ComponentsHubHeaderHubTileRegion={},Object.defineProperty(t,"__esModule",{value:!0});t.ComponentsHubHeaderHubTileRegion.HubTileRegion=class extends s.BaseComponent{render(){const e=t.Util.css("vss-HubTileRegion"),s=i.Children.toArray(this.props.children),o=i.Children.map(s||[],(e,t)=>{const s=e.props,o=s&&s.className,r=Object.assign({},s,{className:o?o+" vss-HubTile":"vss-HubTile"});return i.cloneElement(e,r)});return i.createElement("div",{className:e},o)}}}(),function(e){function i(i){for(var s in i)t[e].hasOwnProperty(s)||(t[e][s]=i[s])}S=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),i(y),i(C),i(w)}("ComponentsHubHeaderindex"),function(e){x=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),function(i){for(var s in i)t[e].hasOwnProperty(s)||(t[e][s]=i[s])}(S)}("HubHeader"),function(e){O=t[e]={},Object.defineProperty(t,"__esModule",{value:!0});const o=340;t[e].MAX_PIVOT_WAIT=1e3;t[e].PivotBar=class extends s.BaseComponent{constructor(e){super(e),this._subscribedToPivotObservables=!1,this._pivotSelected=!1,this._pivotItemsRendered={},this._pivotHeader=s.createRef(),this._onFilterBarDismissClicked=(()=>{const{showFilterBarViewOptionKey:e,viewOptions:t}=this.props;t&&e&&this.props.viewOptions.setViewOption(e,!1),this._commandBar&&this._commandBar.focus(),this.setState({showFilterBar:!1})}),this._onDropDownSelected=(e=>{const t=e.key;this._updateSelectedItem(t,null)}),this._renderPivotItem=((e,s)=>{const o=e.itemKey,r=this.state.selectedPivot===o;return i.createElement(t.Dynamic.DynamicLink,{url:e.url,className:t.Util.css("vss-PivotBar--itemLink",e.child&&e.child.props.headerClassName),tabIndex:-1,role:"presentation","data-is-focusable":!1,key:o},i.createElement(t.Button.Button,{id:e.id,className:t.Util.css("vss-PivotBar--button",r?"selected":""),onClick:this._onPivotClick.bind(this,o),ariaLabel:e.ariaLabel,role:"tab",ariaSelected:r,ariaPosInSet:s+1,ariaSetSize:this.state.items.length},this._renderPivotItemContent(e)))}),this._onShowFilterBarClicked=(()=>{this.setState({showFilterBar:!this.state.showFilterBar})}),this._onFilterApplied=(()=>{const e=this.props.filter.hasChangesToReset();e!==this.state.hasAppliedFilter&&this.setState({hasAppliedFilter:e})}),this._onContributedPivotsChanged=(()=>{if(this.setState({items:this._getPivotBarItems(this.props)}),this._pivotSelected){if(this.state.selectedPivot&&!this.getSelectedPivot()){let e;this.props.initialSelectedPivot&&this._getPivotBarItemByItemKey(this.props.initialSelectedPivot)?e=this.props.initialSelectedPivot:this.state.items&&this.state.items.length>0&&(e=this.state.items[0].itemKey),e&&this.selectPivot(e)}}else this.setState(this._buildInitialPivotState())}),this._onViewOptionChanged=(e=>{const{showFilterBarViewOptionKey:t}=this.props,{viewActions:i}=this.state;let o=!1;if(t in e&&(this._focusFilterBar=!0,o=!0),!o){const t=[];i&&i.forEach(e=>t.push(...e.value));for(const i in e)if(s.findIndex(t,e=>e.key===i)>=0){o=!0;break}}o&&this.forceUpdate()}),this._makeIPivotBarItemFromContribution=((e,t)=>({contributedItem:e,id:this._makeContributedPivotBarItemId(e,t),itemKey:e.itemKey||e.id,groupKey:e.groupKey,name:e.text,order:e.order,ariaLabel:e.ariaLabel,onRenderFilterBar:e.renderFilterBar,commandProviders:e.commandProviders,viewActionProviders:e.viewActionProviders,badgeCount:e.badgeCount,url:e.url,hidden:e.hidden,onBeforePivotChange:e.onBeforePivotChange})),this._getPivotBarItemId=(e=>e.contributedItem?e.contributedItem.id:e.itemKey||e.id),this._id=u.getId("PivotBar"),this._setupPivotObservables(this.props),this._actionsManager=new n,this._disposables.push(this._actionsManager),this.state={items:this._getPivotBarItems(this.props)},this.state=Object.assign({hasAppliedFilter:!!this.props.filter&&this.props.filter.hasChangesToReset(),items:this.state.items},this._buildInitialPivotState())}focus(e){if(this._commandBar)switch(e){case 0:this._commandBar.focus()}}selectPivot(e){return!!this._getPivotBarItemByItemKey(e)&&(this._updateSelectedItem(e,null),!0)}getSelectedPivot(){return this._getPivotBarItemByItemKey(this.state.selectedPivot)}componentWillReceiveProps(e){t.Util.arrayEquals(this.props.pivotProviders,e.pivotProviders)||this._setupPivotObservables(e);const i=this._getPivotBarItems(e);this.setState((e,t)=>Object.assign({items:i},this._buildInitialPivotState(t,i,!0)))}componentDidMount(){this.props.viewOptions&&this.props.showFilterBarViewOptionKey&&this._events.on(this.props.viewOptions,t.UtilitiesViewOptions.VIEW_OPTIONS_CHANGE_EVENT,this._onViewOptionChanged),this.props.filter&&this.props.filter.subscribe(this._onFilterApplied,t.UtilitiesFilter.FILTER_APPLIED_EVENT),this._updateHeaderTopIfNeeded(),this._subscribeToPivotObservables()}componentDidUpdate(){this._updateHeaderTopIfNeeded(),this.props.onRenderComplete&&this.props.onRenderComplete()}componentWillUnmount(){this.props.viewOptions&&this.props.showFilterBarViewOptionKey&&this._events.off(this.props.viewOptions,t.UtilitiesViewOptions.VIEW_OPTIONS_CHANGE_EVENT,this._onViewOptionChanged),this.props.filter&&this.props.filter.unsubscribe(this._onFilterApplied,t.UtilitiesFilter.FILTER_APPLIED_EVENT),this._contributedPivotWait&&(clearTimeout(this._contributedPivotWait),this._contributedPivotWait=null),this._unsubscribeFromPivotObservables()}render(){let{className:e,filter:s,showPivots:o,showFilterBarViewOptionKey:r,filterBarClassName:n,pivotRenderingModeOptions:a,isCommandBarSticky:c,isPivotBarContentScrollable:l,pivotBarSize:d="compact",canBreadcrumbShrink:m,maxBreadcrumbWidth:p,pivotBarHeaderClassName:h}=this.props,{showFilterBar:u,headerTop:v}=this.state;const b=i.Children.toArray(this.props.children)||[],P=b.filter(e=>"object"!=typeof e||e.type!==g.PivotBarItem&&e.type!==t.FilterBar.FilterBar&&e.type!==x.HubTileRegion);let _=null;const f=this._getHubTileRegionIndex(b);f>-1&&(_=b[f]);let I=null,B=f>-1;void 0===o?o=this.state.items&&this.state.items.length>1:B=B&&o,o&&(I=this._renderPivotItems(a)),this._singleLineMode=!o&&!B;const k=this._singleLineMode?"vss-PivotBar--bar-one-line":"vss-PivotBar--bar-two-line";let y;this.props.viewOptions&&r&&(u=this.props.viewOptions.getViewOption(r));const C=this._getFilterBarSettings(b),w=C&&C.showInline,S=!1===this.props.isPivotBarContentScrollable&&!!c;C&&(u||C.showInline)&&(y=C.filterBarElement,y=i.cloneElement(y,{className:t.Util.css(y.props.className,n),filter:y.props.filter||s,onDismissClicked:this._onFilterBarDismissClicked,onMounted:e=>{!w&&this._focusFilterBar&&e.focus()}}),S&&(y=i.createElement("div",{className:"vss-PivotBar--filter-sticky"},y)));const O=!(!I&&!this._singleLineMode),E=S?"sticky":"";let A={};return this._singleLineMode&&p&&(A={maxWidth:`${p}px`}),a&&2===a.mode?i.createElement("div",{className:t.Util.css("vss-PivotBar",e)},i.createElement("div",{className:t.Util.css(h,"vss-PivotBar--header vertical")},P,B&&_),i.createElement("div",{className:"vss-PivotBar--pivotsContainer vertical"},I,i.createElement("div",{className:"vss-PivotBar--barAndContentContainer"},i.createElement("div",{className:t.Util.css("vss-PivotBar--bar",d)},this._renderCommandBar(w?y:null,!!C,!1),w?null:y),this._renderContent()))):i.createElement("div",{className:t.Util.css("vss-PivotBar",e)},i.createElement("div",{className:t.Util.css(k,E,!u&&"bottom-border"),style:{top:this._singleLineMode?0:v}},i.createElement("div",{className:t.Util.css(h,"vss-PivotBar--header",m&&this._singleLineMode&&"can-shrink"),ref:this._pivotHeader,style:A},P,B&&_),i.createElement("div",{className:t.Util.css("vss-PivotBar--bar",d)},I,this._renderCommandBar(w?y:null,!!C,O))),w?null:y,this._renderContent())}_updateHeaderTopIfNeeded(){!1===this.props.isPivotBarContentScrollable&&this.props.isCommandBarSticky&&void 0===this.state.headerTop&&!this._singleLineMode&&this.setState({headerTop:`-${this._pivotHeader.current.clientHeight}px`})}_renderPivotItems(e){return e&&1===e.mode?this._renderDropdown(e.props):e&&2===e.mode?this._renderVerticalTabs():this._renderHorizontalTabs()}_renderDropdown(e){const s=[];if(this.state.items.length>0){let e=this.state.items[0].groupKey;for(const t of this.state.items){const{name:i,itemKey:o,groupKey:r}=t;e!==r&&(s.push({key:`${r}-separator`,text:"-",itemType:b.DropdownMenuItemType.Divider}),e=r),s.push({key:o,text:i})}}return i.createElement(b.Dropdown,{ariaLabel:t.VSSResourcesVSSUI.PivotItemAriaLabel,className:"vss-PivotBar--dropdown",selectedKey:this.state.selectedPivot,options:s,onChanged:this._onDropDownSelected,dropdownWidth:e.dropdownWidth})}_pivotCompare(e,t){return(void 0===e?100:e)-(void 0===t?100:t)}_renderHorizontalTabs(){const e=this.state.items?this.state.items.sort((e,t)=>this._pivotCompare(e.order,t.order)):null,{pivotBarSize:s="compact",headerAriaLabel:o}=this.props;return i.createElement("div",{role:"navigation","aria-label":o},i.createElement(r.FocusZone,{className:t.Util.css("vss-PivotBar--pivots",s),role:"tablist",direction:r.FocusZoneDirection.horizontal},e&&e.map(this._renderPivotItem)))}_renderVerticalTabs(){let e=[];const s={};let o;if(this.props.pivotRenderingModeOptions&&this.props.pivotRenderingModeOptions.props){const{groups:t,navAriaLabel:i}=this.props.pivotRenderingModeOptions.props;if(t){for(const e of t)s[e.key]=!0;e=t.sort((e,t)=>this._pivotCompare(e.rank,t.rank))}o=i}const n=[],a=this.state.items.reduce((e,t)=>(t.groupKey&&s[t.groupKey]?(e[t.groupKey]=e[t.groupKey]||[]).push(t):n.push(t),e),{}),c=[i.createElement(t.Accordion.Accordion,{key:"PivotBarVerticalAccordion",className:"pivot-bar--accordion",initiallyExpandAll:!0,items:e.map(e=>{let t;return a[e.key]&&(a[e.key].sort((e,t)=>this._pivotCompare(e.order,t.order)),t={key:e.key,title:e.name,onRenderContent:()=>i.createElement("div",{key:t.key,role:"tablist"},a[e.key].map((t,i)=>this._renderVerticalPivotItem(t,i,a[e.key].length)))}),t}).filter(e=>void 0!==e)})];return c.push(i.createElement("div",{className:"pivot-bar--ungrouped",key:"PivotBarVerticalUngrouped",role:"tablist"},n.map((e,t)=>this._renderVerticalPivotItem(e,t,n.length)))),i.createElement(r.FocusZone,{direction:r.FocusZoneDirection.vertical,className:"vss-PivotBar--pivots vertical flex-column","aria-label":o},c)}_renderVerticalPivotItem(e,s,o){const r=e.itemKey,n=this.state.selectedPivot===r;return i.createElement(t.Dynamic.DynamicLink,{url:e.url,className:t.Util.css("vss-PivotBar--itemLink-v",e.child&&e.child.props.headerClassName),tabIndex:-1,role:"presentation","data-is-focusable":!1,key:r},i.createElement(t.Button.Button,{subtle:!0,id:e.id,className:t.Util.css("vss-PivotBar--button-v",n?"selected":""),onClick:this._onPivotClick.bind(this,r),ariaLabel:e.ariaLabel,role:"tab",ariaSelected:n,ariaPosInSet:s+1,ariaSetSize:o},i.createElement(t.VssIcon.VssIcon,{className:"pivotbar-pivot--icon-v",iconName:e.iconProps&&e.iconProps.iconName}),i.createElement(t.TooltipEx.Tooltip,{anchorOrigin:{horizontal:"center",vertical:"end"},overflowOnly:!0,text:e.name,tooltipOrigin:{horizontal:"center",vertical:"start"}},i.createElement("div",{className:"flex flex-grow text-ellipsis"},e.name))))}_renderPivotItemContent(e){const{name:s,iconProps:r,badgeCount:n,maxItemWidth:a}=e;let c=void 0,l=void 0;"string"==typeof n?c=n:"number"==typeof n&&(c=t.UtilitiesFriendlyNumber.getFriendlyDisplayValue(n))!==n.toString()&&(l=n.toString());let d=void 0;return c&&(d=i.createElement("span",{className:"badge"},c),l&&(d=i.createElement(t.TooltipEx.Tooltip,{text:l},d))),i.createElement("span",{className:"innerContainer"},void 0!==r&&i.createElement(t.VssIcon.VssIcon,Object.assign({className:"icon"},r)),void 0!==s&&i.createElement(t.TooltipEx.Tooltip,{overflowOnly:!0,text:s},i.createElement("span",{className:"text",style:{maxWidth:a||o}},s)),d)}_renderCommandBar(e,t,s){return i.createElement(I.PivotCommandBar,{componentRef:e=>{this._commandBar=e},className:"vss-PivotBar--commandBar",commands:this.state.commands,viewActions:this.state.viewActions,filterBar:e,showFilterAction:t,showFilterBarViewOptionKey:this.props.showFilterBarViewOptionKey,hasAppliedFilter:this.state.hasAppliedFilter,prependSeparator:s,viewOptions:this.props.viewOptions,onShowFilterBarClicked:this._onShowFilterBarClicked,role:"region",ariaLabel:this.props.headerAriaLabel,commandsMenuBarAriaLabel:this.state.commandsMenuBarAriaLabel})}_renderContent(){const e=[],s=(this.state.selectedPivot||"").toUpperCase(),o=void 0===this.props.isPivotBarContentScrollable||this.props.isPivotBarContentScrollable;for(const r of this.state.items){const n=r.itemKey.toUpperCase(),a=s===n,c=!a&&1===r.deselectionBehavior&&!0===this._pivotItemsRendered[n];(a||c)&&(e.push(i.createElement("div",{key:n,className:t.Util.css("vss-PivotBar--content",!o&&"vss-PivotBar--content-unscrollable",c&&"hide-content",this.props.pivotBarContentClassName),role:"tabpanel",tabIndex:-1,"data-is-scrollable":o},r&&(r.child||r.contributedItem.render(t.Util.css("vss-PivotBarItem","content-host"))))),this._pivotItemsRendered[n]=!0)}return e}_makePivotBarItemId(e){return`${this._id}-Tab${e.index}`}_makeContributedPivotBarItemId(e,t){return`${this._id}-ContributedTab${t}`}_getPivotBarItemByItemKey(e,t=this.state.items){const i=(e||"").toUpperCase(),o=s.findIndex(t,e=>e.itemKey.toUpperCase()===i);return o>=0?t[o]:void 0}_getPivotBarItems(e){const i={},s=t.UtilitiesChildrenUtils.childrenOfType(e.children,g.PivotBarItem),o=e=>{const t=e.groupKey||"";let s=i[t];s||(s=[],i[t]=s),s.push(e)};let r=100;for(const e of s){const t=e.item.props;t.hidden||o({child:e.item,id:this._makePivotBarItemId(e),itemKey:t.itemKey,name:t.name,groupKey:t.groupKey,order:null!=t.order?t.order:r++,ariaLabel:t.ariaLabel,iconProps:t.iconProps,badgeCount:t.badgeCount,maxItemWidth:t.maxItemWidth,commands:t.commands,viewActions:t.viewActions,commandProviders:t.commandProviders,viewActionProviders:t.viewActionProviders,deselectionBehavior:t.deselectionBehavior,url:t.url,onBeforePivotChange:t.onBeforePivotChange,onRenderFilterBar:t.onRenderFilterBar,commandsMenuBarAriaLabel:t.commandsMenuBarAriaLabel})}return this._contributedPivots.forEach(e=>e.value.forEach(e=>{e.hidden||o(e)})),Object.keys(i).reduce((e,t)=>(i[t].forEach(t=>e.push(t)),e),[])}_setupPivotObservables(e){let i=0;const s=this._subscribedToPivotObservables;s&&this._unsubscribeFromPivotObservables(),this._contributedPivots=[],e.pivotProviders&&(e.pivotProviders.forEach(e=>{const s=new t.UtilitiesItemContribution.ContributedItemWithIdArray(e,e=>this._makeIPivotBarItemFromContribution(e,i++),this._getPivotBarItemId);this._contributedPivots.push(s)}),s&&this._subscribeToPivotObservables())}_unsubscribeFromPivotObservables(){this._contributedPivots.forEach(e=>e.unsubscribe(this._onContributedPivotsChanged)),this._subscribedToPivotObservables=!1}_subscribeToPivotObservables(){this._contributedPivots.forEach(e=>e.subscribe(this._onContributedPivotsChanged)),this._subscribedToPivotObservables=!0}_getFilterBarSettings(e){let o,{onRenderFilterBar:r,showFilterBarInline:n}=this.props;const a=this._getPivotBarItemByItemKey(this.state.selectedPivot);if(a&&a.onRenderFilterBar&&(o=a.onRenderFilterBar()),!o&&r&&(o=r()),!o){const r=s.findIndex(e,e=>"object"==typeof e&&e.type===t.FilterBar.FilterBar);if(r>=0){const t=e[r],s=i.Children.toArray(t.props.children);if(s&&s.length>=1&&(o=t,1===s.length&&!n)){const e=s[0];"object"==typeof e&&!0===e.props.isTextItem&&(n=!0)}}}if(o)return{filterBarElement:o,showInline:n}}_getHubTileRegionIndex(e){return s.findIndex(e,e=>"object"==typeof e&&e.type===x.HubTileRegion)}_isKeyValid(e,t=this.state.items){return void 0!==e&&void 0!==this._getPivotBarItemByItemKey(e,t)}_buildInitialPivotState(i=this.props,s,o=!1){const r=()=>{const e=s||this._getPivotBarItems(i);return e.length>0?e[0].itemKey:null};let n=null;return i.initialSelectedPivot||i.selectedPivot||(n=r()),!n&&i.initialSelectedPivot&&this._isKeyValid(i.initialSelectedPivot)&&(n=i.initialSelectedPivot),!n&&i.selectedPivot&&this._isKeyValid(i.selectedPivot)&&(n=i.selectedPivot),this._isKeyValid(n,s)||(n=null,this._contributedPivotWait||(this._contributedPivotWait=setTimeout(()=>{this._pivotSelected||(n=r())&&this._updateSelectedItem(n,null),this._contributedPivotWait=null},t[e].MAX_PIVOT_WAIT))),this._pivotSelected=null!==n,this._buildNewPivotState(i,n,s,o)}_buildNewPivotState(e,t,i,s=!1){const o=this._getPivotBarItemByItemKey(t,i),r=t&&o;return{selectedPivot:r?o.itemKey:"",commands:r?this._actionsManager.getCommandObservables(e.commands,o,s):[],viewActions:r?this._actionsManager.getViewActionObservables(e.viewActions,o,s):[],commandsMenuBarAriaLabel:r?o.commandsMenuBarAriaLabel:void 0}}_onPivotClick(e,t){let i=!0;if(t.ctrlKey){const t=this._getPivotBarItemByItemKey(e);t&&t.url&&("string"==typeof t.url||t.url.value)&&(i=!1)}i&&(t.preventDefault(),this._updateSelectedItem(e,t))}_updateSelectedItem(e,t){const i=this._getPivotBarItemByItemKey(e);if(i&&(this.props.onBeforePivotChange||i.onBeforePivotChange)){const s=i&&i.url&&("string"==typeof i.url?i.url:i.url.value);if(i.onBeforePivotChange&&!i.onBeforePivotChange(t,e,s))return;if(this.props.onBeforePivotChange&&!this.props.onBeforePivotChange(t,e,s))return}const s=this.props;this._pivotSelected=!0,this.setState(this._buildNewPivotState(s,e)),s.onPivotClicked&&s.onPivotClicked(t,e)}};class n{constructor(){this._commands={},this._viewActions={},this._getPivotActionItemId=(e=>e.key)}getCommandObservables(e,i,s=!1){const o=i.id;if(!0===s&&delete this._commands[o],!this._commands[o]){const s=[];this._commands[o]=s,s.push(v.ObservableLike.isObservable(e)?e:new v.ObservableArray(e)),s.push(v.ObservableLike.isObservable(i.commands)?i.commands:new v.ObservableArray(i.commands)),i.commandProviders&&i.commandProviders.forEach(e=>{const i=new t.UtilitiesItemContribution.ContributedItemWithIdArray(e,e=>e,this._getPivotActionItemId);s.push(i)})}return this._commands[o]}getViewActionObservables(e,i,s=!1){const o=i.id;if(!0===s&&delete this._viewActions[o],!this._viewActions[o]){const s=[];this._viewActions[o]=s,s.push(v.ObservableLike.isObservable(i.viewActions)?i.viewActions:new v.ObservableArray(i.viewActions)),s.push(v.ObservableLike.isObservable(e)?e:new v.ObservableArray(e)),i.viewActionProviders&&i.viewActionProviders.forEach(e=>{const i=new t.UtilitiesItemContribution.ContributedItemArray(e,e=>e);s.push(i)})}return this._viewActions[o]}dispose(){this._commands=null,this._viewActions=null}}}("ComponentsPivotBarPivotBar"),function(e){function i(i){for(var s in i)t[e].hasOwnProperty(s)||(t[e][s]=i[s])}E=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),i(O),i(f),i(g),i(I)}("ComponentsPivotBarindex"),function(e){A=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),function(i){for(var s in i)t[e].hasOwnProperty(s)||(t[e][s]=i[s])}(E)}("PivotBar"),function(e){V=t.ComponentsHubHub={},Object.defineProperty(t,"__esModule",{value:!0});class o extends s.BaseComponent{constructor(e){super(e),this._wireDataDidRender=(e=>i.cloneElement(e,{breadcrumbDataDidRender:(t,i)=>{this._dataDidRender(t,i);const s=e;s&&s.props&&s.props.breadcrumbDataDidRender&&s.props.breadcrumbDataDidRender(t,i)}})),this._dataDidRender=((e,t)=>{const{maxBreadcrumbWidth:i,canBreadcrumbShrink:s}=this.state,{minDisplayedBreadcrumbItems:o=0}=this.props;s&&e.renderedItems.length<=o?this.setState({canBreadcrumbShrink:!1}):!s&&e.renderedItems.length>o&&this.setState({canBreadcrumbShrink:!0});const r=e.renderedItems.length+e.renderedOverflowItems.length;this._breadcrumbItemCount&&r!==this._breadcrumbItemCount?this.setState({maxBreadcrumbWidth:void 0}):!i&&0===e.renderedOverflowItems.length&&t&&this.setState({maxBreadcrumbWidth:t+12}),this._breadcrumbItemCount=r}),this._onViewActionObservableChanged=(()=>{this._viewActionsObservable.value=[...this._underlyingViewActionsObservable.value,this._getFullScreenViewAction()]}),this._onSelectedPivotChanged=(e=>{this.setState({selectedPivot:e})}),this._onPivotClicked=((e,t)=>{if(t!==this.props.hubViewState.selectedPivot.value)if(this.props.hubViewState.canSwitchPivots(t))this.props.hubViewState.selectedPivot.value=t;else{const e=this.props.hubViewState.selectedPivot.value;this.pivotBar.selectPivot(e)}}),this._chromeless=document.body.classList.contains("chromeless"),this.state={viewActions:this._getViewActions(e),selectedPivot:this.props.hubViewState.selectedPivot.value,inFullScreenMode:this.props.hubViewState.viewOptions.getViewOption(t.UtilitiesHubViewState.HubViewOptionKeys.fullScreen),canBreadcrumbShrink:!0}}focus(e){switch(e){case 0:this.pivotBar&&this.pivotBar.focus(e)}}componentWillReceiveProps(e){this.props.viewActions!==e.viewActions&&this.setState({viewActions:this._getViewActions(e)})}componentDidMount(){this.props.hubViewState.selectedPivot.subscribe(this._onSelectedPivotChanged),this._events.on(this.props.hubViewState.viewOptions,t.UtilitiesViewOptions.VIEW_OPTIONS_CHANGE_EVENT,this._onViewOptionChanged)}componentWillUnmount(){this.props.hubViewState.selectedPivot.unsubscribe(this._onSelectedPivotChanged),this._events.off(this.props.hubViewState.viewOptions,t.UtilitiesViewOptions.VIEW_OPTIONS_CHANGE_EVENT,this._onViewOptionChanged),this._underlyingViewActionsObservable&&this._underlyingViewActionsObservable.unsubscribe(this._onViewActionObservableChanged)}render(){const e=i.Children.toArray(this.props.children);this.validateChildren(e);const{className:s,commands:o,hideHeader:r,hubViewState:n,onRenderFilterBar:a,pivotProviders:c,onBeforePivotChange:l,onPivotBarRenderComplete:d,showFilterBarInline:m,showPivots:p,useShadowStyle:h,pivotRenderingModeOptions:u,onRenderSecondaryContent:v,splitterProps:b,scrollableRegion:_,pivotHeaderAriaLabel:g,breadcrumbIsExpandable:f}=this.props,{selectedPivot:I,viewActions:B,inFullScreenMode:k,maxBreadcrumbWidth:y,canBreadcrumbShrink:C}=this.state;f&&(e[0]=this._wireDataDidRender(e[0]));const w={onPivotClicked:this._onPivotClicked,onBeforePivotChange:l,commands:o,selectedPivot:I,viewOptions:n.viewOptions,filter:n.filter,pivotProviders:c,showPivots:!k&&p,onRenderComplete:d,viewActions:B,onRenderFilterBar:a,showFilterBarInline:m,showFilterBarViewOptionKey:t.UtilitiesHubViewState.HubViewOptionKeys.showFilterBar,filterBarClassName:"vss-Hub--filterBar",pivotRenderingModeOptions:u,pivotBarContentClassName:this.props.pivotBarContentClassName,isPivotBarContentScrollable:1===_,isCommandBarSticky:0===_,pivotBarSize:"tall",headerAriaLabel:g,canBreadcrumbShrink:C,maxBreadcrumbWidth:y,pivotBarHeaderClassName:f&&"vss-PivotBar--header-with-expandable-breadcrumb"},S=i.createElement(A.PivotBar,Object.assign({},w,{className:t.Util.css("vss-HubPivotBar",0===_&&"vss-HubPivotBar--scrollable",h&&"shadowStyle",r&&"hideHeader",this.props.pivotBarClassName),componentRef:e=>{this.pivotBar=e}}),e);let x=S;return v&&(x=i.createElement(t.Splitter.Splitter,Object.assign({},b,{onRenderFarElement:()=>S,onRenderNearElement:v}))),i.createElement(P.Fabric,{className:t.Util.css("vss-Hub",s)},x)}validateChildren(e){const s=t.UtilitiesChildrenUtils.childrenOfType(e,x.HubHeader)[0];if(!s||0!==s.index)throw new Error("Expected first child of Hub to be HubHeader.");this.state.inFullScreenMode&&(e[s.index]=i.cloneElement(e[s.index],{collapseBreadcrumb:!0}))}_getFullScreenViewAction(){return{key:t.UtilitiesHubViewState.HubViewOptionKeys.fullScreen,important:!0,viewActionRenderArea:2,actionType:1,actionProps:{showText:!1,onAriaLabel:t.VSSResourcesVSSUI.ExitFullScreenAriaLabel,offAriaLabel:t.VSSResourcesVSSUI.EnterFullScreenAriaLabel,onIconProps:{iconName:"BackToWindow"},offIconProps:{iconName:"FullScreen"}}}}_getViewActions(e){if(v.ObservableLike.isObservable(e.viewActions)){if(!e.hideFullScreenToggle&&!this._chromeless){this._underlyingViewActionsObservable&&this._underlyingViewActionsObservable.unsubscribe(this._onViewActionObservableChanged);const t=e.viewActions,i=new v.ObservableArray([...t.value,this._getFullScreenViewAction()]);return this._underlyingViewActionsObservable=t,this._viewActionsObservable=i,t.subscribe(this._onViewActionObservableChanged),i}return e.viewActions}{let t=e.viewActions||[];return e.hideFullScreenToggle||this._chromeless||t.push(this._getFullScreenViewAction()),t}}_onViewOptionChanged(e){if(t.UtilitiesHubViewState.HubViewOptionKeys.fullScreen in e){let i=!0===e[t.UtilitiesHubViewState.HubViewOptionKeys.fullScreen];this.setState({inFullScreenMode:i})}}}o.defaultProps={scrollableRegion:1},t.ComponentsHubHub.Hub=o}(),function(e){T=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),function(i){for(var s in i)t[e].hasOwnProperty(s)||(t[e][s]=i[s])}(V)}("ComponentsHubindex"),function(e){L=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),function(i){for(var s in i)t[e].hasOwnProperty(s)||(t[e][s]=i[s])}(B)}("ComponentsVssBreadcrumbindex"),t.RegistrationPivotBarRegistration={},Object.defineProperty(t,"__esModule",{value:!0}),_.VssComponent.register("pivotBar",A.PivotBar),function(e){t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),function(i){for(var s in i)t[e].hasOwnProperty(s)||(t[e][s]=i[s])}(T)}("Hub"),function(e){t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),function(i){for(var s in i)t[e].hasOwnProperty(s)||(t[e][s]=i[s])}(L)}("VssBreadcrumb")},["Components/PivotBar/PivotBarItem","Components/PivotBar/PivotBarAction","Components/PivotBar/PivotCommandBar","Components/VssBreadcrumb/VssBreadcrumb","Components/HubHeader/HubTitle","Components/HubHeader/HubHeader","Components/HubHeader/HubTextTile","Components/HubHeader/HubTileRegion","Components/HubHeader/index","HubHeader","Components/PivotBar/PivotBar","Components/PivotBar/index","PivotBar","Components/Hub/Hub","Components/Hub/index","Components/VssBreadcrumb/index","Registration/PivotBarRegistration","Hub","VssBreadcrumb"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-features.ui-hub-content"}}));