"use strict";define("VSSUI",["require","exports","react","VSS/Core/Util/String"],function(e,t,a,i){var n,r,s,o,d,l,c,m,p,y,u,C,h,b,f,E;n=t.ResourcesPersona={},Object.defineProperty(t,"__esModule",{value:!0}),t.ResourcesPersona.Loading="Loading...",t.ResourcesPersona.IdentityCardLoadingText="Loading identities...",t.ResourcesPersona.IdentityCardResultsFoundText="Showing {0} results",t.ResourcesPersona.IdentityCardPlaceholderText="Search users and groups",t.ResourcesPersona.IdentityCardNoResultsText="No identities found",t.ResourcesPersona.IdentityCardContact="Contact",t.ResourcesPersona.IdentityCardStartChat="Start chat",t.ResourcesPersona.IdentityCardOrganization="Organization",t.ResourcesPersona.IdentityCardReportingTo="Reporting to {0} ({1})",t.ResourcesPersona.IdentityCardReportsTo="Reports to",t.ResourcesPersona.IdentityCardProfileCardAriaLabel="Contact card",t.ResourcesPersona.IdentityCardHeaderButtonLabel="Go back",t.ResourcesPersona.IdentityCardContactInfo="Contact information",t.ResourcesPersona.IdentityCardEmail="Email",t.ResourcesPersona.IdentityCardPhoneNumber="Phone number",t.ResourcesPersona.IdentityCardLocation="Location",t.ResourcesPersona.IdentityCardTitle="Title",t.ResourcesPersona.IdentityCardDepartment="Department",t.ResourcesPersona.IdentityCardAlias="Alias",t.ResourcesPersona.IdentityCardMembers="{0} members",t.ResourcesPersona.IdentityCardMembersCount="Members ({0})",t.ResourcesPersona.IdentityCardDistributionList="Distribution list",function(e){r=t.ComponentsPersonaPersona={},Object.defineProperty(t,"__esModule",{value:!0});t.ComponentsPersonaPersona.Persona=class extends a.Component{constructor(e){super(e),this.targetElement=a.createRef(),this.onClick=(e=>{this.props.personaProvider&&this.props.personaProvider.renderIdentityCard&&this.setState({showIdentityCard:!0}),e.preventDefault()}),this.hideIdentityCard=(()=>{this.setState({showIdentityCard:!1})}),this.state={imageError:!1,imageLoaded:!1,showIdentityCard:!1}}render(){const{className:e,personaProvider:i,identity:n,size:r}=this.props,s=!!i&&!!i.renderIdentityCard,o=n.image||n.imageUrl;return a.createElement(a.Fragment,null,a.createElement("div",{ref:this.targetElement},a.createElement(t.Coin.Coin,{className:e,dataIsFocusable:s,isTabStop:s,onClick:s?this.onClick:void 0,displayName:n.displayName||"",imageUrl:this.getServerImageFromSize(o),imgAltText:n.displayName,size:r})),this.state.showIdentityCard&&i&&i.renderIdentityCard&&i.renderIdentityCard(n,i,this.hideIdentityCard,this.targetElement.current))}getServerImageFromSize(e){if(e){if(this.props.size){if(this.props.size<=24)return e+(-1===e.indexOf("?")?"?size=0":"&size=0");if(this.props.size>40)return e+(-1===e.indexOf("?")?"?size=2":"&size=2")}return e}}}}(),s=t.ComponentsIdentityCardCardContactLine={},Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentsIdentityCardCardContactLine.CardContactLine=(e=>a.createElement("div",{className:"bolt-identity-default-card-contact-line-wrapper"},a.createElement(t.Icon.Icon,{iconName:e.iconName,className:"bolt-identity-default-card-contact-line-label font-size"}),e.link&&a.createElement(t.Link.Link,{href:e.link},e.content),!e.link&&a.createElement("span",{className:"bolt-identity-default-card-contact-line-no-link"},e.content))),o=t[E="ComponentsIdentityCardContactCard"]={},Object.defineProperty(t,"__esModule",{value:!0}),t[E].ContactCardContactLine=(e=>{const{content:i,label:n,link:r,padTop:s}=e;return a.createElement("div",null,a.createElement("div",{className:t.Util.css("bolt-identity-contact-card-line flex-row flex-grow",s&&"bolt-identity-contact-card-line-top")},a.createElement("div",{className:"bolt-identity-contact-card-span-label"},n),a.createElement("div",{className:"bolt-identity-contact-card-span-content flex-grow flex-row"},r&&i&&a.createElement(t.Link.Link,{href:r},i),!r&&i)))}),t[E].ContactCard=(e=>{const{identity:i}=e;return a.createElement("div",{className:"bolt-bolt-identity-contact-card-organization-card-wrapper"},a.createElement("div",{className:"bolt-identity-contact-card-header-wrapper"},a.createElement("div",{className:"body-m"},n.IdentityCardContactInfo)),a.createElement("div",{className:"bolt-identity-contact-card-info-wrapper flex-column flex-grow body-s"},a.createElement(t[E].ContactCardContactLine,{label:n.IdentityCardEmail,content:i.mail,link:`mailto:${i.mail}`}),a.createElement(t[E].ContactCardContactLine,{content:i.telephoneNumber,label:n.IdentityCardPhoneNumber,link:`mailto:${i.telephoneNumber}`}),a.createElement(t[E].ContactCardContactLine,{label:n.IdentityCardLocation,content:i.physicalDeliveryOfficeName}),a.createElement(t[E].ContactCardContactLine,{label:n.IdentityCardTitle,content:i.jobTitle,padTop:!0}),a.createElement(t[E].ContactCardContactLine,{label:n.IdentityCardDepartment,content:i.department}),a.createElement(t[E].ContactCardContactLine,{label:n.IdentityCardAlias,content:i.mailNickname})))}),function(e){d=t.ComponentsIdentityCardDefaultAbridgedCard={},Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentsIdentityCardDefaultAbridgedCard.DefaultAbridgedCard=(e=>{const{displayName:t,signInAddress:i}=e.identity;return a.createElement("div",{className:"default-card-abridged flex-row"},a.createElement("div",{className:"flex-row"},a.createElement(r.Persona,{className:"persona-main",size:72,identity:e.identity}),a.createElement("div",{className:"flex-column flex-grow bolt-identity-card-name"},a.createElement("div",{className:"bolt-identity-card-persona-main-text-primary "},t))),function(e){return!!e&&!!/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i.test(e)}(i)&&a.createElement("div",null,a.createElement("div",{className:"bolt-identity-default-card-info-wrapper"},a.createElement("hr",{className:"bolt-identity-card-hr"}),a.createElement("div",{className:"bolt-identity-default-card-header-wrapper"},a.createElement("b",null,n.IdentityCardContact))),a.createElement("div",{className:"bolt-identity-default-card-contact-info-container"},a.createElement(s.CardContactLine,{iconName:"Mail",content:i,link:`mailto:${i}`}),a.createElement(s.CardContactLine,{iconName:"Chat",content:n.IdentityCardStartChat,link:`sip:${i}`}))))})}(),function(e){l=t.ComponentsIdentityCardDefaultCard={},Object.defineProperty(t,"__esModule",{value:!0});t.ComponentsIdentityCardDefaultCard.DefaultCard=class extends a.Component{componentDidMount(){this.props.setFocus&&this.props.setFocus()}render(){const{identity:e,isPreviousHeader:i}=this.props,{displayName:o,department:d,jobTitle:l,mail:c,physicalDeliveryOfficeName:m,telephoneNumber:p}=e;return a.createElement("div",{className:i?"bolt-identity-default-card-with-header":"bolt-identity-default-card-without-header"},a.createElement("div",{className:"flex-row"},a.createElement(r.Persona,{className:"bolt-identity-card-persona-main",size:72,identity:this.props.identity}),a.createElement("div",{className:"flex-column flex-grow bolt-identity-card-name"},a.createElement("div",{className:"bolt-identity-card-persona-main-text-primary title-s"},o),""===l?void 0:a.createElement("div",{className:"bolt-identity-card-persona-main-text-secondary"},l),""===d?void 0:a.createElement("div",{className:"bolt-identity-card-persona-main-text-tertiary"},d))),a.createElement("div",null,(c||p||m)&&a.createElement("div",{className:"bolt-identity-default-card-info-wrapper "},a.createElement("hr",{className:"bolt-identity-card-hr"}),a.createElement("div",{className:"bolt-identity-default-card-header-wrapper"},a.createElement(t.Button.Button,{"aria-label":n.IdentityCardContact,className:"bolt-identity-default-card-header pointer bolt-profile-card-tab-element",onClick:()=>{this.props.showContactCard()},role:"button",subtle:!0,text:n.IdentityCardContact},a.createElement(t.Icon.Icon,{iconName:"ChevronRight"}))),a.createElement("div",{className:"bolt-identity-default-card-contact-info-container"},c&&a.createElement(s.CardContactLine,{iconName:"Mail",content:c,link:`mailto:${c}`}),c&&a.createElement(s.CardContactLine,{iconName:"Chat",content:n.IdentityCardStartChat,link:`sip:${c}`}),p&&a.createElement(s.CardContactLine,{iconName:"Phone",content:p,link:`tel:${p}`}),m&&a.createElement(s.CardContactLine,{iconName:"POI",content:m}))),this.renderDirectManagerElement()))}renderDirectManagerElement(){if(!this.props.manager)return a.createElement("div",null);const e=this.props.manager,i={imageUrl:e.image,primaryText:e.displayName,secondaryText:e.jobTitle,tertiaryText:e.department};return a.createElement("div",{className:"bolt-identity-default-card-direct-manager-wrapper"},a.createElement("hr",{className:"bolt-identity-card-hr"}),a.createElement("div",{className:"bolt-identity-default-card-header-wrapper"},a.createElement(t.Button.Button,{"aria-label":n.IdentityCardOrganization,className:"bolt-identity-default-card-header pointer bolt-profile-card-tab-element",onClick:()=>{this.props.showOrganizationCard&&this.props.showOrganizationCard()},role:"button",text:n.IdentityCardOrganization,subtle:!0},a.createElement(t.Icon.Icon,{iconName:"ChevronRight"}))),a.createElement("div",{className:"bolt-identity-default-card-direct-manager"},a.createElement("div",{className:"bolt-identity-default-card-header-reportsto"},n.IdentityCardReportsTo),a.createElement("div",{className:"flex-row flex-grow"},a.createElement(t.Button.Button,{className:"bolt-bolt-identity-card-persona-list-manager-element bolt-profile-card-tab-element flex-row flex-grow","aria-label":e.displayName,key:e.entityId+e.signInAddress,onClick:()=>{this.props.onClickEntity&&this.props.onClickEntity(e)},subtle:!0},a.createElement(r.Persona,{size:40,identity:e}),a.createElement("div",{className:"bolt-identity-card-text flex-column flex-grow "},a.createElement("div",{className:"primary-text flex-row"},i.primaryText),""===i.secondaryText?void 0:a.createElement("div",{className:"secondary-text flex-row"},i.secondaryText))))))}}}(),c=t.ComponentsIdentityCardDefaultSimpleCard={},Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentsIdentityCardDefaultSimpleCard.DefaultSimpleCard=(e=>{const i={imageUrl:e.identity.image,primaryText:e.identity.displayName,secondaryText:e.identity.scopeName&&e.identity.signInAddress?e.identity.scopeName+"\\"+e.identity.signInAddress:e.identity.signInAddress?e.identity.signInAddress:""};return a.createElement(t.FocusZone.FocusZoneContext.Consumer,null,t=>a.createElement("div",{className:"bolt-identity-default-card-simple flex-row"},a.createElement("div",{className:"flex-row flex-grow"},a.createElement(r.Persona,{className:"bolt-identity-card-persona-main",identity:e.identity,size:72}),a.createElement("div",{className:"bolt-identity-card-persona-text flex-column flex-grow"},a.createElement("div",{className:"primary-text flex-row title-s",tabIndex:0,"data-focuszone":t.focuszoneId},i.primaryText),""===i.secondaryText?void 0:a.createElement("div",{className:"secondary-text flex-row body-l"},i.secondaryText)))))}),m=t.ComponentsIdentityCardGroupMembersCard={},Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentsIdentityCardGroupMembersCard.GroupMembersCard=(e=>{const{members:s,onClickEntity:o}=e,d=i.format(n.IdentityCardMembers,s?s.length:0),l=s?s.map(e=>{const i={imageUrl:e.image,primaryText:e.displayName?e.displayName:"",secondaryText:e.jobTitle?e.jobTitle:"",tertiaryText:e.department?e.department:""};return a.createElement("div",{className:"flex-row flex-grow",key:e.entityId+e.signInAddress},a.createElement(t.Button.Button,{className:"bolt-identity-card-persona-list-element profile-card-tab-element flex-row flex-grow","aria-label":e.displayName,onClick:()=>{o&&o(e)},subtle:!0},a.createElement(r.Persona,{size:40,identity:e}),a.createElement("div",{className:"flex-column flex-grow bolt-identity-card-name"},a.createElement("div",{className:"bolt-identity-card-persona-list-element-text-primary flex-row"},i.primaryText),""===i.secondaryText?void 0:a.createElement("div",{className:"bolt-identity-card-persona-list-element-text-secondary flex-row"},i.secondaryText))))}):[];return a.createElement("div",{className:"bolt-identity-contact-card-organization-card-wrapper"},a.createElement("div",{className:"bolt-identity-organization-card-content v-scroll-auto h-scroll-hidden"},l.length>0?a.createElement(a.Fragment,null,a.createElement("div",{className:"bolt-identity-organization-card-header-wrapper"},d," "),a.createElement("div",{className:"bolt-identity-organization-card-members-wrapper"},l)):a.createElement(t.Spinner.Spinner,{label:n.Loading,size:"large",className:"bolt-identity-card-loading-spinner"})))}),p=t.ComponentsIdentityCardGroupCard={},Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentsIdentityCardGroupCard.GroupCard=(e=>{const{identity:o,members:d,showOrganizationCard:l}=e,{displayName:c,mail:m,physicalDeliveryOfficeName:p,telephoneNumber:y}=o,u=i.format(n.IdentityCardMembersCount,d?d.length:0);return a.createElement("div",{className:"bolt-identity-default-card-without-header"},a.createElement("div",{className:"flex-row"},a.createElement(r.Persona,{className:"bolt-identity-card-persona-main",size:72,identity:o}),a.createElement("div",{className:"flex-column flex-grow bolt-identity-card-name"},a.createElement("div",{className:"bolt-identity-card-persona-main-text-primary title-s"},c),d&&d.length>0?a.createElement("div",{className:"bolt-identity-card-persona-main-text-tertiary"},i.format(n.IdentityCardMembers,d.length)):void 0)),a.createElement("div",null,(m||y||p)&&a.createElement("div",{className:"bolt-identity-default-card-info-wrapper"},a.createElement("hr",{className:"bolt-identity-card-hr"}),a.createElement("div",{className:"bolt-identity-default-card-contact-info-container"},m&&a.createElement(s.CardContactLine,{iconName:"Mail",content:m,link:`mailto:${m}`}))),d&&d.length>0?a.createElement("div",{className:"bolt-identity-default-card-member-list-wrapper "},a.createElement("hr",{className:"bolt-identity-card-hr"}),a.createElement("div",{className:"bolt-identity-default-card-header-wrapper"},a.createElement(t.Button.Button,{"aria-label":u,className:"bolt-identity-default-card-header pointer bolt-profile-card-tab-element flex-center",onClick:()=>{l&&l()},role:"button",text:u,subtle:!0},a.createElement(t.Icon.Icon,{iconName:"ChevronRight"})))):void 0))}),y=t.ComponentsIdentityCardGitHubCard={},Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentsIdentityCardGitHubCard.GitHubCard=(e=>{const{identity:t}=e,{displayName:i,mail:o,mailNickname:d}=t;return a.createElement("div",{className:"bolt-identity-default-card-without-header"},a.createElement("div",{className:"flex-row"},a.createElement(r.Persona,{className:"bolt-identity-card-persona-main",size:72,identity:t}),a.createElement("div",{className:"flex-column flex-grow bolt-identity-card-name"},a.createElement("div",{className:"bolt-identity-card-persona-main-text-primary title-s"},i),""===d?void 0:a.createElement("div",{className:"bolt-identity-card-persona-main-text-secondary"},d),""===o?void 0:a.createElement("div",{className:"bolt-identity-card-persona-main-text-tertiary"},o))),a.createElement("div",null,(o||d)&&a.createElement("div",{className:"bolt-identity-default-card-info-wrapper "},a.createElement("hr",{className:"bolt-identity-card-hr"}),a.createElement("div",{className:"bolt-identity-default-card-header-wrapper"},a.createElement("div",{className:"bolt-identity-default-card-header pointer bolt-profile-card-tab-element"},n.IdentityCardContact)),a.createElement("div",{className:"bolt-identity-default-card-contact-info-container"},d&&a.createElement(s.CardContactLine,{iconName:"GitHubLogo",content:"thomabr"}),o&&a.createElement(s.CardContactLine,{iconName:"Mail",content:o,link:`mailto:${o}`}),o&&a.createElement(s.CardContactLine,{iconName:"Chat",content:n.IdentityCardStartChat,link:`sip:${o}`})))))}),function(e){u=t.ComponentsIdentityCardOrganizationCard={},Object.defineProperty(t,"__esModule",{value:!0});t.ComponentsIdentityCardOrganizationCard.OrganizationCard=class extends a.Component{constructor(){super(...arguments),this.createManagerChainIdentityElements=(()=>{const e=this.props.managerList?this.props.managerList.map(e=>{const i={imageUrl:e.image,primaryText:e.displayName?e.displayName:"",secondaryText:e.jobTitle?e.jobTitle:"",tertiaryText:e.department?e.department:""};return a.createElement("div",{className:"flex-row flex-grow",key:e.entityId+e.signInAddress},a.createElement(t.Button.Button,{"aria-label":e.displayName,className:"bolt-identity-card-persona-list-element profile-card-tab-element flex-row flex-grow",onClick:()=>{this.props.onClickEntity&&this.props.onClickEntity(e)},subtle:!0},a.createElement(r.Persona,{size:40,identity:e}),a.createElement("div",{className:"flex-column flex-grow bolt-identity-card-name"},a.createElement("div",{className:"bolt-identity-card-persona-list-element-text-primary flex-row"},i.primaryText),""===i.secondaryText?void 0:a.createElement("div",{className:"bolt-identity-card-persona-list-element-text-secondary flex-row"},i.secondaryText))))}):[],i={imageUrl:this.props.identity.image,primaryText:this.props.identity.displayName,secondaryText:this.props.identity.jobTitle,tertiaryText:this.props.identity.department};return e.push(a.createElement("div",{className:"flex-row flex-grow",key:this.props.identity.entityId+this.props.identity.signInAddress},a.createElement(t.Button.Button,{className:"bolt-identity-card-persona-list-element profile-card-tab-element flex-row flex-grow","aria-label":this.props.identity.displayName,onClick:()=>{this.props.onClickEntity&&this.props.onClickEntity(this.props.identity)},subtle:!0},a.createElement(r.Persona,{size:40,identity:this.props.identity}),a.createElement("div",{className:"flex-column flex-grow bolt-identity-card-name"},a.createElement("div",{className:"bolt-identity-card-persona-list-element-text-primary flex-row"},i.primaryText),""===i.secondaryText?void 0:a.createElement("div",{className:"bolt-identity-card-persona-list-element-text-secondary flex-row"},i.secondaryText))))),e}),this.createDirectReportsIdentityElements=(()=>this.props.directReportList?this.props.directReportList.map(e=>{const i={imageUrl:e.image,primaryText:e.displayName?e.displayName:"",secondaryText:e.jobTitle?e.jobTitle:"",tertiaryText:e.department?e.department:""};return a.createElement("div",{className:"flex-row flex-grow",key:e.entityId+e.signInAddress},a.createElement(t.Button.Button,{className:"bolt-identity-card-persona-list-element profile-card-tab-element flex-row flex-grow","aria-label":e.displayName,onClick:()=>{this.props.onClickEntity&&this.props.onClickEntity(e)},subtle:!0},a.createElement(r.Persona,{size:40,identity:e}),a.createElement("div",{className:"flex-column flex-grow bolt-identity-card-name"},a.createElement("div",{className:"bolt-identity-card-persona-list-element-text-primary flex-row"},i.primaryText),""===i.secondaryText?void 0:a.createElement("div",{className:"bolt-identity-card-persona-list-element-text-secondary flex-row"},i.secondaryText))))}):[])}render(){const e=this.createManagerChainIdentityElements(),t=this.createDirectReportsIdentityElements();return a.createElement("div",{className:"bolt-identity-contact-card-organization-card-wrapper"},a.createElement("div",{className:"bolt-identity-organization-card-content v-scroll-auto h-scroll-hidden"},a.createElement("div",{className:"bolt-identity-organization-card-header-wrapper"},n.IdentityCardOrganization," "),a.createElement("div",{className:"bolt-identity-organization-card-manager-chain-wrapper"},e),t.length>0&&a.createElement("div",{className:"bolt-identity-organization-card-direct-reports-wrapper"},i.format(n.IdentityCardReportingTo,this.props.identity.displayName,this.props.directReportList?this.props.directReportList.length:0),t)))}}}(),function(e){C=t.ComponentsIdentityCardIdentityCardHeaderElement={},Object.defineProperty(t,"__esModule",{value:!0});t.ComponentsIdentityCardIdentityCardHeaderElement.IdentityCardHeaderElement=class extends a.Component{constructor(){super(...arguments),this.personaElement=a.createRef()}componentDidMount(){this.setFocus()}componentDidUpdate(){this.setFocus()}render(){const{identity:e}=this.props;return e?a.createElement("div",{className:"flex-row flex-grow"},a.createElement(t.Button.Button,{className:"bolt-identity-card-go-back-wrapper flex-row flex-grow flex-center cursor-pointer flex-center",onClick:this.props.onClickFunction,"aria-label":n.IdentityCardHeaderButtonLabel,ref:this.personaElement,primary:!0},a.createElement("div",null,a.createElement(t.Icon.Icon,{iconName:"ChevronLeft"})),a.createElement("div",{className:"go-back-positioning flex-row"},a.createElement(r.Persona,{className:"bolt-identity-card-go-back",size:24,identity:e}),a.createElement("div",{className:"flex-column flex-grow bolt-identity-card-name"},a.createElement("div",{className:"persona-header-text-primary"},e.displayName))))):a.createElement("div",null)}setFocus(){this.personaElement.current&&this.personaElement.current.focus()}}}(),function(e){function a(e){return!!e&&!!e.originDirectory&&"aad"===e.originDirectory.trim().toLowerCase()}function i(e){return!!e&&!!e.originDirectory&&"ad"===e.originDirectory.trim().toLowerCase()}function n(e){return!!e&&"group"===e.entityType.trim().toLowerCase()}function r(e){return!!e&&!!e.originDirectory&&"vsd"===e.originDirectory.trim().toLowerCase()}function s(e){return!!e&&!!e.originDirectory&&"wmd"===e.originDirectory.trim().toLowerCase()}h=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),t[e].isCompleteIdentity=function(e,t){return!!e&&(n(e)?e.mail||e.displayName:a(e)||i(e)?!!(t&&e.mail||e.mailNickname||e.jobTitle||e.department||e.physicalDeliveryOfficeName||e.manager||e.surname||e.telephoneNumber):r(e)?!!e.signInAddress:!(!s(e)||!e.scopeName&&!e.signInAddress))},t[e].isAadUser=a,t[e].isAdUser=i,t[e].isGithubUser=function(e){return!!e&&!!e.originDirectory&&"github"===e.originDirectory.trim().toLowerCase()},t[e].isGroup=n,t[e].isVsdUser=r,t[e].isWmdUser=s}("ComponentsIdentityCardIdentityCardIdentityUtils"),function(e){b=t.ComponentsIdentityCardIdentityCardContent={},Object.defineProperty(t,"__esModule",{value:!0});t.ComponentsIdentityCardIdentityCardContent.IdentityCardContent=class extends a.Component{constructor(){super(...arguments),this.onKeyDown=(e=>{27===e.which&&(this.onDismissCallout(),e.preventDefault())}),this.onDismissCallout=(()=>{this.props.onDismissCallback&&this.props.onDismissCallback()})}render(){const e=this.props.referenceHTMLComponent?this.props.referenceHTMLComponent:this.props.target;return a.createElement("div",null,a.createElement(t.Callout.Callout,{onDismiss:this.onDismissCallout,anchorElement:e,anchorOrigin:{horizontal:"end",vertical:"start"},calloutOrigin:{horizontal:"start",vertical:"start"},ariaLabel:n.IdentityCardProfileCardAriaLabel,role:"alert",className:"bolt-identity-card-callout depth-8",lightDismiss:!0},a.createElement("div",null,this.renderCard())))}renderCard(){if(this.props.working&&!h.isCompleteIdentity(this.props.dataProps.identity))return a.createElement("div",{className:t.Util.css("bolt-identity-card","loading")},a.createElement(t.Spinner.Spinner,{label:n.Loading,size:"large",className:"bolt-identity-card-loading-spinner"}));const e=h.isAdUser(this.props.dataProps.identity)||h.isAadUser(this.props.dataProps.identity)||h.isGroup(this.props.dataProps.identity),i=this.props.dataProps.header||void 0,r=this.renderInnerCard();return r?a.createElement(t.FocusZone.FocusZone,{circularNavigation:!0,direction:2,focusOnMount:!0,handleTabKey:!0},a.createElement("div",{className:"bolt-identity-card",onKeyDown:this.onKeyDown},e&&i&&a.createElement(C.IdentityCardHeaderElement,{identity:i,onClickFunction:this.props.onHeaderClick}),r)):a.createElement("div",null)}renderInnerCard(){const{identity:e,successors:t,managerList:i,directReportList:n}=this.props.dataProps;if(!e)return a.createElement("div",null);const r=h.isGroup(e),s=h.isVsdUser(e),C=h.isWmdUser(e),b=h.isAadUser(e),f=h.isAdUser(e),E=h.isGithubUser(e);if(r)switch(this.props.dataProps.cardType){case 2:return a.createElement(m.GroupMembersCard,{identity:e,members:t,onClickEntity:this.props.onClickEntity});case 0:return a.createElement(p.GroupCard,{identity:e,isPreviousHeader:!!this.props.dataProps.previousDataState||!!this.props.initialHeader,members:t,showOrganizationCard:this.props.onShowOrganizationCard})}else{if(E)return a.createElement(y.GitHubCard,{identity:e});if(s)return a.createElement(d.DefaultAbridgedCard,{identity:e});if(C)return a.createElement(c.DefaultSimpleCard,{identity:e});if(b||f)switch(this.props.dataProps.cardType){case 1:return a.createElement(o.ContactCard,{identity:e});case 2:return a.createElement(u.OrganizationCard,{identity:e,managerList:i,directReportList:n,onClickEntity:this.props.onClickEntity});case 0:default:const t=i&&i.length>0?i[i.length-1]:void 0;return a.createElement(l.DefaultCard,{identity:e,manager:t,isPreviousHeader:!!this.props.dataProps.previousDataState||!!this.props.initialHeader,showContactCard:this.props.onShowContactCard,showOrganizationCard:this.props.onShowOrganizationCard,onClickEntity:this.props.onClickEntity})}}return a.createElement("div",null)}}}(),function(e){f=t.ComponentsIdentityCardIdentityCard={},Object.defineProperty(t,"__esModule",{value:!0});t.ComponentsIdentityCardIdentityCard.IdentityCard=class extends a.Component{constructor(e){super(e),this.onDismissCallback=(()=>{this.props.onDismissCallback&&this.props.onDismissCallback()}),this.headerOnClickHandler=(()=>{this.state.dataState.previousDataState?this.setState({dataState:this.state.dataState.previousDataState,working:!1}):this.props.initialHeader&&this.props.initialHeader.onClickFunction&&this.props.initialHeader.onClickFunction()}),this.onShowContactCard=(()=>{const e=Object.assign({},this.state.dataState,{previousDataState:this.state.dataState,cardType:1,header:this.state.dataState.identity});this.setState({dataState:e})}),this.onShowOrganizationCard=(()=>{if(this.state.working||this.dismissed)return;const e=this.state.dataState;if(e.isGroup){const e=this.state.dataState,t=Object.assign({},e,{cardType:2,header:e.identity,previousDataState:e});this.setState({dataState:t}),(!e.successors||e.successors.length<=1)&&(this.setState({working:!0}),this.resolveIdentity(t,this.props.onRequestConnectionInformation(e.identity)))}else if(e.managerList&&e.managerList.length<=1){const e=this.state.dataState,t=Object.assign({},e,{cardType:2,header:e.identity,previousDataState:e});this.setState({dataState:t,working:!0}),this.resolveIdentity(t,this.props.onRequestConnectionInformation(e.identity,!0))}else{const e=this.state.dataState,t=Object.assign({},e,{cardType:2,header:e.identity,previousDataState:e});this.setState({dataState:t,working:!1})}}),this.onClickEntity=(e=>{if(this.state.working)return;const t=this.state.dataState,a={identity:e,cardType:0,header:t.identity,isGroup:h.isGroup(t.identity),directReportList:[],managerList:[],previousDataState:t,displayName:e.displayName,imageUrl:e.image,email:e.mail};this.setState({dataState:a,working:!0}),this.getIdentityByUniqueAttribute(e)}),this.updateConnections=((e,t)=>{this.dismissed||this.state.dataState&&e.identity===this.state.dataState.identity&&this.setState({dataState:Object.assign({},this.state.dataState,{managerList:t.managers&&t.managers.reverse(),directReportList:t.directReports,successors:t.successors}),working:!1})}),this.updateEntity=(e=>{const t=h.isCompleteIdentity(e,!0),a=h.isGroup(e)&&(!this.state.dataState.successors||this.state.dataState.successors.length<=0)||h.isAadUser(e)||h.isAdUser(e),i=this.props.imageUrl?this.props.imageUrl:e.image,n=Object.assign({},this.state.dataState,{identity:e,displayName:e.displayName,imageUrl:i,isGroup:h.isGroup(e)});t?a?(this.setState({dataState:n,working:!1}),this.resolveIdentity(n,this.props.onRequestConnectionInformation(n.identity))):this.setState({dataState:n,working:!1}):this.setState({working:!0})});const t={identity:e.identity,managerList:void 0,directReportList:void 0,previousDataState:void 0,cardType:0,header:e.initialHeader?e.initialHeader.identity:void 0,displayName:e.displayName,imageUrl:e.imageUrl,email:this.getEmail(),isGroup:h.isGroup(e.identity)};let a=!0;e.identity||e.uniqueAttribute||!e.displayName||(t.identity={entityId:"",entityType:"user",originDirectory:"vsd",originId:"",displayName:e.displayName,image:e.imageUrl,signInAddress:t.email},a=!1),this.state={dataState:t,working:a}}componentDidMount(){this.state.working&&this.setupInitialData(this.props.uniqueAttribute)}componentWillUnmount(){this.dismissed=!0}render(){return this.props.uniqueAttribute||this.props.identity||this.props.displayName?a.createElement(b.IdentityCardContent,Object.assign({},this.props,{dataProps:this.state.dataState,onClickEntity:this.onClickEntity,onDismissCallback:this.onDismissCallback,onShowContactCard:this.onShowContactCard,onShowOrganizationCard:this.onShowOrganizationCard,working:this.state.working,onHeaderClick:this.headerOnClickHandler})):a.createElement("div",null)}setupInitialData(e){const t=this.state.dataState;!t.identity&&e?this.getIdentityByUniqueAttribute(e):t.identity&&!h.isCompleteIdentity(t.identity)?this.getIdentityByUniqueAttribute(t.identity):h.isGroup(t.identity)&&t.successors&&t.successors.length>0?this.resolveIdentity(t,{successors:t.successors}):this.resolveIdentity(t,this.props.onRequestConnectionInformation(t.identity))}resolveIdentity(e,t){const a=t,i=t;i&&i.then?i.then(t=>{this.updateConnections(e,t)}):a&&this.updateConnections(e,a)}resolveIEntity(e){const t=e,a=e;a&&a.then?a.then(e=>{this.updateEntity(e)}):t&&this.updateEntity(t)}getIdentityByUniqueAttribute(e){let t;t="string"==typeof e?e:h.isGroup(e)||h.isAadUser(e)||h.isAdUser(e)?e.entityId:e.signInAddress?e.signInAddress:"",this.resolveIEntity(this.props.getEntityFromUniqueAttribute(t))}getEmail(){if(this.props.identity){if((h.isAadUser(this.props.identity)||h.isAdUser(this.props.identity))&&this.props.identity.mail)return this.props.identity.mail;if(this.props.identity&&this.props.identity.signInAddress)return this.props.identity.signInAddress;if(this.props.identity&&this.props.identity.mail)return this.props.identity.mail;if(this.props.uniqueAttribute){const e=this.props.uniqueAttribute.split("@");if(2===e.length&&e[0].length>=1&&e[1].length>=3&&e[1].split(".").length>1)return this.props.uniqueAttribute}}return""}}}(),t.Persona={},Object.defineProperty(t,"__esModule",{value:!0}),t.Persona.Persona=r.Persona,t.IdentityCard={},Object.defineProperty(t,"__esModule",{value:!0}),t.IdentityCard.IdentityCard=f.IdentityCard},["Resources.Persona","Components/Persona/Persona","Components/IdentityCard/CardContactLine","Components/IdentityCard/ContactCard","Components/IdentityCard/DefaultAbridgedCard","Components/IdentityCard/DefaultCard","Components/IdentityCard/DefaultSimpleCard","Components/IdentityCard/GroupMembersCard","Components/IdentityCard/GroupCard","Components/IdentityCard/GitHubCard","Components/IdentityCard/OrganizationCard","Components/IdentityCard/IdentityCardHeaderElement","Components/IdentityCard/IdentityCardIdentityUtils","Components/IdentityCard/IdentityCardContent","Components/IdentityCard/IdentityCard","Persona","IdentityCard"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-features.ui-persona-content"}}));