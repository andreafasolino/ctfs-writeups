"use strict";define("VSSUI",["require","exports","react","VSS/Core/Observable"],function(e,t,s,i){var n;!function(e){n=t.ComponentsTagPickerTagPicker={},Object.defineProperty(t,"__esModule",{value:!0});t.ComponentsTagPickerTagPicker.TagPicker=class extends s.Component{constructor(e){super(e),this.inputElement=s.createRef(),this.outerElement=s.createRef(),this.textValue=new i.ObservableValue(""),this.suggestionsVisible=new i.ObservableValue(!1),this.selectedIndex=new i.ObservableValue(-1),this.selectableTags=new i.ObservableArray([]),this.createGenericItem=((e,t)=>{const s=this.props.createDefaultItem&&this.props.createDefaultItem(e);if(!s||!t.some(e=>this.props.areTagsEqual(s,e)))return s}),this.onBlur=(()=>{this.suggestionsVisible.value||(this.textValue.value="",this.selectableTags.value=[],this.props.onBlur&&this.props.onBlur())}),this.onOuterKeyDown=(e=>{switch(e.which){case 46:case 8:!e.isDefaultPrevented()&&this.selectableTags.value.length>0&&(this.props.onTagsRemoved&&this.props.onTagsRemoved(this.selectableTags.value),this.selectableTags.value=[],this.focusInput(),e.preventDefault())}}),this.onKeyDown=(e=>{const t=e.which,s=this.inputElement.current,n=this.suggestionsVisible.value,l=i.ObservableLike.getValue(this.props.suggestions);switch(t){case 27:this.onSuggestionsDismiss(),e.preventDefault();break;case 9:case 13:if(!e.shiftKey)if(n)this.completeSuggestion(),e.preventDefault();else if(this.props.createDefaultItem){const t=this.createGenericItem(this.textValue.value,i.ObservableLike.getValue(this.props.selectedTags));t&&this.addItem(t),e.preventDefault()}break;case 38:n&&(this.selectedIndex.value=Math.max(0,this.selectedIndex.value-1),e.preventDefault());break;case 40:n?(this.selectedIndex.value=Math.min(l.length-1,this.selectedIndex.value+1),e.preventDefault()):(""!==this.textValue.value||l.length>0)&&(this.suggestionsVisible.value=!0,e.preventDefault());break;case 39:n&&l&&l[this.selectedIndex.value]&&this.props.onSuggestionExpanded&&s&&s.value.length===s.selectionEnd&&(this.props.onSuggestionExpanded(l[this.selectedIndex.value]),e.preventDefault())}}),this.onInputClick=(e=>{this.props.onEmptyInputFocus&&this.props.onEmptyInputFocus(),this.suggestionsVisible.value=!0,e&&e.preventDefault()}),this.onInputChange=(e=>{this.textValue.value=e.target.value,this.props.onSearchChanged(e.target.value),this.selectedIndex.value=""===e.target.value?-1:0,this.suggestionsVisible.value=!0,e.preventDefault()}),this.onTagClicked=((e,t)=>{if(!e||!e.isDefaultPrevented()){const s=this.indexOfTag(t,this.selectableTags.value);if(!this.props.onTagsRemoved)return;s<0?this.selectableTags.push(t):this.selectableTags.splice(s,1),e&&e.preventDefault()}}),this.onTagRemoved=(e=>{const t=this.indexOfTag(e,this.selectableTags.value);t>=0&&this.selectableTags.splice(t,1);const s=this.props.selectedTags.length;this.props.onTagRemoved(e),s!=this.props.selectedTags.length&&this.inputElement.current&&this.inputElement.current.focus()}),this.onTagPickerSizeChanged=((e,t)=>{this.setState({width:e})}),this.completeSuggestion=(()=>{const e=i.ObservableLike.getValue(this.props.suggestions)[this.selectedIndex.value];e&&this.addItem(e)}),this.onSuggestionClick=(e=>{this.addItem(e.item)}),this.addItem=(e=>{this.suggestionsVisible.value=!1,this.props.onTagAdded(e),this.textValue.value="",this.selectedIndex.value=-1,this.focusInput()}),this.focusInput=(()=>{this.inputElement.current&&(this.inputElement.current.focus(),this.inputElement.current.select())}),this.onSuggestionsDismiss=(()=>{this.suggestionsVisible.value=!1,this.focusInput()}),this.indexOfTag=((e,t)=>t.findIndex(t=>this.props.areTagsEqual(t,e))),this.state={width:296}}render(){const{ariaLabel:e,convertItemToPill:i,getSuggestionAriaLabel:n,noResultsFoundText:l,onTagsRemoved:a,placeholderText:o,prefixIconProps:r,renderSuggestionItem:c,selectedTags:u,suggestions:g,suggestionsLoading:h,suggestionsLoadingText:d}=this.props;return s.createElement(s.Fragment,null,s.createElement(t.FocusWithin.FocusWithin,{onBlur:this.onBlur},n=>s.createElement(t.Observer.Observer,{suggestionsVisible:this.suggestionsVisible,selectedIndex:this.selectedIndex,selectableTags:this.selectableTags,selectedTags:u,suggestions:g,textValue:this.textValue},l=>{const c=this.createGenericItem(this.textValue.value,l.suggestions.concat(l.selectedTags));c&&l.suggestions.unshift(c);const u=0===l.selectedTags.length||n.hasFocus?o:void 0,g=!n.hasFocus&&l.selectedTags.length>0&&!l.suggestionsVisible;return s.createElement(t.Measure.Measure,{onMeasure:this.onTagPickerSizeChanged},s.createElement("div",{className:t.Util.css("bolt-tag-picker",(n.hasFocus||l.suggestionsVisible)&&"edit"),ref:this.outerElement,onBlur:n.onBlur,onFocus:n.onFocus,onClick:this.focusInput},s.createElement("div",{className:"bolt-tag-picker-group flex-center flex-row flex-wrap",onKeyDown:a&&this.onOuterKeyDown},0===l.selectedTags.length&&r?s.createElement(t.Icon.Icon,Object.assign({},r,{className:t.Util.css(r.className,"bolt-tag-picker-prefix-icon")})):null,l.selectedTags.map((e,n)=>{const o=i(e,n),r=this.indexOfTag(e,l.selectableTags);return s.createElement("div",{key:t.Util.getSafeId("bolt-tag-picker-pill"+n),className:"scroll-hidden"},s.createElement(t.Pill.Pill,Object.assign({},o,{className:t.Util.css("bolt-tag-picker-pill",a&&"bolt-people-picker-pill-selectable",r>=0&&"active"),contentClassName:"text-ellipsis",onClick:t=>{this.onTagClicked(t,e)},onRemoveClick:t=>{this.onTagRemoved(e),t.preventDefault()}}),o.content))}),s.createElement("div",{className:"bolt-tag-picker-add-icon-div flex-row"},g&&s.createElement(t.Icon.Icon,{className:"bolt-tag-picker-add-icon cursor-pointer",iconName:"Add"}),s.createElement("input",{"aria-label":void 0===e&&u?u:e,"aria-expanded":l.suggestionsVisible,"aria-haspopup":"true",className:t.Util.css("bolt-tag-picker-input flex-row flex-grow scroll-hidden",g&&!u&&"hide-input"),onChange:this.onInputChange,onKeyDown:this.onKeyDown,onClick:this.onInputClick,placeholder:u,ref:this.inputElement,role:"combobox",type:"text",value:l.textValue})))))})),s.createElement(t.Observer.Observer,{suggestionsVisible:this.suggestionsVisible,suggestionsLoading:h,selectedIndex:this.selectedIndex,suggestions:g,textValue:this.textValue},e=>e.suggestionsVisible?s.createElement(t.Callout.Callout,{anchorElement:this.outerElement.current||void 0,anchorOrigin:{horizontal:"start",vertical:"end"},calloutOrigin:{horizontal:"start",vertical:"start"},contentClassName:"bolt-tag-picker-callout-content scroll-hidden",contentShadow:!0,onDismiss:this.onSuggestionsDismiss,lightDismiss:!0},s.createElement(t.SuggestionsList.SuggestionsList,{getSuggestionAriaLabel:n,isLoading:e.suggestionsLoading,loadingText:d,noResultsFoundText:l,onSuggestionClicked:this.onSuggestionClick,renderSuggestion:c,selectedIndex:e.selectedIndex,suggestions:e.suggestions,width:this.state.width})):s.createElement("div",null)))}focus(){this.inputElement.current&&this.inputElement.current.focus()}}}(),function(e){t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),function(s){for(var i in s)t[e].hasOwnProperty(i)||(t[e][i]=s[i])}(n)}("TagPicker")},["Components/TagPicker/TagPicker","TagPicker"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-features.ui-tag-picker-content"}}));